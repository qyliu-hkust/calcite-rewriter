{"rewrites":[{"rule_order":"[rule_project, rule_join, rule_filter, rule_union, rule_orderby, rule_agg, rule_cal]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\nFROM \"supplier\"\nINNER JOIN (SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"nation\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":877.88967},{"rule_order":"[rule_cal, rule_agg, rule_project, rule_filter, rule_orderby, rule_join, rule_union]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":38.181429},{"rule_order":"[rule_union, rule_cal, rule_orderby, rule_join, rule_agg, rule_project, rule_filter]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\nFROM \"supplier\"\nINNER JOIN (SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"nation\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":29.225633},{"rule_order":"[rule_agg, rule_cal, rule_join, rule_orderby, rule_union, rule_filter, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\nFROM \"supplier\"\nINNER JOIN (SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"nation\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":28.389009},{"rule_order":"[rule_project, rule_filter, rule_agg, rule_union, rule_cal, rule_join, rule_orderby]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":22.50653},{"rule_order":"[rule_filter, rule_cal, rule_join, rule_union, rule_agg, rule_project, rule_orderby]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":21.788766},{"rule_order":"[rule_project, rule_filter, rule_agg, rule_union, rule_orderby, rule_cal, rule_join]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":18.001786},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_cal, rule_project, rule_join, rule_union]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":17.342274},{"rule_order":"[rule_orderby, rule_filter, rule_union, rule_cal, rule_project, rule_join, rule_agg]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":16.671551},{"rule_order":"[rule_cal, rule_agg, rule_project, rule_filter, rule_join, rule_orderby, rule_union]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT *\nFROM \"supplier\",\n(SELECT *\nFROM \"lineitem\"\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\n\"orders\"\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\n\"customer\"\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\n\"nation\"\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\n\"nation\" AS \"nation0\"\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":15.485205}],"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'VIETNAM' and n2.n_name = 'UNITED KINGDOM')      or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'VIETNAM')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year"}