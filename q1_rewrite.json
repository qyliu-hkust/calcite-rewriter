{"rewrites":[{"rule_order":"[rule_agg, rule_filter, rule_union]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%turquoise%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":1362.7144},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%turquoise%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":16.0241},{"rule_order":"[rule_orderby, rule_project, rule_cal, rule_agg, rule_filter, rule_join]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%turquoise%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":24.9204}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%turquoise%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc"}