[{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t14\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t5\".\"ID\" AS \"ID1\", \"t6\".\"ID\", \"t5\".\"uncredited_voiced_character\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID1\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":63.5501},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"uncredited_voiced_character\", MIN(\"TITLE\".\"TITLE\") AS \"russian_movie\"\r\nFROM \"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" LIKE '%(voice)%' AND (\"CAST_INFO\".\"NOTE\" LIKE '%(uncredited)%' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[ru]') AND (\"ROLE_TYPE\".\"ROLE\" = 'actor' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2005 AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AND (\"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\")))","rewrite_time":5.4548},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"uncredited_voiced_character\", MIN(\"t5\".\"TITLE\") AS \"russian_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%') AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor') AS \"t3\"\r\nWHERE \"t3\".\"ID\" = \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"ID\"","rewrite_time":7.091},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"uncredited_voiced_character\", MIN(\"t2\".\"TITLE\") AS \"russian_movie\"\r\nFROM \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%') AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor') AS \"t1\" ON \"t\".\"ROLE_ID\" = \"t1\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t2\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":5.9758},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t13\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t15\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t11\".\"ID\" = \"t9\".\"ROLE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t15\".\"ID\"","rewrite_time":11.2693},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t10\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t12\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID0\", MIN(\"t7\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID0\" = \"t12\".\"ID\"","rewrite_time":6.7802},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t14\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":9.6801},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t16\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t10\".\"ROLE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID0\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":5.2688},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t13\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID0\", MIN(\"t8\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"ID\"","rewrite_time":5.7971},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\", MIN(\"t17\".\"russian_movie\") AS \"russian_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", \"t6\".\"ID\" AS \"ID1\", \"t7\".\"ID\", \"t6\".\"uncredited_voiced_character\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"uncredited_voiced_character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"uncredited_voiced_character\") AS \"uncredited_voiced_character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"uncredited_voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(voice)%' AND \"NOTE\" LIKE '%(uncredited)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t13\".\"ID\" = \"t11\".\"ROLE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":4.7837}],"num_rewrites":10,"raw_query":"SELECT     MIN(chn.name) AS uncredited_voiced_character,     MIN(t.title) AS russian_movie FROM     char_name AS chn,     cast_info AS ci,     company_name AS cn,     company_type AS ct,     movie_companies AS mc,     role_type AS rt,     title AS t WHERE     ci.note like '%(voice)%'     and ci.note like '%(uncredited)%'     AND cn.country_code = '[ru]'     AND rt.role = 'actor'     AND t.production_year > 2005     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mc.movie_id     AND chn.id = ci.person_role_id     AND rt.id = ci.role_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"character\") AS \"character\", MIN(\"t14\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character\") AS \"character\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t5\".\"ID\" AS \"ID1\", \"t6\".\"ID\", \"t5\".\"character\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID1\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":6.3947},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character\", MIN(\"TITLE\".\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" LIKE '%(producer)%' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[ru]' AND (\"ROLE_TYPE\".\"ROLE\" = 'actor' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AND (\"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\")))","rewrite_time":1.7159},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"character\", MIN(\"t5\".\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%') AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor') AS \"t3\"\r\nWHERE \"t3\".\"ID\" = \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"ID\"","rewrite_time":5.1663},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character\", MIN(\"t2\".\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%') AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor') AS \"t1\" ON \"t\".\"ROLE_ID\" = \"t1\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t2\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":5.8984},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t13\".\"character\") AS \"character\", MIN(\"t15\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t11\".\"ID\" = \"t9\".\"ROLE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t15\".\"ID\"","rewrite_time":5.9604},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t10\".\"character\") AS \"character\", MIN(\"t12\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID0\", MIN(\"t7\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID0\" = \"t12\".\"ID\"","rewrite_time":4.5297},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"character\") AS \"character\", MIN(\"t14\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":4.1614},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"character\") AS \"character\", MIN(\"t16\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"character\") AS \"character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t10\".\"ROLE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID0\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":4.2571},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"character\") AS \"character\", MIN(\"t13\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID0\", MIN(\"t8\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"ID\"","rewrite_time":4.0634},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"character\") AS \"character\", MIN(\"t17\".\"russian_mov_with_actor_producer\") AS \"russian_mov_with_actor_producer\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"character\") AS \"character\"\r\nFROM (SELECT \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"character\") AS \"character\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", \"t6\".\"ID\" AS \"ID1\", \"t7\".\"ID\", \"t6\".\"character\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[ru]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actor'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t13\".\"ID\" = \"t11\".\"ROLE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"russian_mov_with_actor_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":6.1947}],"num_rewrites":10,"raw_query":"SELECT     MIN(chn.name) AS \"character\",     MIN(t.title) AS russian_mov_with_actor_producer FROM     char_name AS chn,     cast_info AS ci,     company_name AS cn,     company_type AS ct,     movie_companies AS mc,     role_type AS rt,     title AS t WHERE     ci.note like '%(producer)%'     AND cn.country_code = '[ru]'     AND rt.role = 'actor'     AND t.production_year > 2010     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mc.movie_id     AND chn.id = ci.person_role_id     AND rt.id = ci.role_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"character\") AS \"character\", MIN(\"t13\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character\") AS \"character\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t5\".\"ID\" AS \"ID1\", \"t6\".\"ID\", \"t5\".\"character\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID1\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ROLE_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"ID\"","rewrite_time":3.9314},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character\", MIN(\"TITLE\".\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" LIKE '%(producer)%' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 1990 AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\")) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND (\"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\")))","rewrite_time":0.9566},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME\") AS \"character\", MIN(\"t4\".\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%') AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n\"ROLE_TYPE\"\r\nWHERE \"ROLE_TYPE\".\"ID\" = \"t2\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"t4\".\"ID\"","rewrite_time":2.9613},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character\", MIN(\"t1\".\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%') AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"ROLE_TYPE\" ON \"t\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t1\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":2.7225},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"character\") AS \"character\", MIN(\"t14\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t9\".\"ROLE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":4.0748},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t9\".\"character\") AS \"character\", MIN(\"t11\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID0\", MIN(\"t7\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"ROLE_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":5.0528},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t11\".\"character\") AS \"character\", MIN(\"t13\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"ID\"","rewrite_time":4.631},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"character\") AS \"character\", MIN(\"t15\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"character\") AS \"character\"\r\nFROM (SELECT \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t3\".\"ROLE_ID\", \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t11\".\"ID\" = \"t10\".\"ROLE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t15\".\"ID\"","rewrite_time":5.4448},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"character\") AS \"character\", MIN(\"t12\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID0\", MIN(\"t8\".\"character\") AS \"character\"\r\nFROM (SELECT \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t2\".\"character\") AS \"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ROLE_ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t9\" ON \"t8\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID0\" = \"t12\".\"ID\"","rewrite_time":5.2059},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"character\") AS \"character\", MIN(\"t16\".\"movie_with_american_producer\") AS \"movie_with_american_producer\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"character\") AS \"character\"\r\nFROM (SELECT \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"character\") AS \"character\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", \"t6\".\"ID\" AS \"ID1\", \"t7\".\"ID\", \"t6\".\"character\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"character\"\r\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"character\") AS \"character\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" LIKE '%(producer)%'\r\nGROUP BY \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ROLE_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t11\".\"ROLE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_american_producer\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":5.4272}],"num_rewrites":10,"raw_query":"SELECT     MIN(chn.name) AS \"character\",     MIN(t.title) AS movie_with_american_producer FROM     char_name AS chn,     cast_info AS ci,     company_name AS cn,     company_type AS ct,     movie_companies AS mc,     role_type AS rt,     title AS t WHERE     ci.note like '%(producer)%'     AND cn.country_code = '[us]'     AND t.production_year > 1990     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mc.movie_id     AND chn.id = ci.person_role_id     AND rt.id = ci.role_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"from_company\", \"movie_link_type\", \"non_polish_sequel_movie\")","rewrite_time":19.3238},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"from_company\", MIN(\"LINK_TYPE\".\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\".\"TITLE\") AS \"non_polish_sequel_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"KEYWORD\".\"KEYWORD\" = 'sequel') AND (\"LINK_TYPE\".\"LINK\" LIKE '%follow%' AND \"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 1950 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2000 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\"))) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":3.8255},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"from_company\", MIN(\"t0\".\"LINK\") AS \"movie_link_type\", MIN(\"t2\".\"non_polish_sequel_movie\") AS \"non_polish_sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"non_polish_sequel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID1\" = \"t2\".\"ID\"","rewrite_time":7.3588},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\") AS \"non_polish_sequel_movie\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID6\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":7.0993},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\") AS \"non_polish_sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID6\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":5.4027},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"from_company\", MIN(\"t\".\"LINK\") AS \"movie_link_type\", MIN(\"t0\".\"TITLE\") AS \"non_polish_sequel_movie\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000) AS \"t0\" ON \"t\".\"MOVIE_ID1\" = \"t0\".\"ID\"","rewrite_time":3.0104},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"non_polish_sequel_movie\") AS \"non_polish_sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\", \"ID6\" AS \"ID\", \"non_polish_sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"ID6\", \"non_polish_sequel_movie\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID1\" = \"ID\"","rewrite_time":4.0833},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"non_polish_sequel_movie\") AS \"non_polish_sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\", \"ID6\" AS \"ID\", \"non_polish_sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"ID6\", \"non_polish_sequel_movie\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":4.8318}],"num_rewrites":8,"raw_query":"SELECT MIN(cn.name) AS from_company, MIN(lt.link) AS movie_link_type, MIN(t.title) AS non_polish_sequel_movie FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND t.production_year BETWEEN 1950 AND 2000 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"from_company\", \"movie_link_type\", \"sequel_movie\")","rewrite_time":2.2325},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"from_company\", MIN(\"LINK_TYPE\".\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\".\"TITLE\") AS \"sequel_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"KEYWORD\".\"KEYWORD\" = 'sequel') AND (\"LINK_TYPE\".\"LINK\" LIKE '%follows%' AND \"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND (\"TITLE\".\"PRODUCTION_YEAR\" = 1998 AND (\"TITLE\".\"TITLE\" LIKE '%Money%' AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\"))) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":1.346},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"from_company\", MIN(\"t0\".\"LINK\") AS \"movie_link_type\", MIN(\"t2\".\"sequel_movie\") AS \"sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"sequel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 1998 AND \"TITLE\" LIKE '%Money%'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID1\" = \"t2\".\"ID\"","rewrite_time":2.208},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\") AS \"sequel_movie\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID6\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.065},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"TITLE\") AS \"sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID6\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":2.0282},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"from_company\", MIN(\"t\".\"LINK\") AS \"movie_link_type\", MIN(\"t0\".\"TITLE\") AS \"sequel_movie\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 1998 AND \"TITLE\" LIKE '%Money%') AS \"t0\" ON \"t\".\"MOVIE_ID1\" = \"t0\".\"ID\"","rewrite_time":1.6246},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"sequel_movie\") AS \"sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\", \"ID6\" AS \"ID\", \"sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"ID6\", \"sequel_movie\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID1\" = \"ID\"","rewrite_time":2.2584},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"from_company\", MIN(\"LINK\") AS \"movie_link_type\", MIN(\"sequel_movie\") AS \"sequel_movie\"\r\nFROM (SELECT \"MOVIE_ID1\", \"NAME\", \"LINK\", \"ID6\" AS \"ID\", \"sequel_movie\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"MOVIE_ID0\", \"ID4\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID1\", \"LINK_TYPE_ID\", \"ID5\", \"ID6\", \"sequel_movie\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.4622}],"num_rewrites":8,"raw_query":"SELECT     MIN(cn.name) AS from_company,     MIN(lt.link) AS movie_link_type,     MIN(t.title) AS sequel_movie FROM     company_name AS cn,     company_type AS ct,     keyword AS k,     link_type AS lt,     movie_companies AS mc,     movie_keyword AS mk,     movie_link AS ml,     title AS t WHERE     cn.country_code != '[pl]'     AND (         cn.name LIKE '%Film%'         OR cn.name LIKE '%Warner%'     )     AND ct.kind = 'production companies'     AND k.keyword = 'sequel'     AND lt.link LIKE '%follows%'     AND mc.note IS NULL     AND t.production_year = 1998     and t.title like '%Money%'     AND lt.id = ml.link_type_id     AND ml.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_type_id = ct.id     AND mc.company_id = cn.id     AND ml.movie_id = mk.movie_id     AND ml.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\", MIN(\"t16\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"from_company\") AS \"from_company\", MIN(\"t10\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t6\".\"from_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"from_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"from_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"COMPANY_TYPE_ID\" AND \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID1\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t13\" ON \"t12\".\"ID2\" = \"t13\".\"LINK_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":15.3652},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"from_company\", MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '20th Century Fox%' OR \"COMPANY_NAME\".\"NAME\" LIKE 'Twentieth Century Fox%') AND (\"COMPANY_TYPE\".\"KIND\" <> 'production companies' AND \"COMPANY_TYPE\".\"KIND\" IS NOT NULL) AND ((\"KEYWORD\".\"KEYWORD\" = 'sequel' OR \"KEYWORD\".\"KEYWORD\" = 'revenge' OR \"KEYWORD\".\"KEYWORD\" = 'based-on-novel') AND \"MOVIE_COMPANIES\".\"NOTE\" IS NOT NULL AND (\"TITLE\".\"PRODUCTION_YEAR\" > 1950 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\")) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":3.4325},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"from_company\", MIN(\"t4\".\"NOTE\") AS \"production_note\", MIN(\"t5\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')) AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')) AS \"t1\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"t0\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t\".\"ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t2\".\"ID1\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t3\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t3\".\"ID2\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID0\" = \"MOVIE_LINK\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID1\" = \"t5\".\"ID\"","rewrite_time":6.7979},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"from_company\", MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"t2\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')) AS \"t1\"\r\nCROSS JOIN \"LINK_TYPE\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t2\" ON \"MOVIE_LINK\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":6.323},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\", MIN(\"t16\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t8\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\"\r\nWHERE \"t9\".\"KEYWORD_ID\" = \"t8\".\"ID1\" AND \"t9\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"LINK_TYPE_ID\" AND \"t11\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":8.5816},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\", MIN(\"t13\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t7\".\"ID2\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"from_company\") AS \"from_company\", MIN(\"t7\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID1\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"ID2\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t10\" ON \"t9\".\"ID2\" = \"t10\".\"LINK_TYPE_ID\" AND \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":6.841},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"from_company\") AS \"from_company\", MIN(\"t13\".\"production_note\") AS \"production_note\", MIN(\"t15\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID1\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t12\" ON \"t11\".\"ID2\" = \"t12\".\"LINK_TYPE_ID\" AND \"t11\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":7.9936},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"from_company\") AS \"from_company\", MIN(\"t15\".\"production_note\") AS \"production_note\", MIN(\"t17\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t10\".\"KEYWORD_ID\" = \"t9\".\"ID1\" AND \"t10\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"LINK_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":6.3795},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\", MIN(\"t14\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t10\".\"from_company\") AS \"from_company\", MIN(\"t10\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t8\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID1\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"LINK_TYPE_ID\" AND \"t10\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":6.0806},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"from_company\") AS \"from_company\", MIN(\"t17\".\"production_note\") AS \"production_note\", MIN(\"t19\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t11\".\"ID2\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t6\".\"from_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"from_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"from_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]' AND (\"NAME\" LIKE '20th Century Fox%' OR \"NAME\" LIKE 'Twentieth Century Fox%')\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"COMPANY_TYPE_ID\" = \"t8\".\"ID0\" AND \"t9\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\"\r\nWHERE \"t12\".\"KEYWORD_ID\" = \"t11\".\"ID1\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID2\" = \"t15\".\"LINK_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":6.1012}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS from_company,     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_based_on_book FROM     company_name AS cn,     company_type AS ct,     keyword AS k,     link_type AS lt,     movie_companies AS mc,     movie_keyword AS mk,     movie_link AS ml,     title AS t WHERE     cn.country_code != '[pl]'     and (         cn.name like '20th Century Fox%'         or cn.name like 'Twentieth Century Fox%'     )     AND ct.kind != 'production companies'     and ct.kind is not NULL     AND k.keyword in ('sequel', 'revenge', 'based-on-novel')     AND mc.note is not NULL     AND t.production_year > 1950     AND lt.id = ml.link_type_id     AND ml.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_type_id = ct.id     AND mc.company_id = cn.id     AND ml.movie_id = mk.movie_id     AND ml.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\", MIN(\"t16\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"from_company\") AS \"from_company\", MIN(\"t10\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t6\".\"from_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"from_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"from_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"COMPANY_TYPE_ID\" AND \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID1\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t13\" ON \"t12\".\"ID2\" = \"t13\".\"LINK_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.0763},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"from_company\", MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND \"COMPANY_TYPE\".\"KIND\" <> 'production companies' AND (\"COMPANY_TYPE\".\"KIND\" IS NOT NULL AND (\"KEYWORD\".\"KEYWORD\" = 'sequel' OR \"KEYWORD\".\"KEYWORD\" = 'revenge' OR \"KEYWORD\".\"KEYWORD\" = 'based-on-novel')) AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NOT NULL AND \"TITLE\".\"PRODUCTION_YEAR\" > 1950 AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.3548},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"from_company\", MIN(\"t4\".\"NOTE\") AS \"production_note\", MIN(\"t5\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')) AS \"t1\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"t0\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t\".\"ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t2\".\"ID1\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t3\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t3\".\"ID2\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID0\" = \"MOVIE_LINK\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID1\" = \"t5\".\"ID\"","rewrite_time":3.705},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"from_company\", MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"t2\".\"TITLE\") AS \"movie_based_on_book\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')) AS \"t1\"\r\nCROSS JOIN \"LINK_TYPE\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t2\" ON \"MOVIE_LINK\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":3.4081},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\", MIN(\"t16\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t8\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\"\r\nWHERE \"t9\".\"KEYWORD_ID\" = \"t8\".\"ID1\" AND \"t9\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"LINK_TYPE_ID\" AND \"t11\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.1212},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\", MIN(\"t13\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t7\".\"ID2\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"from_company\") AS \"from_company\", MIN(\"t7\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID1\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"ID2\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t10\" ON \"t9\".\"ID2\" = \"t10\".\"LINK_TYPE_ID\" AND \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":5.1153},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"from_company\") AS \"from_company\", MIN(\"t13\".\"production_note\") AS \"production_note\", MIN(\"t15\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID1\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t12\" ON \"t11\".\"ID2\" = \"t12\".\"LINK_TYPE_ID\" AND \"t11\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":5.0779},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"from_company\") AS \"from_company\", MIN(\"t15\".\"production_note\") AS \"production_note\", MIN(\"t17\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_TYPE_ID\" = \"t2\".\"ID\" AND \"t6\".\"COMPANY_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t10\".\"KEYWORD_ID\" = \"t9\".\"ID1\" AND \"t10\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"LINK_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.6081},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"from_company\") AS \"from_company\", MIN(\"t12\".\"production_note\") AS \"production_note\", MIN(\"t14\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t10\".\"from_company\") AS \"from_company\", MIN(\"t10\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t8\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\", MIN(\"t0\".\"from_company\") AS \"from_company\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID1\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"LINK_TYPE_ID\" AND \"t10\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.1339},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"from_company\") AS \"from_company\", MIN(\"t17\".\"production_note\") AS \"production_note\", MIN(\"t19\".\"movie_based_on_book\") AS \"movie_based_on_book\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t14\".\"from_company\") AS \"from_company\", MIN(\"t14\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t11\".\"ID2\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"from_company\") AS \"from_company\", MIN(\"t11\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t8\".\"from_company\") AS \"from_company\", MIN(\"t9\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t6\".\"from_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"from_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"from_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"from_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[pl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" <> 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-novel', 'revenge', 'sequel')\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"COMPANY_TYPE_ID\" = \"t8\".\"ID0\" AND \"t9\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"ID1\", \"t8\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\"\r\nWHERE \"t12\".\"KEYWORD_ID\" = \"t11\".\"ID1\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID2\" = \"t15\".\"LINK_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_based_on_book\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":5.2201}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS from_company,     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_based_on_book FROM     company_name AS cn,     company_type AS ct,     keyword AS k,     link_type AS lt,     movie_companies AS mc,     movie_keyword AS mk,     movie_link AS ml,     title AS t WHERE     cn.country_code != '[pl]'     AND ct.kind != 'production companies'     and ct.kind is not NULL     AND k.keyword in ('sequel', 'revenge', 'based-on-novel')     AND mc.note is not NULL     AND t.production_year > 1950     AND lt.id = ml.link_type_id     AND ml.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_type_id = ct.id     AND mc.company_id = cn.id     AND ml.movie_id = mk.movie_id     AND ml.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID2\", \"t11\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID2\", \"t11\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID0\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\"","rewrite_time":6.9047},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"MOVIE_INFO\".\"INFO\" = 'Drama' OR \"MOVIE_INFO\".\"INFO\" = 'Horror') AND \"MOVIE_INFO_IDX\".\"INFO\" > '8.0' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2005 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"INFO_TYPE_ID\" = \"INFO_TYPE\".\"ID\" AND (\"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" = \"INFO_TYPE0\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))))","rewrite_time":1.8078},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"movie_company\", MIN(\"t7\".\"INFO2\") AS \"rating\", MIN(\"t8\".\"TITLE\") AS \"drama_horror_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')) AS \"t4\"\r\nWHERE \"t4\".\"INFO_TYPE_ID\" = \"t3\".\"ID1\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0') AS \"t6\"\r\nWHERE \"t5\".\"ID2\" = \"t6\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":4.2741},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t4\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"drama_horror_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')) AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0') AS \"t4\" ON \"t2\".\"ID\" = \"t4\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008) AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":4.9632},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t11\".\"INFO_TYPE_ID\" = \"t9\".\"ID1\" AND \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t13\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\"","rewrite_time":5.9399},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_company\") AS \"movie_company\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":5.9407},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\", MIN(\"t18\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"ID1\" = \"t12\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"ID\"","rewrite_time":5.5037},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"INFO_TYPE_ID\" = \"t10\".\"ID1\" AND \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\"","rewrite_time":6.5237},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\", MIN(\"t17\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"ID1\" = \"t11\".\"INFO_TYPE_ID\" AND \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"ID2\" = \"t14\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":5.2968},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"drama_horror_movie\") AS \"drama_horror_movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Horror')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t14\".\"INFO_TYPE_ID\" = \"t12\".\"ID1\" AND \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"drama_horror_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":5.5694}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS drama_horror_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, title AS t WHERE cn.country_code  = '[us]' AND ct.kind  = 'production companies' AND it1.info = 'genres' AND it2.info = 'rating' AND mi.info  in ('Drama', 'Horror') AND mi_idx.info  > '8.0' AND t.production_year  between 2005 and 2008 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND mi.info_type_id = it1.id AND mi_idx.info_type_id = it2.id AND t.id = mc.movie_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"budget\") AS \"budget\", MIN(\"t14\".\"unsuccsessful_movie\") AS \"unsuccsessful_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"budget\") AS \"budget\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"budget\") AS \"budget\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" IN ('distributors', 'production companies')\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"budget\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t9\" ON \"t8\".\"ID1\" = \"t9\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"unsuccsessful_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE 'Birdemic%' OR \"TITLE\" LIKE '%Movie%')\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"ID\"","rewrite_time":6.4664},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"budget\", MIN(\"TITLE\".\"TITLE\") AS \"unsuccsessful_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" IS NOT NULL AND ((\"COMPANY_TYPE\".\"KIND\" = 'production companies' OR \"COMPANY_TYPE\".\"KIND\" = 'distributors') AND \"INFO_TYPE\".\"INFO\" = 'budget') AND (\"INFO_TYPE0\".\"INFO\" = 'bottom 10 rank' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND ((\"TITLE\".\"TITLE\" LIKE 'Birdemic%' OR \"TITLE\".\"TITLE\" LIKE '%Movie%') AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"INFO_TYPE_ID\" = \"INFO_TYPE\".\"ID\" AND (\"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" = \"INFO_TYPE0\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))))","rewrite_time":1.5586},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t5\".\"INFO1\") AS \"budget\", MIN(\"t6\".\"TITLE\") AS \"unsuccsessful_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" IN ('distributors', 'production companies')) AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t2\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t3\",\r\n\"MOVIE_INFO\"\r\nWHERE \"MOVIE_INFO\".\"INFO_TYPE_ID\" = \"t3\".\"ID1\" AND \"t3\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AS \"t4\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t4\".\"ID2\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"t4\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE 'Birdemic%' OR \"TITLE\" LIKE '%Movie%')) AS \"t6\"\r\nWHERE \"t5\".\"MOVIE_ID0\" = \"t6\".\"ID\"","rewrite_time":4.5563},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"budget\", MIN(\"t3\".\"TITLE\") AS \"unsuccsessful_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" IN ('distributors', 'production companies')) AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t1\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t2\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE 'Birdemic%' OR \"TITLE\" LIKE '%Movie%')) AS \"t3\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"t3\".\"ID\"","rewrite_time":3.9489},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"budget\") AS \"budget\", MIN(\"t17\".\"unsuccsessful_movie\") AS \"unsuccsessful_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"budget\") AS \"budget\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"budget\") AS \"budget\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" IN ('distributors', 'production companies')\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"budget\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"INFO_TYPE_ID\" = \"t9\".\"ID1\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID0\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"unsuccsessful_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE 'Birdemic%' OR \"TITLE\" LIKE '%Movie%')\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":6.1762}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi.info) AS budget,     MIN(t.title) AS unsuccsessful_movie FROM     company_name AS cn,     company_type AS ct,     info_type AS it1,     info_type AS it2,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS mi_idx,     title AS t WHERE     cn.country_code = '[us]'     AND ct.kind is not NULL     and (         ct.kind = 'production companies'         or ct.kind = 'distributors'     )     AND it1.info = 'budget'     AND it2.info = 'bottom 10 rank'     AND t.production_year > 2000     AND (         t.title LIKE 'Birdemic%'         OR t.title LIKE '%Movie%'     )     AND t.id = mi.movie_id     AND t.id = mi_idx.movie_id     AND mi.info_type_id = it1.id     AND mi_idx.info_type_id = it2.id     AND t.id = mc.movie_id     AND ct.id = mc.company_type_id     AND cn.id = mc.company_id     AND mc.movie_id = mi.movie_id     AND mc.movie_id = mi_idx.movie_id     AND mi.movie_id = mi_idx.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID2\", \"t11\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID2\", \"t11\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID0\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\"","rewrite_time":5.4478},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"MOVIE_INFO\".\"INFO\" = 'Drama' OR \"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Western' OR \"MOVIE_INFO\".\"INFO\" = 'Family') AND \"MOVIE_INFO_IDX\".\"INFO\" > '7.0' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2000 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"INFO_TYPE_ID\" = \"INFO_TYPE\".\"ID\" AND (\"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" = \"INFO_TYPE0\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))))","rewrite_time":1.3254},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"movie_company\", MIN(\"t7\".\"INFO2\") AS \"rating\", MIN(\"t8\".\"TITLE\") AS \"mainstream_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')) AS \"t4\"\r\nWHERE \"t4\".\"INFO_TYPE_ID\" = \"t3\".\"ID1\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0') AS \"t6\"\r\nWHERE \"t5\".\"ID2\" = \"t6\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":3.9935},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t4\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"mainstream_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')) AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0') AS \"t4\" ON \"t2\".\"ID\" = \"t4\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.5198},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t11\".\"INFO_TYPE_ID\" = \"t9\".\"ID1\" AND \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t13\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\"","rewrite_time":5.818},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_company\") AS \"movie_company\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"ID2\", \"t8\".\"MOVIE_ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":5.6877},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\", MIN(\"t18\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"ID1\" = \"t12\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"ID\"","rewrite_time":7.4966},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"INFO_TYPE_ID\" = \"t10\".\"ID1\" AND \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\"","rewrite_time":5.973},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t15\".\"rating\") AS \"rating\", MIN(\"t17\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"ID1\" = \"t11\".\"INFO_TYPE_ID\" AND \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"ID2\" = \"t14\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":5.3502},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"mainstream_movie\") AS \"mainstream_movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Drama', 'Family', 'Horror', 'Western')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t14\".\"INFO_TYPE_ID\" = \"t12\".\"ID1\" AND \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"mainstream_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":5.5798}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS movie_company,     MIN(mi_idx.info) AS rating,     MIN(t.title) AS mainstream_movie FROM     company_name AS cn,     company_type AS ct,     info_type AS it1,     info_type AS it2,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS mi_idx,     title AS t WHERE     cn.country_code = '[us]'     AND ct.kind = 'production companies'     AND it1.info = 'genres'     AND it2.info = 'rating'     AND mi.info in ('Drama', 'Horror', 'Western', 'Family')     AND mi_idx.info > '7.0'     AND t.production_year between 2000     and 2010     AND t.id = mi.movie_id     AND t.id = mi_idx.movie_id     AND mi.info_type_id = it1.id     AND mi_idx.info_type_id = it2.id     AND t.id = mc.movie_id     AND ct.id = mc.company_type_id     AND cn.id = mc.company_id     AND mc.movie_id = mi.movie_id     AND mc.movie_id = mi_idx.movie_id     AND mi.movie_id = mi_idx.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"release_date\") AS \"release_date\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t15\".\"german_movie\") AS \"german_movie\"\r\nFROM (SELECT \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"release_date\") AS \"release_date\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"german_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID0\" = \"t15\".\"ID\" AND \"t14\".\"ID3\" = \"t15\".\"KIND_ID\"","rewrite_time":5.3889},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"release_date\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"german_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[de]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'release dates') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"TITLE\".\"ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.3559},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"INFO1\") AS \"release_date\", MIN(\"t6\".\"INFO2\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"german_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t4\".\"ID2\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t5\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AS \"t6\",\r\n\"TITLE\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"TITLE\".\"ID\" AND \"t6\".\"ID3\" = \"TITLE\".\"KIND_ID\"","rewrite_time":3.8889},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"release_date\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"german_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t2\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"t3\".\"ID\" = \"TITLE\".\"KIND_ID\"","rewrite_time":3.4755},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"release_date\") AS \"release_date\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t18\".\"german_movie\") AS \"german_movie\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"release_date\") AS \"release_date\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"german_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t18\".\"ID\" AND \"t17\".\"ID3\" = \"t18\".\"KIND_ID\"","rewrite_time":5.1774}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS release_date, MIN(miidx.info) AS rating, MIN(t.title) AS german_movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[de]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\" ON \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\" AND \"t18\".\"ID3\" = \"t20\".\"KIND_ID\"","rewrite_time":6.4328},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'release dates') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"TITLE\".\"TITLE\" <> '' AND ((\"TITLE\".\"TITLE\" LIKE '%Champion%' OR \"TITLE\".\"TITLE\" LIKE '%Loser%') AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"))) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":1.7358},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME\") AS \"producing_company\", MIN(\"t6\".\"INFO2\") AS \"rating\", MIN(\"t7\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t4\".\"ID2\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t5\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')) AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"t7\".\"ID\" AND \"t6\".\"ID3\" = \"t7\".\"KIND_ID\"","rewrite_time":4.3464},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"t4\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t2\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')) AS \"t4\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"ID\" AND \"t3\".\"ID\" = \"t4\".\"KIND_ID\"","rewrite_time":3.9445},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\" AND \"t17\".\"ID3\" = \"t19\".\"KIND_ID\"","rewrite_time":6.2309},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\" AND \"t14\".\"ID3\" = \"t16\".\"KIND_ID\"","rewrite_time":7.3885},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\", MIN(\"t18\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"ID\" AND \"t16\".\"ID3\" = \"t18\".\"KIND_ID\"","rewrite_time":5.7556},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\" AND \"t18\".\"ID3\" = \"t20\".\"KIND_ID\"","rewrite_time":6.1935},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\", MIN(\"t17\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t13\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\" AND \"t15\".\"ID3\" = \"t17\".\"KIND_ID\"","rewrite_time":5.7745},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t21\".\"producing_company\") AS \"producing_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE '%Champion%' OR \"TITLE\" LIKE '%Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\" AND \"t21\".\"ID3\" = \"t23\".\"KIND_ID\"","rewrite_time":6.0441}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS producing_company,     MIN(miidx.info) AS rating,     MIN(t.title) AS movie_about_winning FROM     company_name AS cn,     company_type AS ct,     info_type AS it,     info_type AS it2,     kind_type AS kt,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS miidx,     title AS t WHERE     cn.country_code = '[us]'     AND ct.kind = 'production companies'     AND it.info = 'rating'     AND it2.info = 'release dates'     AND kt.kind = 'movie'     AND t.title != ''     AND (         t.title LIKE '%Champion%'         OR t.title LIKE '%Loser%'     )     AND mi.movie_id = t.id     AND it2.id = mi.info_type_id     AND kt.id = t.kind_id     AND mc.movie_id = t.id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id     AND miidx.movie_id = t.id     AND it.id = miidx.info_type_id     AND mi.movie_id = miidx.movie_id     AND mi.movie_id = mc.movie_id     AND miidx.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\" ON \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\" AND \"t18\".\"ID3\" = \"t20\".\"KIND_ID\"","rewrite_time":5.7819},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'release dates') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"TITLE\".\"TITLE\" <> '' AND ((\"TITLE\".\"TITLE\" LIKE 'Champion%' OR \"TITLE\".\"TITLE\" LIKE 'Loser%') AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"))) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":1.4622},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME\") AS \"producing_company\", MIN(\"t6\".\"INFO2\") AS \"rating\", MIN(\"t7\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t4\".\"ID2\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t5\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')) AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"t7\".\"ID\" AND \"t6\".\"ID3\" = \"t7\".\"KIND_ID\"","rewrite_time":4.1006},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"t4\".\"TITLE\") AS \"movie_about_winning\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t2\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')) AS \"t4\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"ID\" AND \"t3\".\"ID\" = \"t4\".\"KIND_ID\"","rewrite_time":3.7837},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"ID\" AND \"t17\".\"ID3\" = \"t19\".\"KIND_ID\"","rewrite_time":6.9084},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"ID\" AND \"t14\".\"ID3\" = \"t16\".\"KIND_ID\"","rewrite_time":6.1156},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\", MIN(\"t18\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"ID\" AND \"t16\".\"ID3\" = \"t18\".\"KIND_ID\"","rewrite_time":5.8528},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t20\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"ID\" AND \"t18\".\"ID3\" = \"t20\".\"KIND_ID\"","rewrite_time":6.1244},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\", MIN(\"t17\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t13\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"ID\" AND \"t15\".\"ID3\" = \"t17\".\"KIND_ID\"","rewrite_time":5.6586},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t21\".\"producing_company\") AS \"producing_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"movie_about_winning\") AS \"movie_about_winning\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie_about_winning\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" <> '' AND (\"TITLE\" LIKE 'Champion%' OR \"TITLE\" LIKE 'Loser%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\" AND \"t21\".\"ID3\" = \"t23\".\"KIND_ID\"","rewrite_time":5.9881}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS producing_company,     MIN(miidx.info) AS rating,     MIN(t.title) AS movie_about_winning FROM     company_name AS cn,     company_type AS ct,     info_type AS it,     info_type AS it2,     kind_type AS kt,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS miidx,     title AS t WHERE     cn.country_code = '[us]'     AND ct.kind = 'production companies'     AND it.info = 'rating'     AND it2.info = 'release dates'     AND kt.kind = 'movie'     AND t.title != ''     AND (         t.title LIKE 'Champion%'         OR t.title LIKE 'Loser%'     )     AND mi.movie_id = t.id     AND it2.id = mi.info_type_id     AND kt.id = t.kind_id     AND mc.movie_id = t.id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id     AND miidx.movie_id = t.id     AND it.id = miidx.info_type_id     AND mi.movie_id = miidx.movie_id     AND mi.movie_id = mc.movie_id     AND miidx.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t19\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\" ON \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID2\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"ID\" AND \"t18\".\"ID3\" = \"t19\".\"KIND_ID\"","rewrite_time":5.5077},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'release dates') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"TITLE\".\"ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.4431},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME\") AS \"producing_company\", MIN(\"t6\".\"INFO2\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t4\".\"ID2\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t5\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t5\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"t5\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AS \"t6\",\r\n\"TITLE\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"TITLE\".\"ID\" AND \"t6\".\"ID3\" = \"TITLE\".\"KIND_ID\"","rewrite_time":3.6283},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t2\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"t3\".\"ID\" = \"TITLE\".\"KIND_ID\"","rewrite_time":3.2515},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"producing_company\") AS \"producing_company\", MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t18\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t18\".\"ID\" AND \"t17\".\"ID3\" = \"t18\".\"KIND_ID\"","rewrite_time":5.7415},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t15\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\", MIN(\"t13\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t10\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID3\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID3\", \"t12\".\"MOVIE_ID0\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID0\" = \"t15\".\"ID\" AND \"t14\".\"ID3\" = \"t15\".\"KIND_ID\"","rewrite_time":5.3617},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t16\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\", MIN(\"t17\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\" AND \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"ID\" AND \"t16\".\"ID3\" = \"t17\".\"KIND_ID\"","rewrite_time":5.4236},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t18\".\"rating\") AS \"rating\", MIN(\"t19\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t19\".\"ID\" AND \"t18\".\"ID3\" = \"t19\".\"KIND_ID\"","rewrite_time":6.6179},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"producing_company\") AS \"producing_company\", MIN(\"t15\".\"rating\") AS \"rating\", MIN(\"t16\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"producing_company\") AS \"producing_company\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\" AS \"ID3\", \"t9\".\"MOVIE_ID\", MIN(\"t0\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t11\".\"ID2\" = \"t12\".\"INFO_TYPE_ID\" AND \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\r\nGROUP BY \"t11\".\"ID1\", \"t11\".\"ID3\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t13\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\" AND \"t13\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\"\r\nGROUP BY \"t13\".\"ID3\", \"t13\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID0\" = \"t16\".\"ID\" AND \"t15\".\"ID3\" = \"t16\".\"KIND_ID\"","rewrite_time":6.0119},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t21\".\"producing_company\") AS \"producing_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t22\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"producing_company\") AS \"producing_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\", MIN(\"t12\".\"producing_company\") AS \"producing_company\"\r\nFROM (SELECT \"t9\".\"ID\", \"t9\".\"ID0\", \"t9\".\"ID1\", \"t9\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t9\".\"producing_company\"\r\nFROM (SELECT \"t6\".\"ID\", \"t6\".\"ID0\", \"t6\".\"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t6\".\"producing_company\"\r\nFROM (SELECT \"t3\".\"ID\", \"t3\".\"ID0\", \"t5\".\"ID\" AS \"ID1\", \"t3\".\"producing_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t2\".\"ID\" AS \"ID0\", \"t0\".\"producing_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"producing_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t2\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t12\".\"ID0\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID1\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"ID\" AND \"t21\".\"ID3\" = \"t22\".\"KIND_ID\"","rewrite_time":5.4846}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"northern_dark_movie\") AS \"northern_dark_movie\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t11\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"northern_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t14\".\"ID2\" = \"t16\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":6.137},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"northern_dark_movie\"\r\nFROM \"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND \"KIND_TYPE\".\"KIND\" = 'movie') AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Denish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND \"MOVIE_INFO_IDX\".\"INFO\" < '8.5' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":1.7738},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"INFO2\") AS \"rating\", MIN(\"t8\".\"TITLE\") AS \"northern_dark_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\"\r\nWHERE \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.4673},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"northern_dark_movie\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\" ON \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t4\" ON \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t3\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t5\" ON \"t2\".\"ID\" = \"t5\".\"KIND_ID\" AND \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":7.0739},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"northern_dark_movie\") AS \"northern_dark_movie\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"northern_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"ID2\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":5.2865}],"num_rewrites":5,"raw_query":"SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS northern_dark_movie FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  = 'movie' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info  < '8.5' AND t.production_year  > 2010 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"western_dark_production\") AS \"western_dark_production\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t11\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('murder', 'murder-in-title')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_dark_production\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND (\"TITLE\" LIKE '%murder%' OR \"TITLE\" LIKE '%Murder%' OR \"TITLE\" LIKE '%Mord%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t14\".\"ID2\" = \"t16\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.3131},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"western_dark_production\"\r\nFROM \"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title') AND \"KIND_TYPE\".\"KIND\" = 'movie') AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Denish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND \"MOVIE_INFO_IDX\".\"INFO\" > '6.0' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND ((\"TITLE\".\"TITLE\" LIKE '%murder%' OR \"TITLE\".\"TITLE\" LIKE '%Murder%' OR \"TITLE\".\"TITLE\" LIKE '%Mord%') AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":1.5312},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"INFO2\") AS \"rating\", MIN(\"t8\".\"TITLE\") AS \"western_dark_production\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('murder', 'murder-in-title')) AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\"\r\nWHERE \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.0') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND (\"TITLE\" LIKE '%murder%' OR \"TITLE\" LIKE '%Murder%' OR \"TITLE\" LIKE '%Mord%')) AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.0885},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"western_dark_production\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('murder', 'murder-in-title')) AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\" ON \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.0') AS \"t4\" ON \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t3\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND (\"TITLE\" LIKE '%murder%' OR \"TITLE\" LIKE '%Murder%' OR \"TITLE\" LIKE '%Mord%')) AS \"t5\" ON \"t2\".\"ID\" = \"t5\".\"KIND_ID\" AND \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":4.0669},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"western_dark_production\") AS \"western_dark_production\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('murder', 'murder-in-title')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_dark_production\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND (\"TITLE\" LIKE '%murder%' OR \"TITLE\" LIKE '%Murder%' OR \"TITLE\" LIKE '%Mord%')\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"ID2\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":7.0402}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi_idx.info) AS rating,     MIN(t.title) AS western_dark_production FROM     info_type AS it1,     info_type AS it2,     keyword AS k,     kind_type AS kt,     movie_info AS mi,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     title AS t WHERE     it1.info = 'countries'     AND it2.info = 'rating'     AND k.keyword in ('murder', 'murder-in-title')     AND kt.kind = 'movie'     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Denish',         'Norwegian',         'German',         'USA',         'American'     )     AND mi_idx.info > '6.0'     AND t.production_year > 2010     and (         t.title like '%murder%'         or t.title like '%Murder%'         or t.title like '%Mord%'     )     AND kt.id = t.kind_id     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND t.id = mi_idx.movie_id     AND mk.movie_id = mi.movie_id     AND mk.movie_id = mi_idx.movie_id     AND mi.movie_id = mi_idx.movie_id     AND k.id = mk.keyword_id     AND it1.id = mi.info_type_id     AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"rating\") AS \"rating\", MIN(\"t16\".\"north_european_dark_production\") AS \"north_european_dark_production\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\", MIN(\"t11\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"ID1\", \"t9\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"north_european_dark_production\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t16\" ON \"t14\".\"ID2\" = \"t16\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.1682},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"north_european_dark_production\"\r\nFROM \"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" IS NOT NULL AND (\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence')) AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Danish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND (\"MOVIE_INFO_IDX\".\"INFO\" < '8.5' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2005 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":1.4419},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"INFO2\") AS \"rating\", MIN(\"t8\".\"TITLE\") AS \"north_european_dark_production\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\"\r\nWHERE \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":3.9512},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"north_european_dark_production\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t3\" ON \"t\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t4\" ON \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t3\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t5\" ON \"t2\".\"ID\" = \"t5\".\"KIND_ID\" AND \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.7516},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"rating\") AS \"rating\", MIN(\"t19\".\"north_european_dark_production\") AS \"north_european_dark_production\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\", MIN(\"t12\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"ID1\", \"t10\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"north_european_dark_production\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"ID2\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":5.0361}],"num_rewrites":5,"raw_query":"SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS north_european_dark_production FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  is not null and k.keyword in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info  < '8.5' AND t.production_year  > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"release_date\") AS \"release_date\", MIN(\"t15\".\"internet_movie\") AS \"internet_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t10\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t8\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID2\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":6.578},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"release_date\", MIN(\"TITLE\".\"TITLE\") AS \"internet_movie\"\r\nFROM \"AKA_TITLE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%' AND \"MOVIE_INFO\".\"NOTE\" LIKE '%internet%')) AND (\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\".\"ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"))))","rewrite_time":1.5911},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t5\".\"INFO0\") AS \"release_date\", MIN(\"t6\".\"TITLE\") AS \"internet_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_TITLE\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\",\r\n\"KEYWORD\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%') AS \"t1\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"MOVIE_ID\" AND \"t2\".\"ID2\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t4\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t6\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":4.3828},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"INFO\") AS \"release_date\", MIN(\"t3\".\"TITLE\") AS \"internet_movie\"\r\nFROM \"AKA_TITLE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\"\r\nCROSS JOIN \"KEYWORD\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%') AS \"t1\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t3\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t3\".\"ID\"","rewrite_time":4.2975},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t16\".\"release_date\") AS \"release_date\", MIN(\"t18\".\"internet_movie\") AS \"internet_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t11\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID1\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID2\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.5833}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS release_date, MIN(t.title) AS internet_movie FROM aka_title AS \"at\", company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cn.country_code  = '[us]' AND it1.info  = 'release dates' AND mc.note  like '%(200%)%' and mc.note like '%(worldwide)%' AND mi.note  like '%internet%' AND mi.info  like 'USA:% 200%' AND t.production_year  > 2000 AND t.id = \"at\".movie_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = \"at\".movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = \"at\".movie_id AND mc.movie_id = \"at\".movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"release_date\") AS \"release_date\", MIN(\"t15\".\"youtube_movie\") AS \"youtube_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t10\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'YouTube'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t8\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID2\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"youtube_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":5.9223},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"release_date\", MIN(\"TITLE\".\"TITLE\") AS \"youtube_movie\"\r\nFROM \"AKA_TITLE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_NAME\".\"NAME\" = 'YouTube' AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%')) AND (\"MOVIE_INFO\".\"NOTE\" LIKE '%internet%' AND (\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%' AND \"TITLE\".\"PRODUCTION_YEAR\" >= 2005) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND (\"TITLE\".\"ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"))))","rewrite_time":1.6293},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t5\".\"INFO0\") AS \"release_date\", MIN(\"t6\".\"TITLE\") AS \"youtube_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_TITLE\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'YouTube') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\",\r\n\"KEYWORD\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%') AS \"t1\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"MOVIE_ID\" AND \"t2\".\"ID2\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t4\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t6\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":4.4308},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"INFO\") AS \"release_date\", MIN(\"t3\".\"TITLE\") AS \"youtube_movie\"\r\nFROM \"AKA_TITLE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'YouTube') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\"\r\nCROSS JOIN \"KEYWORD\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%') AS \"t1\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t3\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t3\".\"ID\"","rewrite_time":3.9634},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t16\".\"release_date\") AS \"release_date\", MIN(\"t18\".\"youtube_movie\") AS \"youtube_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t11\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'YouTube'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t7\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID1\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID2\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"youtube_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.879}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi.info) AS release_date,     MIN(t.title) AS youtube_movie FROM     aka_title AS \"at\",     company_name AS cn,     company_type AS ct,     info_type AS it1,     keyword AS k,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[us]'     and cn.name = 'YouTube'     AND it1.info = 'release dates'     AND mc.note like '%(200%)%'     and mc.note like '%(worldwide)%'     AND mi.note like '%internet%'     AND mi.info like 'USA:% 200%'     AND t.production_year between 2005     and 2010     AND t.id = \"at\".movie_id     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND t.id = mc.movie_id     AND mk.movie_id = mi.movie_id     AND mk.movie_id = mc.movie_id     AND mk.movie_id = \"at\".movie_id     AND mi.movie_id = mc.movie_id     AND mi.movie_id = \"at\".movie_id     AND mc.movie_id = \"at\".movie_id     AND k.id = mk.keyword_id     AND it1.id = mi.info_type_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"release_date\") AS \"release_date\", MIN(\"t14\".\"modern_american_internet_movie\") AS \"modern_american_internet_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t9\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID0\" = \"t9\".\"MOVIE_ID\" AND \"t7\".\"ID1\" = \"t9\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"MOVIE_ID1\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID2\" = \"t11\".\"KEYWORD_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"modern_american_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.8599},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"release_date\", MIN(\"TITLE\".\"TITLE\") AS \"modern_american_internet_movie\"\r\nFROM \"AKA_TITLE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"MOVIE_INFO\".\"NOTE\" LIKE '%internet%' AND (\"MOVIE_INFO\".\"INFO\" IS NOT NULL AND (\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 199%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%'))) AND (\"TITLE\".\"PRODUCTION_YEAR\" > 1990 AND \"TITLE\".\"ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"))))","rewrite_time":1.7347},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"INFO0\") AS \"release_date\", MIN(\"t5\".\"TITLE\") AS \"modern_american_internet_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_TITLE\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID0\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID2\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t3\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":4.1776},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"INFO\") AS \"release_date\", MIN(\"t2\".\"TITLE\") AS \"modern_american_internet_movie\"\r\nFROM \"AKA_TITLE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\"\r\nCROSS JOIN \"KEYWORD\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t1\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t2\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":3.7495},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"release_date\") AS \"release_date\", MIN(\"t17\".\"modern_american_internet_movie\") AS \"modern_american_internet_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t10\".\"release_date\") AS \"release_date\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"MOVIE_ID\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"release_date\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID1\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID2\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"modern_american_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.4181}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi.info) AS release_date,     MIN(t.title) AS modern_american_internet_movie FROM     aka_title AS \"at\",     company_name AS cn,     company_type AS ct,     info_type AS it1,     keyword AS k,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[us]'     AND it1.info = 'release dates'     AND mi.note like '%internet%'     AND mi.info is not NULL     and (         mi.info like 'USA:% 199%'         or mi.info like 'USA:% 200%'     )     AND t.production_year > 1990     AND t.id = \"at\".movie_id     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND t.id = mc.movie_id     AND mk.movie_id = mi.movie_id     AND mk.movie_id = mc.movie_id     AND mk.movie_id = \"at\".movie_id     AND mi.movie_id = mc.movie_id     AND mi.movie_id = \"at\".movie_id     AND mc.movie_id = \"at\".movie_id     AND k.id = mk.keyword_id     AND it1.id = mi.info_type_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"aka_title\") AS \"aka_title\", MIN(\"t18\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t11\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", \"t7\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t7\".\"aka_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\", \"t4\".\"aka_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\", \"t3\".\"ID\", \"t2\".\"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t1\".\"ID\", \"t\".\"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"COMPANY_ID\" AND \"t9\".\"ID1\" = \"t10\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID2\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID1\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.66},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_TITLE\".\"TITLE\") AS \"aka_title\", MIN(\"TITLE\".\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"AKA_TITLE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"MOVIE_INFO\".\"NOTE\" LIKE '%internet%' AND \"TITLE\".\"PRODUCTION_YEAR\" > 1990) AND (\"TITLE\".\"ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"))))","rewrite_time":1.6731},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"TITLE\") AS \"aka_title\", MIN(\"t5\".\"TITLE\") AS \"internet_movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_TITLE\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"AKA_TITLE\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%') AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID0\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID2\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t3\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.9275},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_TITLE\".\"TITLE\") AS \"aka_title\", MIN(\"t2\".\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"AKA_TITLE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t0\"\r\nCROSS JOIN \"KEYWORD\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%') AS \"t1\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t2\" ON \"AKA_TITLE\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":3.6197},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"aka_title\") AS \"aka_title\", MIN(\"t17\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t8\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t8\".\"ID1\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID2\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID1\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID2\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.8911},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t12\".\"aka_title\") AS \"aka_title\", MIN(\"t14\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ID2\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t7\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID0\" = \"t9\".\"MOVIE_ID\" AND \"t7\".\"ID1\" = \"t9\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ID2\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"MOVIE_ID1\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID2\" = \"t11\".\"KEYWORD_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.6881},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t14\".\"aka_title\") AS \"aka_title\", MIN(\"t16\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t9\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID2\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID1\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t13\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.6021},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"aka_title\") AS \"aka_title\", MIN(\"t18\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t9\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID2\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID2\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.8799},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"aka_title\") AS \"aka_title\", MIN(\"t15\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t8\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID2\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t8\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t8\".\"ID2\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":5.4387},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t19\".\"aka_title\") AS \"aka_title\", MIN(\"t21\".\"internet_movie_title\") AS \"internet_movie_title\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t12\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"aka_title\") AS \"aka_title\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", \"t7\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t7\".\"aka_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t6\".\"ID\", \"t4\".\"aka_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\", \"t3\".\"ID\", \"t2\".\"aka_title\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t1\".\"ID\", \"t\".\"aka_title\"\r\nFROM (SELECT \"MOVIE_ID\", MIN(\"TITLE\") AS \"aka_title\"\r\nFROM \"AKA_TITLE\"\r\nGROUP BY \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"COMPANY_ID\" AND \"t9\".\"ID1\" = \"t10\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID2\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\"\r\nWHERE \"t16\".\"MOVIE_ID1\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"internet_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t21\".\"ID\"","rewrite_time":5.7752}],"num_rewrites":10,"raw_query":"SELECT MIN(\"at\".title) AS aka_title, MIN(t.title) AS internet_movie_title FROM aka_title AS \"at\", company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cn.country_code  = '[us]' AND it1.info  = 'release dates' AND mi.note  like '%internet%' AND t.production_year  > 1990 AND t.id = \"at\".movie_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = \"at\".movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = \"at\".movie_id AND mc.movie_id = \"at\".movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t16\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ID\", \"t7\".\"ID\" AS \"ID0\", \"t5\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":6.3335},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"TITLE\".\"EPISODE_NR\" >= 50) AND (\"TITLE\".\"EPISODE_NR\" < 100 AND \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.468},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t5\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t2\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t3\",\r\n\"NAME\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.982},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t1\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100) AS \"t1\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":3.6593},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t15\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\" AS \"ID0\", \"t4\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t1\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":4.8501},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t17\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\" AS \"ID0\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":6.4471},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t13\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID0\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":7.1625},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\", MIN(\"t6\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\" AS \"ID0\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":6.6902},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t18\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\"\r\nWHERE \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.8009},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":6.0578},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t20\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID\", \"t8\".\"ID\" AS \"ID0\", \"t6\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"COMPANY_ID\" = \"t9\".\"ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID0\" = \"t13\".\"KEYWORD_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 50 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.7328}],"num_rewrites":11,"raw_query":"SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr >= 50 AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t15\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ID\", \"t7\".\"ID\" AS \"ID0\", \"t5\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":4.9151},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\") AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.2719},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t2\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t3\",\r\n\"NAME\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t4\",\r\n\"TITLE\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.5692},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.2142},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\" AS \"ID0\", \"t4\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t1\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":3.6994},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t16\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\" AS \"ID0\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.336},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t12\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID0\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":5.0727},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t13\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\", MIN(\"t6\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\" AS \"ID0\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":4.5243},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t17\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\"\r\nWHERE \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.416},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t13\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":5.2792},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t19\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID\", \"t8\".\"ID\" AS \"ID0\", \"t6\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"COMPANY_ID\" = \"t9\".\"ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID0\" = \"t13\".\"KEYWORD_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":5.1461}],"num_rewrites":11,"raw_query":"SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t16\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ID\", \"t7\".\"ID\" AS \"ID0\", \"t5\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.2491},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"TITLE\".\"EPISODE_NR\" < 100) AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.3873},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t5\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t2\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t3\",\r\n\"NAME\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.547},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t1\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100) AS \"t1\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":3.2625},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t15\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\" AS \"ID0\", \"t4\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t1\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":3.6961},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t17\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\" AS \"ID0\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.3698},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t13\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID0\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":4.9609},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\", MIN(\"t6\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\" AS \"ID0\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":4.7819},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t18\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\"\r\nWHERE \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.5299},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.4404},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t20\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID\", \"t8\".\"ID\" AS \"ID0\", \"t6\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"COMPANY_ID\" = \"t9\".\"ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID0\" = \"t13\".\"KEYWORD_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.2635}],"num_rewrites":11,"raw_query":"SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t16\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ID\", \"t7\".\"ID\" AS \"ID0\", \"t5\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t8\".\"ID\" = \"t9\".\"COMPANY_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t8\".\"ID0\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\" ON \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.1805},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"TITLE\".\"EPISODE_NR\" >= 5) AND (\"TITLE\".\"EPISODE_NR\" < 100 AND \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.2909},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t5\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t2\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t2\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t3\",\r\n\"NAME\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":3.8608},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"cool_actor_pseudonym\", MIN(\"t1\".\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100) AS \"t1\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":3.4104},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t15\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\" AS \"ID0\", \"t4\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t1\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\" ON \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":3.7402},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t17\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\" AS \"ID0\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t6\".\"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t10\"\r\nWHERE \"t9\".\"ID0\" = \"t10\".\"KEYWORD_ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":5.5688},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t11\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t13\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t8\" ON \"t7\".\"ID0\" = \"t8\".\"KEYWORD_ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":5.0691},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\", MIN(\"t6\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\" AS \"ID0\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t2\".\"ID\", \"t4\".\"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID0\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":4.9405},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t18\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\", MIN(\"t7\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t3\".\"ID\", \"t5\".\"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ID0\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t11\"\r\nWHERE \"t10\".\"ID0\" = \"t11\".\"KEYWORD_ID\" AND \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.3387},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t14\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\" AS \"ID0\", MIN(\"t1\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", MIN(\"t\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t9\" ON \"t8\".\"ID0\" = \"t9\".\"KEYWORD_ID\" AND \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.5057},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\", MIN(\"t20\".\"series_named_after_char\") AS \"series_named_after_char\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\", MIN(\"t9\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ID\", \"t8\".\"ID\" AS \"ID0\", \"t6\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"cool_actor_pseudonym\") AS \"cool_actor_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t\".\"cool_actor_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"cool_actor_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"COMPANY_ID\" = \"t9\".\"ID\" AND \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID0\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t13\"\r\nWHERE \"t12\".\"ID0\" = \"t13\".\"KEYWORD_ID\" AND \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"series_named_after_char\"\r\nFROM \"TITLE\"\r\nWHERE \"EPISODE_NR\" >= 5 AND \"EPISODE_NR\" < 100\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.22}],"num_rewrites":11,"raw_query":"SELECT     MIN(an.name) AS cool_actor_pseudonym,     MIN(t.title) AS series_named_after_char FROM     aka_name AS an,     cast_info AS ci,     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     name AS n,     title AS t WHERE     cn.country_code = '[us]'     AND k.keyword = 'character-name-in-title'     AND t.episode_nr >= 5     AND t.episode_nr < 100     AND an.person_id = n.id     AND n.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND an.person_id = ci.person_id     AND ci.movie_id = mc.movie_id     AND ci.movie_id = mk.movie_id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"a1\") AS \"member_in_charnamed_american_movie\", MIN(\"t10\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", MIN(\"t9\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\" ON \"t1\".\"ID\" = \"t4\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\" ON \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'B%'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"PERSON_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":5.8373},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_american_movie\", MIN(\"NAME\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"NAME\".\"NAME\" LIKE 'B%') AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":2.0035},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME0\") AS \"member_in_charnamed_american_movie\", MIN(\"t4\".\"NAME0\") AS \"a1\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t1\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'B%') AS \"t3\"\r\nWHERE \"t3\".\"ID\" = \"t2\".\"PERSON_ID\") AS \"t4\",\r\n\"TITLE\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.7046},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"member_in_charnamed_american_movie\", MIN(\"t1\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'B%') AS \"t1\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t1\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.3484},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t13\".\"a1\") AS \"member_in_charnamed_american_movie\", MIN(\"t13\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t11\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\"\r\nWHERE \"t4\".\"COMPANY_ID\" = \"t1\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t7\"\r\nWHERE \"t6\".\"ID0\" = \"t7\".\"KEYWORD_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'B%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t11\".\"ID\" = \"t9\".\"PERSON_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":4.4098}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS member_in_charnamed_american_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND n.name  LIKE 'B%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"a1\") AS \"member_in_charnamed_movie\", MIN(\"t9\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t8\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'Z%'\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.9805},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\", MIN(\"NAME\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"NAME\".\"NAME\" LIKE 'Z%' AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.1366},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME0\") AS \"member_in_charnamed_movie\", MIN(\"t3\".\"NAME0\") AS \"a1\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t0\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'Z%') AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t1\".\"PERSON_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.8342},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"member_in_charnamed_movie\", MIN(\"t0\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN \"COMPANY_NAME\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'Z%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.6201},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"a1\") AS \"member_in_charnamed_movie\", MIN(\"t12\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t10\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t3\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'Z%'\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t8\".\"PERSON_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":5.2335}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name  LIKE 'Z%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"a1\") AS \"member_in_charnamed_movie\", MIN(\"t9\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t8\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'X%'\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.7604},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\", MIN(\"NAME\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"NAME\".\"NAME\" LIKE 'X%' AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.1497},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME0\") AS \"member_in_charnamed_movie\", MIN(\"t3\".\"NAME0\") AS \"a1\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t0\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'X%') AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t1\".\"PERSON_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.9162},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"member_in_charnamed_movie\", MIN(\"t0\".\"NAME\") AS \"a1\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN \"COMPANY_NAME\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'X%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.6518},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"a1\") AS \"member_in_charnamed_movie\", MIN(\"t12\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t10\".\"a1\") AS \"a1\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t3\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"a1\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE 'X%'\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t8\".\"PERSON_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":3.6811}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name  LIKE 'X%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t8\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Bert%'\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.7635},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"NAME\".\"NAME\" LIKE '%Bert%' AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.0199},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME0\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t0\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Bert%') AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t1\".\"PERSON_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.0827},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN \"COMPANY_NAME\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Bert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.6935},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t10\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t3\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Bert%'\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t8\".\"PERSON_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":3.6706}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name  LIKE '%Bert%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", MIN(\"t8\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\" ON \"t1\".\"ID\" = \"t4\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\" ON \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.6493},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":0.9578},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME0\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t1\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t2\".\"PERSON_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.9486},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.6275},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t10\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\"\r\nWHERE \"t4\".\"COMPANY_ID\" = \"t1\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t3\".\"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t7\"\r\nWHERE \"t6\".\"ID0\" = \"t7\".\"KEYWORD_ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t9\".\"PERSON_ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":3.7152}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS member_in_charnamed_movie FROM     cast_info AS ci,     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     name AS n,     title AS t WHERE     cn.country_code = '[us]'     AND k.keyword = 'character-name-in-title'     AND n.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.movie_id = mc.movie_id     AND ci.movie_id = mk.movie_id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t8\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%B%'\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.6671},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"NAME\".\"NAME\" LIKE '%B%' AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")))","rewrite_time":1.0091},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NAME0\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t0\".\"ID1\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%B%') AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t1\".\"PERSON_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.8504},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN \"COMPANY_NAME\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%B%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.5807},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t12\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t10\".\"member_in_charnamed_movie\") AS \"member_in_charnamed_movie\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\" AS \"ID0\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t3\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t\".\"MOVIE_ID\", \"t2\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"member_in_charnamed_movie\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%B%'\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t8\".\"PERSON_ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":3.7169}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS member_in_charnamed_movie FROM     cast_info AS ci,     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword = 'character-name-in-title'     AND n.name LIKE '%B%'     AND n.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.movie_id = mc.movie_id     AND ci.movie_id = mk.movie_id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\", MIN(\"t12\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\", MIN(\"t8\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID0\", MIN(\"t6\".\"movie_budget\") AS \"movie_budget\", MIN(\"t7\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t5\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t5\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(executive producer)', '(producer)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t5\" ON \"t0\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID0\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm' AND \"NAME\" LIKE '%Tim%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID0\" = \"t12\".\"ID\"","rewrite_time":5.056},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(producer)' OR \"CAST_INFO\".\"NOTE\" = '(executive producer)') AND (\"INFO_TYPE\".\"INFO\" = 'budget' AND \"INFO_TYPE0\".\"INFO\" = 'votes') AND (\"NAME\".\"GENDER\" = 'm' AND \"NAME\".\"NAME\" LIKE '%Tim%' AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":1.3324},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t5\".\"INFO1\") AS \"movie_budget\", MIN(\"t5\".\"INFO2\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(executive producer)', '(producer)')) AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm' AND \"NAME\" LIKE '%Tim%') AS \"t4\"\r\nWHERE \"t4\".\"ID\" = \"t3\".\"PERSON_ID\") AS \"t5\",\r\n\"TITLE\"\r\nWHERE \"t5\".\"MOVIE_ID0\" = \"TITLE\".\"ID\"","rewrite_time":3.5674},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(executive producer)', '(producer)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm' AND \"NAME\" LIKE '%Tim%') AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.1702},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"movie_budget\") AS \"movie_budget\", MIN(\"t14\".\"movie_votes\") AS \"movie_votes\", MIN(\"t15\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"movie_budget\") AS \"movie_budget\", MIN(\"t10\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID0\", MIN(\"t7\".\"movie_budget\") AS \"movie_budget\", MIN(\"t8\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t5\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t5\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(executive producer)', '(producer)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'budget'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t5\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t5\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID0\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID0\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm' AND \"NAME\" LIKE '%Tim%'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t10\".\"PERSON_ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID0\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t15\".\"ID\"","rewrite_time":4.6257}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(t.title) AS movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, movie_info AS mi, movie_info_idx AS mi_idx, name AS n, title AS t WHERE ci.note  in ('(producer)', '(executive producer)') AND it1.info  = 'budget' AND it2.info  = 'votes' AND n.gender  = 'm' and n.name like '%Tim%' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"movie_budget\", \"movie_votes\", \"movie_title\")","rewrite_time":2.2429},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND \"INFO_TYPE\".\"INFO\" = 'genres' AND (\"INFO_TYPE0\".\"INFO\" = 'rating' AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Thriller')) AND (\"MOVIE_INFO\".\"NOTE\" IS NULL AND \"MOVIE_INFO_IDX\".\"INFO\" > '8.0' AND (\"NAME\".\"GENDER\" IS NOT NULL AND (\"NAME\".\"GENDER\" = 'f' AND \"TITLE\".\"PRODUCTION_YEAR\" >= 2008))) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2014 AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\")) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":1.2666},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"INFO1\") AS \"movie_budget\", MIN(\"t0\".\"INFO2\") AS \"movie_votes\", MIN(\"t2\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"MOVIE_ID0\", \"INFO1\", \"INFO2\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2008 AND \"PRODUCTION_YEAR\" <= 2014\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID0\" = \"t2\".\"ID\"","rewrite_time":2.1409},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"INFO1\") AS \"movie_budget\", MIN(\"INFO2\") AS \"movie_votes\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT \"INFO1\", \"INFO2\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX0\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE\", \"ID5\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.0895},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"INFO1\") AS \"movie_budget\", MIN(\"INFO2\") AS \"movie_votes\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX0\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE\", \"ID5\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":1.9136},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"INFO1\") AS \"movie_budget\", MIN(\"t\".\"INFO2\") AS \"movie_votes\", MIN(\"t0\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2008 AND \"PRODUCTION_YEAR\" <= 2014) AS \"t0\" ON \"t\".\"MOVIE_ID0\" = \"t0\".\"ID\"","rewrite_time":1.635},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"INFO1\") AS \"movie_budget\", MIN(\"INFO2\") AS \"movie_votes\", MIN(\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"MOVIE_ID0\", \"INFO1\", \"INFO2\", \"ID5\" AS \"ID\", \"movie_title\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\", \"ID5\", \"movie_title\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID0\" = \"ID\"","rewrite_time":2.2449},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"INFO1\") AS \"movie_budget\", MIN(\"INFO2\") AS \"movie_votes\", MIN(\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"MOVIE_ID0\", \"INFO1\", \"INFO2\", \"ID5\" AS \"ID\", \"movie_title\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NR_ORDER\", \"PERSON_ID\", \"NOTE\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\", \"ID\", \"ID0\", \"INFO\", \"ID1\", \"INFO0\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID2\", \"INFO1\", \"INFO_TYPE_ID0\", \"NOTE1\", \"MOVIE_ID1\", \"ID3\", \"INFO2\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"IMDB_INDEX\", \"NAME_PCODE_CF\", \"GENDER\", \"ID4\", \"SURNAME_PCODE\", \"NAME\", \"ID5\", \"movie_title\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.5687}],"num_rewrites":8,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(t.title) AS movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, movie_info AS mi, movie_info_idx AS mi_idx, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'rating' AND mi.info  in ('Horror', 'Thriller') and mi.note is NULL AND mi_idx.info  > '8.0' AND n.gender  is not null and n.gender = 'f' AND t.production_year  between 2008 and 2014 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"movie_budget\") AS \"movie_budget\", MIN(\"t12\".\"movie_votes\") AS \"movie_votes\", MIN(\"t13\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"movie_budget\") AS \"movie_budget\", MIN(\"t9\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID0\", MIN(\"t7\".\"movie_budget\") AS \"movie_budget\", MIN(\"t8\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t6\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t0\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID0\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID0\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID0\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID0\" = \"t13\".\"ID\"","rewrite_time":4.531},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'votes') AND ((\"MOVIE_INFO\".\"INFO\" = 'Horror' OR (\"MOVIE_INFO\".\"INFO\" = 'Action' OR \"MOVIE_INFO\".\"INFO\" = 'Sci-Fi') OR (\"MOVIE_INFO\".\"INFO\" = 'Thriller' OR (\"MOVIE_INFO\".\"INFO\" = 'Crime' OR \"MOVIE_INFO\".\"INFO\" = 'War'))) AND \"NAME\".\"GENDER\" = 'm' AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":1.316},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"INFO1\") AS \"movie_budget\", MIN(\"t6\".\"INFO2\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t2\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t3\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t4\".\"PERSON_ID\") AS \"t6\",\r\n\"TITLE\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"TITLE\".\"ID\"","rewrite_time":3.5166},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t2\" ON \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t3\" ON \"t\".\"PERSON_ID\" = \"t3\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t2\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.5464},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t15\".\"movie_budget\") AS \"movie_budget\", MIN(\"t15\".\"movie_votes\") AS \"movie_votes\", MIN(\"t16\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\", MIN(\"t9\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t6\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t8\".\"ID0\" = \"t9\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID0\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t13\".\"ID\" = \"t11\".\"PERSON_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID0\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID0\" = \"t16\".\"ID\"","rewrite_time":6.3754}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi.info) AS movie_budget,     MIN(mi_idx.info) AS movie_votes,     MIN(t.title) AS movie_title FROM     cast_info AS ci,     info_type AS it1,     info_type AS it2,     movie_info AS mi,     movie_info_idx AS mi_idx,     name AS n,     title AS t WHERE     ci.note in (         '(writer)',         '(head writer)',         '(written by)',         '(story)',         '(story editor)'     )     AND it1.info = 'genres'     AND it2.info = 'votes'     AND mi.info in (         'Horror',         'Action',         'Sci-Fi',         'Thriller',         'Crime',         'War'     )     AND n.gender = 'm'     AND t.id = mi.movie_id     AND t.id = mi_idx.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mi.movie_id     AND ci.movie_id = mi_idx.movie_id     AND mi.movie_id = mi_idx.movie_id     AND n.id = ci.person_id     AND it1.id = mi.info_type_id     AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t21\".\"voiced_movie\") AS \"voiced_movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t13\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t3\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"PERSON_ID0\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2009\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"ID\"","rewrite_time":8.1802},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"voiced_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NOT NULL AND ((\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%') AND \"MOVIE_INFO\".\"INFO\" IS NOT NULL)) AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%200%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%200%') AND (\"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE '%Ang%') AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2005 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2009))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\")) AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND \"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"))))","rewrite_time":2.0277},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME2\") AS \"voicing_actress\", MIN(\"t11\".\"TITLE\") AS \"voiced_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%') AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%') AS \"t7\"\r\nWHERE \"t6\".\"PERSON_ID0\" = \"t7\".\"ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t9\"\r\nWHERE \"t9\".\"ID\" = \"t8\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2009) AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID1\" = \"t11\".\"ID\"","rewrite_time":5.9816},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"voicing_actress\", MIN(\"t6\".\"TITLE\") AS \"voiced_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%') AS \"t2\" ON \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t3\" ON \"t2\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\" ON \"t\".\"ROLE_ID\" = \"t5\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2009) AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":5.4073},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t26\".\"voiced_movie\") AS \"voiced_movie\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID0\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"PERSON_ID0\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t22\".\"ID\" = \"t20\".\"ROLE_ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2009\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":7.7023}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note  in ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info  = 'release dates' AND mc.note  is not NULL and (mc.note like '%(USA)%' or mc.note like '%(worldwide)%') AND mi.info  is not null and (mi.info like 'Japan:%200%' or mi.info like 'USA:%200%') AND n.gender ='f' and n.name like '%Ang%' AND rt.role ='actress' AND t.production_year  between 2005 and 2009 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t21\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t13\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t3\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%2007%' OR \"INFO\" LIKE 'USA:%2008%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"PERSON_ID0\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\" LIKE '%Kung%Fu%Panda%'\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"ID\"","rewrite_time":9.9564},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" = '(voice)' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND ((\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%') AND \"MOVIE_INFO\".\"INFO\" IS NOT NULL)) AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%2007%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%2008%') AND (\"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE '%Angel%') AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND \"TITLE\".\"PRODUCTION_YEAR\" >= 2007 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\".\"TITLE\" LIKE '%Kung%Fu%Panda%'))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\")) AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND \"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"))))","rewrite_time":1.8802},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME2\") AS \"voicing_actress\", MIN(\"t11\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)') AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')) AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%2007%' OR \"INFO\" LIKE 'USA:%2008%') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%') AS \"t7\"\r\nWHERE \"t6\".\"PERSON_ID0\" = \"t7\".\"ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t9\"\r\nWHERE \"t9\".\"ID\" = \"t8\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\" LIKE '%Kung%Fu%Panda%') AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID1\" = \"t11\".\"ID\"","rewrite_time":5.9615},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"voicing_actress\", MIN(\"t6\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)') AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')) AS \"t2\" ON \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t2\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%2007%' OR \"INFO\" LIKE 'USA:%2008%') AS \"t3\" ON \"t2\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\" ON \"t\".\"ROLE_ID\" = \"t5\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\" LIKE '%Kung%Fu%Panda%') AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":5.3365},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t26\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%2007%' OR \"INFO\" LIKE 'USA:%2008%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID0\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"PERSON_ID0\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t22\".\"ID\" = \"t20\".\"ROLE_ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2008 AND \"TITLE\" LIKE '%Kung%Fu%Panda%'\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":7.7284}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS kung_fu_panda FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note  = '(voice)' AND cn.country_code ='[us]' AND it.info  = 'release dates' AND mc.note  like '%(200%)%' and (mc.note like '%(USA)%' or mc.note like '%(worldwide)%') AND mi.info  is not null and (mi.info like 'Japan:%2007%' or mi.info like 'USA:%2008%') AND n.gender ='f' and n.name like '%Angel%' AND rt.role ='actress' AND t.production_year  between 2007 and 2008 and t.title like '%Kung%Fu%Panda%' AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"jap_engl_voiced_movie\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"PERSON_ID0\", \"t9\".\"ROLE_ID\", \"t11\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t3\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\" ON \"t9\".\"MOVIE_ID0\" = \"t11\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID0\", \"t9\".\"ROLE_ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":7.3731},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"MOVIE_INFO\".\"INFO\" IS NOT NULL AND (\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%200%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%200%'))) AND (\"NAME\".\"GENDER\" = 'f' AND (\"NAME\".\"NAME\" LIKE '%An%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\")) AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\") AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"))))","rewrite_time":1.803},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"NAME2\") AS \"voicing_actress\", MIN(\"t10\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"t4\".\"MOVIE_ID\" AND \"t3\".\"ID3\" = \"t4\".\"INFO_TYPE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t6\"\r\nWHERE \"t5\".\"PERSON_ID0\" = \"t6\".\"ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t8\"\r\nWHERE \"t8\".\"ID\" = \"t7\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID1\" = \"t10\".\"ID\"","rewrite_time":5.6183},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t3\".\"NAME\") AS \"voicing_actress\", MIN(\"t5\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t2\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t2\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t3\" ON \"t\".\"PERSON_ID\" = \"t3\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t4\" ON \"t\".\"ROLE_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t5\" ON \"t2\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":5.1351},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t23\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t25\".\"jap_engl_voiced_movie\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\", MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t11\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"PERSON_ID0\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t21\".\"ID\" = \"t19\".\"ROLE_ID\"\r\nGROUP BY \"t19\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t25\"\r\nWHERE \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":7.4328}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS voicing_actress,     MIN(t.title) AS jap_engl_voiced_movie FROM     aka_name AS an,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     info_type AS it,     movie_companies AS mc,     movie_info AS mi,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note in (         '(voice)',         '(voice: Japanese version)',         '(voice) (uncredited)',         '(voice: English version)'     )     AND cn.country_code = '[us]'     AND it.info = 'release dates'     AND mi.info is not null     and (         mi.info like 'Japan:%200%'         or mi.info like 'USA:%200%'     )     AND n.gender = 'f'     and n.name like '%An%'     AND rt.role = 'actress'     AND t.production_year > 2000     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND mc.movie_id = ci.movie_id     AND mc.movie_id = mi.movie_id     AND mi.movie_id = ci.movie_id     AND cn.id = mc.company_id     AND it.id = mi.info_type_id     AND n.id = ci.person_id     AND rt.id = ci.role_id     AND n.id = an.person_id     AND ci.person_id = an.person_id     AND chn.id = ci.person_role_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t19\".\"jap_engl_voiced_movie\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"ROLE_ID\", \"t11\".\"MOVIE_ID\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"PERSON_ID0\", \"t9\".\"ROLE_ID\", \"t10\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t3\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID0\", \"t9\".\"ROLE_ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"ROLE_ID\", \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":9.8846},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND \"NAME\".\"GENDER\" = 'f') AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\")) AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"))))","rewrite_time":1.645},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"NAME2\") AS \"voicing_actress\", MIN(\"t9\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t3\",\r\n\"MOVIE_INFO\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"t3\".\"ID3\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f') AS \"t5\"\r\nWHERE \"t4\".\"PERSON_ID0\" = \"t5\".\"ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t7\"\r\nWHERE \"t7\".\"ID\" = \"t6\".\"ROLE_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID1\" = \"t9\".\"ID\"","rewrite_time":5.1906},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"NAME\") AS \"voicing_actress\", MIN(\"t4\".\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_INFO\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f') AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t3\" ON \"t\".\"ROLE_ID\" = \"t3\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t4\" ON \"MOVIE_INFO\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.6529},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t22\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t24\".\"jap_engl_voiced_movie\") AS \"jap_engl_voiced_movie\"\r\nFROM (SELECT \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t9\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID0\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"PERSON_ID0\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t20\".\"ID\" = \"t18\".\"ROLE_ID\"\r\nGROUP BY \"t18\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"jap_engl_voiced_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":10.7982}],"num_rewrites":5,"raw_query":"SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS jap_engl_voiced_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note  in ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info  = 'release dates' AND n.gender ='f' AND rt.role ='actress' AND t.production_year  > 2000 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"production_note\") AS \"production_note\", MIN(\"t8\".\"movie_title\") AS \"movie_title\", MIN(\"t8\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE (\"NOTE\" LIKE '%(co-production)%' OR \"NOTE\" LIKE '%(presents)%') AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.7121},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"INFO_TYPE\".\"INFO\" = 'top 250 rank' AND (\"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(co-production)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(presents)%')) AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":1.3348},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE (\"NOTE\" LIKE '%(co-production)%' OR \"NOTE\" LIKE '%(presents)%') AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t3\",\r\n\"TITLE\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.3812},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE (\"NOTE\" LIKE '%(co-production)%' OR \"NOTE\" LIKE '%(presents)%') AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"TITLE\" ON \"t1\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.8365},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"production_note\") AS \"production_note\", MIN(\"t10\".\"movie_title\") AS \"movie_title\", MIN(\"t10\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE (\"NOTE\" LIKE '%(co-production)%' OR \"NOTE\" LIKE '%(presents)%') AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":3.1531}],"num_rewrites":5,"raw_query":"SELECT     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_title,     MIN(t.production_year) AS movie_year FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info_idx AS mi_idx,     title AS t WHERE     ct.kind = 'production companies'     AND it.info = 'top 250 rank'     AND mc.note not like '%(as Metro-Goldwyn-Mayer Pictures)%'     and (         mc.note like '%(co-production)%'         or mc.note like '%(presents)%'     )     AND ct.id = mc.company_type_id     AND t.id = mc.movie_id     AND t.id = mi_idx.movie_id     AND mc.movie_id = mi_idx.movie_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"production_note\") AS \"production_note\", MIN(\"t9\".\"movie_title\") AS \"movie_title\", MIN(\"t9\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":3.5883},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"INFO_TYPE\".\"INFO\" = 'bottom 10 rank' AND (\"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2005 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2010)) AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":1.0125},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NOTE\") AS \"production_note\", MIN(\"t4\".\"TITLE\") AS \"movie_title\", MIN(\"t4\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.551},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NOTE\") AS \"production_note\", MIN(\"t2\".\"TITLE\") AS \"movie_title\", MIN(\"t2\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.2014},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"production_note\") AS \"production_note\", MIN(\"t11\".\"movie_title\") AS \"movie_title\", MIN(\"t11\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":2.9561}],"num_rewrites":5,"raw_query":"SELECT     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_title,     MIN(t.production_year) AS movie_year FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info_idx AS mi_idx,     title AS t WHERE     ct.kind = 'production companies'     AND it.info = 'bottom 10 rank'     AND mc.note not like '%(as Metro-Goldwyn-Mayer Pictures)%'     AND t.production_year between 2005     and 2010     AND ct.id = mc.company_type_id     AND t.id = mc.movie_id     AND t.id = mi_idx.movie_id     AND mc.movie_id = mi_idx.movie_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"production_note\") AS \"production_note\", MIN(\"t9\".\"movie_title\") AS \"movie_title\", MIN(\"t9\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(co-production)%' AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":3.0571},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"INFO_TYPE\".\"INFO\" = 'top 250 rank' AND (\"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(co-production)%' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2010)) AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":0.9897},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NOTE\") AS \"production_note\", MIN(\"t4\".\"TITLE\") AS \"movie_title\", MIN(\"t4\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(co-production)%' AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.3287},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NOTE\") AS \"production_note\", MIN(\"t2\".\"TITLE\") AS \"movie_title\", MIN(\"t2\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(co-production)%' AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.1298},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"production_note\") AS \"production_note\", MIN(\"t11\".\"movie_title\") AS \"movie_title\", MIN(\"t11\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'top 250 rank'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(co-production)%' AND \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":3.1009}],"num_rewrites":5,"raw_query":"SELECT     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_title,     MIN(t.production_year) AS movie_year FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info_idx AS mi_idx,     title AS t WHERE     ct.kind = 'production companies'     AND it.info = 'top 250 rank'     AND mc.note not like '%(as Metro-Goldwyn-Mayer Pictures)%'     and (mc.note like '%(co-production)%')     AND t.production_year > 2010     AND ct.id = mc.company_type_id     AND t.id = mc.movie_id     AND t.id = mi_idx.movie_id     AND mc.movie_id = mi_idx.movie_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"production_note\") AS \"production_note\", MIN(\"t9\".\"movie_title\") AS \"movie_title\", MIN(\"t9\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.844},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_COMPANIES\".\"NOTE\") AS \"production_note\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\", MIN(\"TITLE\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO_IDX\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"INFO_TYPE\".\"INFO\" = 'bottom 10 rank' AND (\"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000) AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":0.8794},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"NOTE\") AS \"production_note\", MIN(\"t4\".\"TITLE\") AS \"movie_title\", MIN(\"t4\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.2247},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NOTE\") AS \"production_note\", MIN(\"t2\".\"TITLE\") AS \"movie_title\", MIN(\"t2\".\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.1781},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"production_note\") AS \"production_note\", MIN(\"t11\".\"movie_title\") AS \"movie_title\", MIN(\"t11\".\"movie_year\") AS \"movie_year\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"production_note\") AS \"production_note\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'bottom 10 rank'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", MIN(\"NOTE\") AS \"production_note\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\", MIN(\"PRODUCTION_YEAR\") AS \"movie_year\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":2.8435}],"num_rewrites":5,"raw_query":"SELECT     MIN(mc.note) AS production_note,     MIN(t.title) AS movie_title,     MIN(t.production_year) AS movie_year FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info_idx AS mi_idx,     title AS t WHERE     ct.kind = 'production companies'     AND it.info = 'bottom 10 rank'     AND mc.note not like '%(as Metro-Goldwyn-Mayer Pictures)%'     AND t.production_year > 2000     AND ct.id = mc.company_type_id     AND t.id = mc.movie_id     AND t.id = mi_idx.movie_id     AND mc.movie_id = mi_idx.movie_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"complete_downey_ironman_movie\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t13\".\"ID\" AS \"ID0\", \"t14\".\"MOVIE_ID\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\" ON \"t9\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\" ON \"t17\".\"ID0\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":7.2961},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND (\"CHAR_NAME\".\"NAME\" NOT LIKE '%Sherlock%' AND (\"CHAR_NAME\".\"NAME\" LIKE '%Tony%Stark%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Iron%Man%')) AND ((\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'sequel' OR (\"KEYWORD\".\"KEYWORD\" = 'second-part' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics') OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'tv-special' OR (\"KEYWORD\".\"KEYWORD\" = 'fight' OR \"KEYWORD\".\"KEYWORD\" = 'violence'))) AND \"KIND_TYPE\".\"KIND\" = 'movie' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 1950 AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.6597},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t5\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t7\".\"PERSON_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t9\"\r\nWHERE \"t8\".\"ID5\" = \"t9\".\"KIND_ID\" AND \"t8\".\"MOVIE_ID1\" = \"t9\".\"ID\"","rewrite_time":5.4261},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950) AS \"t4\" ON \"t3\".\"ID\" = \"t4\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.6817},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"complete_downey_ironman_movie\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t16\".\"ID\" AS \"ID0\", \"t17\".\"MOVIE_ID\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t16\".\"ID\", \"t17\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t20\".\"ID\" = \"t19\".\"PERSON_ID\"\r\nGROUP BY \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1950\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\"\r\nWHERE \"t22\".\"ID0\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":7.2152}],"num_rewrites":5,"raw_query":"SELECT MIN(t.title) AS complete_downey_ironman_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  like '%complete%' AND chn.name  not like '%Sherlock%' and (chn.name like '%Tony%Stark%' or chn.name like '%Iron%Man%') AND k.keyword  in ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND kt.kind  = 'movie' AND t.production_year  > 1950 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t20\".\"complete_downey_ironman_movie\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t13\".\"ID\" AS \"ID0\", \"t14\".\"MOVIE_ID\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\" ON \"t9\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"PERSON_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\" ON \"t18\".\"ID0\" = \"t20\".\"KIND_ID\" AND \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":7.0907},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND (\"CHAR_NAME\".\"NAME\" NOT LIKE '%Sherlock%' AND ((\"CHAR_NAME\".\"NAME\" LIKE '%Tony%Stark%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Iron%Man%') AND (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'sequel' OR (\"KEYWORD\".\"KEYWORD\" = 'second-part' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics') OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'tv-special' OR (\"KEYWORD\".\"KEYWORD\" = 'fight' OR \"KEYWORD\".\"KEYWORD\" = 'violence'))))) AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.6264},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t5\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t8\"\r\nWHERE \"t8\".\"ID\" = \"t7\".\"PERSON_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t10\"\r\nWHERE \"t9\".\"ID5\" = \"t10\".\"KIND_ID\" AND \"t9\".\"MOVIE_ID1\" = \"t10\".\"ID\"","rewrite_time":5.3499},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t5\".\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t4\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t5\" ON \"t3\".\"ID\" = \"t5\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":4.7686},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t25\".\"complete_downey_ironman_movie\") AS \"complete_downey_ironman_movie\"\r\nFROM (SELECT \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t16\".\"ID\" AS \"ID0\", \"t17\".\"MOVIE_ID\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE (\"NAME\" LIKE '%Tony%Stark%' OR \"NAME\" LIKE '%Iron%Man%') AND \"NAME\" NOT LIKE '%Sherlock%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t16\".\"ID\", \"t17\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t21\".\"ID\" = \"t19\".\"PERSON_ID\"\r\nGROUP BY \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_downey_ironman_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\"\r\nWHERE \"t23\".\"ID0\" = \"t25\".\"KIND_ID\" AND \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":7.0402}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS complete_downey_ironman_movie FROM     complete_cast AS cc,     comp_cast_type AS cct1,     comp_cast_type AS cct2,     char_name AS chn,     cast_info AS ci,     keyword AS k,     kind_type AS kt,     movie_keyword AS mk,     name AS n,     title AS t WHERE     cct1.kind = 'cast'     AND cct2.kind like '%complete%'     AND chn.name not like '%Sherlock%'     and (         chn.name like '%Tony%Stark%'         or chn.name like '%Iron%Man%'     )     AND k.keyword in (         'superhero',         'sequel',         'second-part',         'marvel-comics',         'based-on-comic',         'tv-special',         'fight',         'violence'     )     AND kt.kind = 'movie'     AND n.name LIKE '%Downey%Robert%'     AND t.production_year > 2000     AND kt.id = t.kind_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND t.id = cc.movie_id     AND mk.movie_id = ci.movie_id     AND mk.movie_id = cc.movie_id     AND ci.movie_id = cc.movie_id     AND chn.id = ci.person_role_id     AND n.id = ci.person_id     AND k.id = mk.keyword_id     AND cct1.id = cc.subject_id     AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"cast_member\") AS \"cast_member\", MIN(\"t19\".\"complete_dynamic_hero_movie\") AS \"complete_dynamic_hero_movie\"\r\nFROM (SELECT \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\", MIN(\"t16\".\"cast_member\") AS \"cast_member\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t13\".\"ID\" AS \"ID0\", \"t14\".\"MOVIE_ID\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\" ON \"t9\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"cast_member\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"PERSON_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t15\".\"ID0\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_dynamic_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\" ON \"t17\".\"ID0\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":7.0155},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"cast_member\", MIN(\"TITLE\".\"TITLE\") AS \"complete_dynamic_hero_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND (\"CHAR_NAME\".\"NAME\" IS NOT NULL AND (\"CHAR_NAME\".\"NAME\" LIKE '%man%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Man%')) AND ((\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics' OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR (\"KEYWORD\".\"KEYWORD\" = 'tv-special' OR \"KEYWORD\".\"KEYWORD\" = 'fight')) OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'magnet' OR (\"KEYWORD\".\"KEYWORD\" = 'web' OR (\"KEYWORD\".\"KEYWORD\" = 'claw' OR \"KEYWORD\".\"KEYWORD\" = 'laser')))) AND \"KIND_TYPE\".\"KIND\" = 'movie' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.6908},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"NAME0\") AS \"cast_member\", MIN(\"t9\".\"TITLE\") AS \"complete_dynamic_hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t5\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t7\".\"PERSON_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t9\"\r\nWHERE \"t8\".\"ID5\" = \"t9\".\"KIND_ID\" AND \"t8\".\"MOVIE_ID1\" = \"t9\".\"ID\"","rewrite_time":5.2281},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"cast_member\", MIN(\"t4\".\"TITLE\") AS \"complete_dynamic_hero_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t4\" ON \"t3\".\"ID\" = \"t4\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.7547},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t22\".\"cast_member\") AS \"cast_member\", MIN(\"t24\".\"complete_dynamic_hero_movie\") AS \"complete_dynamic_hero_movie\"\r\nFROM (SELECT \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\", MIN(\"t20\".\"cast_member\") AS \"cast_member\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t16\".\"ID\" AS \"ID0\", \"t17\".\"MOVIE_ID\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t16\".\"ID\", \"t17\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"cast_member\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t20\".\"ID\" = \"t19\".\"PERSON_ID\"\r\nGROUP BY \"t19\".\"ID0\", \"t19\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_dynamic_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\"\r\nWHERE \"t22\".\"ID0\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":6.6249}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS cast_member,     MIN(t.title) AS complete_dynamic_hero_movie FROM     complete_cast AS cc,     comp_cast_type AS cct1,     comp_cast_type AS cct2,     char_name AS chn,     cast_info AS ci,     keyword AS k,     kind_type AS kt,     movie_keyword AS mk,     name AS n,     title AS t WHERE     cct1.kind = 'cast'     AND cct2.kind like '%complete%'     AND chn.name is not NULL     and (         chn.name like '%man%'         or chn.name like '%Man%'     )     AND k.keyword in (         'superhero',         'marvel-comics',         'based-on-comic',         'tv-special',         'fight',         'violence',         'magnet',         'web',         'claw',         'laser'     )     AND kt.kind = 'movie'     AND t.production_year > 2000     AND kt.id = t.kind_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND t.id = cc.movie_id     AND mk.movie_id = ci.movie_id     AND mk.movie_id = cc.movie_id     AND ci.movie_id = cc.movie_id     AND chn.id = ci.person_role_id     AND n.id = ci.person_id     AND k.id = mk.keyword_id     AND cct1.id = cc.subject_id     AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"company_name\", \"link_type\", \"western_follow_up\")","rewrite_time":2.611},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"company_name\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"western_follow_up\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"KEYWORD\".\"KEYWORD\" = 'sequel' AND \"LINK_TYPE\".\"LINK\" LIKE '%follow%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Denmark') OR (\"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'Denish' OR (\"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR \"MOVIE_INFO\".\"INFO\" = 'German'))) AND \"TITLE\".\"PRODUCTION_YEAR\" >= 1950) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2000 AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))))","rewrite_time":1.5786},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"company_name\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID2\" = \"t2\".\"ID\"","rewrite_time":2.6742},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.5665},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":2.457},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"company_name\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"western_follow_up\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000) AS \"t0\" ON \"t\".\"MOVIE_ID2\" = \"t0\".\"ID\"","rewrite_time":2.0898},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"western_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID2\" = \"ID\"","rewrite_time":2.7198},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"western_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.9349}],"num_rewrites":8,"raw_query":"SELECT MIN(cn.name) AS company_name, MIN(lt.link) AS link_type, MIN(t.title) AS western_follow_up FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year BETWEEN 1950 AND 2000 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"company_name\", \"link_type\", \"german_follow_up\")","rewrite_time":2.2776},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"company_name\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"german_follow_up\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"KEYWORD\".\"KEYWORD\" = 'sequel' AND \"LINK_TYPE\".\"LINK\" LIKE '%follow%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND ((\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'German') AND \"TITLE\".\"PRODUCTION_YEAR\" >= 2000) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))))","rewrite_time":1.7227},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"company_name\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"german_follow_up\") AS \"german_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"german_follow_up\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID2\" = \"t2\".\"ID\"","rewrite_time":3.7049},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"german_follow_up\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.7262},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"german_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":3.2944},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"company_name\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"german_follow_up\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t0\" ON \"t\".\"MOVIE_ID2\" = \"t0\".\"ID\"","rewrite_time":2.0545},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"german_follow_up\") AS \"german_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"german_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"german_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID2\" = \"ID\"","rewrite_time":2.6839},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"german_follow_up\") AS \"german_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"german_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"german_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.144}],"num_rewrites":8,"raw_query":"SELECT     MIN(cn.name) AS company_name,     MIN(lt.link) AS link_type,     MIN(t.title) AS german_follow_up FROM     company_name AS cn,     company_type AS ct,     keyword AS k,     link_type AS lt,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     movie_link AS ml,     title AS t WHERE     cn.country_code != '[pl]'     AND (         cn.name LIKE '%Film%'         OR cn.name LIKE '%Warner%'     )     AND ct.kind = 'production companies'     AND k.keyword = 'sequel'     AND lt.link LIKE '%follow%'     AND mc.note IS NULL     AND mi.info IN ('Germany', 'German')     AND t.production_year BETWEEN 2000     AND 2010     AND lt.id = ml.link_type_id     AND ml.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_type_id = ct.id     AND mc.company_id = cn.id     AND mi.movie_id = t.id     AND ml.movie_id = mk.movie_id     AND ml.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id     AND ml.movie_id = mi.movie_id     AND mk.movie_id = mi.movie_id     AND mc.movie_id = mi.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"company_name\", \"link_type\", \"western_follow_up\")","rewrite_time":2.4587},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"company_name\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"western_follow_up\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"KEYWORD\".\"KEYWORD\" = 'sequel' AND \"LINK_TYPE\".\"LINK\" LIKE '%follow%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Denmark') OR (\"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'Denish' OR (\"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR \"MOVIE_INFO\".\"INFO\" = 'English')))) AND \"TITLE\".\"PRODUCTION_YEAR\" >= 1950) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))))","rewrite_time":1.6255},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"company_name\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID2\" = \"t2\".\"ID\"","rewrite_time":2.2552},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":2.3678},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID7\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":2.3267},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"company_name\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"western_follow_up\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t0\" ON \"t\".\"MOVIE_ID2\" = \"t0\".\"ID\"","rewrite_time":1.8575},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"western_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID2\" = \"ID\"","rewrite_time":2.7925},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"company_name\", MIN(\"LINK\") AS \"link_type\", MIN(\"western_follow_up\") AS \"western_follow_up\"\r\nFROM (SELECT \"MOVIE_ID2\", \"NAME\", \"LINK\", \"ID7\" AS \"ID\", \"western_follow_up\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID\", \"NAME\", \"COUNTRY_CODE\", \"KIND\", \"ID0\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID1\", \"LINK\", \"ID2\", \"NOTE\", \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"ID3\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID0\", \"ID4\", \"INFO\", \"MOVIE_ID1\", \"ID5\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID2\", \"LINK_TYPE_ID\", \"ID6\", \"ID7\", \"western_follow_up\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.3481}],"num_rewrites":8,"raw_query":"SELECT MIN(cn.name) AS company_name, MIN(lt.link) AS link_type, MIN(t.title) AS western_follow_up FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English') AND t.production_year BETWEEN 1950 AND 2010 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":8.3023},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'German' OR \"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American') AND \"MOVIE_INFO_IDX\".\"INFO\" < '7.0') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2008 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":1.9236},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME\") AS \"movie_company\", MIN(\"t10\".\"INFO2\") AS \"rating\", MIN(\"t11\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\"\r\nWHERE \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')) AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0') AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t9\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008) AS \"t11\"\r\nWHERE \"t10\".\"ID4\" = \"t11\".\"KIND_ID\" AND \"t10\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":5.8487},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t6\".\"INFO\") AS \"rating\", MIN(\"t7\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\" ON \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')) AS \"t5\" ON \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0') AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008) AS \"t7\" ON \"t3\".\"ID\" = \"t7\".\"KIND_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":5.2671},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"ID4\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":8.6798},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID3\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t22\" ON \"t20\".\"ID4\" = \"t22\".\"KIND_ID\" AND \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":7.9209},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t24\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID3\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID4\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID0\" = \"t24\".\"ID\"","rewrite_time":8.2585},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID3\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t25\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\"\r\nWHERE \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":8.5787},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID3\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t21\".\"ID4\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\"","rewrite_time":8.2205},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t26\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID3\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\") AS \"t29\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"ID4\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID0\" = \"t31\".\"ID\"","rewrite_time":8.2341}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info  < '7.0' AND t.production_year  > 2008 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":7.9044},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'German' OR \"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American') AND \"MOVIE_INFO_IDX\".\"INFO\" < '7.0') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2009 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":2.0189},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME\") AS \"movie_company\", MIN(\"t10\".\"INFO2\") AS \"rating\", MIN(\"t11\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\"\r\nWHERE \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')) AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0') AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t9\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009) AS \"t11\"\r\nWHERE \"t10\".\"ID4\" = \"t11\".\"KIND_ID\" AND \"t10\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":5.7442},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t6\".\"INFO\") AS \"rating\", MIN(\"t7\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\" ON \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')) AS \"t5\" ON \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0') AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009) AS \"t7\" ON \"t3\".\"ID\" = \"t7\".\"KIND_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":5.3193},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"ID4\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":8.684},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID3\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t22\" ON \"t20\".\"ID4\" = \"t22\".\"KIND_ID\" AND \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":7.9426},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t24\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID3\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID4\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID0\" = \"t24\".\"ID\"","rewrite_time":7.8618},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID3\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t25\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\"\r\nWHERE \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":8.604},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID3\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t21\".\"ID4\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\"","rewrite_time":9.8052},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'German', 'Germany', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t26\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID3\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\") AS \"t29\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2009\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"ID4\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID0\" = \"t31\".\"ID\"","rewrite_time":8.2302}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info  < '7.0' AND t.production_year  > 2009 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":8.1229},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Danish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND \"MOVIE_INFO_IDX\".\"INFO\" < '8.5') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2005 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":1.9513},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME\") AS \"movie_company\", MIN(\"t10\".\"INFO2\") AS \"rating\", MIN(\"t11\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\"\r\nWHERE \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t6\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t9\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t11\"\r\nWHERE \"t10\".\"ID4\" = \"t11\".\"KIND_ID\" AND \"t10\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":6.0017},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t6\".\"INFO\") AS \"rating\", MIN(\"t7\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t4\" ON \"COMPANY_TYPE\".\"ID\" = \"t4\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"t4\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t5\" ON \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t7\" ON \"t3\".\"ID\" = \"t7\".\"KIND_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":5.4588},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"ID4\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":8.8204},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID3\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t22\" ON \"t20\".\"ID4\" = \"t22\".\"KIND_ID\" AND \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":8.352},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t24\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID3\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID4\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID0\" = \"t24\".\"ID\"","rewrite_time":8.2435},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID3\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t25\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\"\r\nWHERE \"t25\".\"ID4\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":8.74},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t1\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID3\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t21\".\"ID4\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\"","rewrite_time":8.3823},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID0\" = \"t16\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t26\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID3\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID4\", \"t26\".\"MOVIE_ID0\") AS \"t29\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"ID4\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID0\" = \"t31\".\"ID\"","rewrite_time":8.3614}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info  < '8.5' AND t.production_year  > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t15\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t15\" ON \"t14\".\"ID0\" = \"t15\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t19\".\"ID2\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\" ON \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID3\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"ID4\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":7.8958},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'countries' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Danish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))))) AND (\"MOVIE_INFO_IDX\".\"INFO\" < '8.5' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2005 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":1.9231},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"NAME\") AS \"movie_company\", MIN(\"t9\".\"INFO2\") AS \"rating\", MIN(\"t10\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t5\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID2\" = \"t7\".\"INFO_TYPE_ID\") AS \"t8\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t8\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t10\"\r\nWHERE \"t9\".\"ID4\" = \"t10\".\"KIND_ID\" AND \"t9\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":5.6661},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"movie_company\", MIN(\"t5\".\"INFO\") AS \"rating\", MIN(\"t6\".\"TITLE\") AS \"western_violent_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t4\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t5\" ON \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t4\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t6\" ON \"t3\".\"ID\" = \"t6\".\"KIND_ID\" AND \"t4\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":5.0418},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t23\".\"rating\") AS \"rating\", MIN(\"t25\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t10\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t1\".\"ID\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID3\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"ID4\", \"t20\".\"MOVIE_ID0\") AS \"t23\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\"\r\nWHERE \"t23\".\"ID4\" = \"t25\".\"KIND_ID\" AND \"t23\".\"MOVIE_ID0\" = \"t25\".\"ID\"","rewrite_time":8.1157},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\", MIN(\"t21\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_company\") AS \"movie_company\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t11\".\"ID2\", \"t11\".\"ID3\", \"t11\".\"ID4\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t10\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t1\".\"ID\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID1\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"ID2\", \"t11\".\"ID3\", \"t11\".\"ID4\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID2\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"MOVIE_ID0\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID3\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t21\" ON \"t19\".\"ID4\" = \"t21\".\"KIND_ID\" AND \"t19\".\"MOVIE_ID0\" = \"t21\".\"ID\"","rewrite_time":7.8883},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t10\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t1\".\"ID\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID3\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"ID4\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t21\".\"ID4\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\"","rewrite_time":7.6709},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t10\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t1\".\"ID\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\"\r\nWHERE \"t24\".\"ID4\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":8.0535},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t20\".\"movie_company\") AS \"movie_company\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t22\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_company\") AS \"movie_company\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_company\") AS \"movie_company\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t10\".\"MOVIE_ID\", MIN(\"t0\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t1\".\"ID\" = \"t10\".\"COMPANY_TYPE_ID\" AND \"t0\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID4\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID3\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID4\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t22\" ON \"t20\".\"ID4\" = \"t22\".\"KIND_ID\" AND \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":7.7544},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t28\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"western_violent_movie\") AS \"western_violent_movie\"\r\nFROM (SELECT \"t25\".\"ID4\", \"t25\".\"MOVIE_ID0\", MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t17\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t15\".\"MOVIE_ID\", MIN(\"t14\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"movie_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"movie_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID0\" = \"t15\".\"COMPANY_TYPE_ID\" AND \"t14\".\"ID\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID2\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"MOVIE_ID0\") AS \"t25\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\"\r\nWHERE \"t25\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID3\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"ID4\", \"t25\".\"MOVIE_ID0\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"western_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"ID4\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID0\" = \"t30\".\"ID\"","rewrite_time":7.8368}],"num_rewrites":10,"raw_query":"SELECT     MIN(cn.name) AS movie_company,     MIN(mi_idx.info) AS rating,     MIN(t.title) AS western_violent_movie FROM     company_name AS cn,     company_type AS ct,     info_type AS it1,     info_type AS it2,     keyword AS k,     kind_type AS kt,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     title AS t WHERE     cn.country_code != '[us]'     AND it1.info = 'countries'     AND it2.info = 'rating'     AND k.keyword in ('murder', 'murder-in-title', 'blood', 'violence')     AND kt.kind in ('movie', 'episode')     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Danish',         'Norwegian',         'German',         'USA',         'American'     )     AND mi_idx.info < '8.5'     AND t.production_year > 2005     AND kt.id = t.kind_id     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND t.id = mi_idx.movie_id     AND t.id = mc.movie_id     AND mk.movie_id = mi.movie_id     AND mk.movie_id = mi_idx.movie_id     AND mk.movie_id = mc.movie_id     AND mi.movie_id = mi_idx.movie_id     AND mi.movie_id = mc.movie_id     AND mc.movie_id = mi_idx.movie_id     AND k.id = mk.keyword_id     AND it1.id = mi.info_type_id     AND it2.id = mi_idx.info_type_id     AND ct.id = mc.company_type_id     AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"movie_kind\") AS \"movie_kind\", MIN(\"t19\".\"complete_us_internet_movie\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t14\".\"MOVIE_ID\", MIN(\"t12\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t7\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"STATUS_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t2\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t11\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\" ON \"t17\".\"ID3\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":8.0113},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KIND_TYPE\".\"KIND\") AS \"movie_kind\", MIN(\"TITLE\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'complete+verified' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND (\"MOVIE_INFO\".\"NOTE\" LIKE '%internet%' AND \"MOVIE_INFO\".\"INFO\" IS NOT NULL)) AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 199%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.898},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"KIND1\") AS \"movie_kind\", MIN(\"t8\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n\"KEYWORD\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID4\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t8\"\r\nWHERE \"t7\".\"ID5\" = \"t8\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID1\" = \"t8\".\"ID\"","rewrite_time":5.4269},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"KIND\") AS \"movie_kind\", MIN(\"t4\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nCROSS JOIN \"KEYWORD\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t3\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t3\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t4\" ON \"t2\".\"ID\" = \"t4\".\"KIND_ID\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.9326},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t21\".\"movie_kind\") AS \"movie_kind\", MIN(\"t23\".\"complete_us_internet_movie\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t8\".\"ID\" AS \"ID1\", \"t9\".\"ID\" AS \"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"STATUS_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t12\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t12\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"ID3\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID\" = \"t23\".\"ID\"","rewrite_time":7.1083}],"num_rewrites":5,"raw_query":"SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_us_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind  = 'complete+verified' AND cn.country_code  = '[us]' AND it1.info  = 'release dates' AND kt.kind  in ('movie') AND mi.note  like '%internet%' AND mi.info  is not NULL and (mi.info like 'USA:% 199%' or mi.info like 'USA:% 200%') AND t.production_year  > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"movie_kind\") AS \"movie_kind\", MIN(\"t20\".\"complete_nerdy_internet_movie\") AS \"complete_nerdy_internet_movie\"\r\nFROM (SELECT \"t16\".\"ID3\", \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t13\".\"ID2\", \"t13\".\"ID3\", \"t15\".\"MOVIE_ID\", MIN(\"t13\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t7\".\"ID\" AS \"ID1\", \"t9\".\"ID\" AS \"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"STATUS_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('alienation', 'dignity', 'loner', 'nerd')\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t2\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t12\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t12\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"ID2\", \"t13\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t16\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_nerdy_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t20\" ON \"t18\".\"ID3\" = \"t20\".\"KIND_ID\" AND \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":7.2514},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KIND_TYPE\".\"KIND\") AS \"movie_kind\", MIN(\"TITLE\".\"TITLE\") AS \"complete_nerdy_internet_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'complete+verified' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND ((\"KEYWORD\".\"KEYWORD\" = 'nerd' OR \"KEYWORD\".\"KEYWORD\" = 'loner' OR \"KEYWORD\".\"KEYWORD\" = 'alienation' OR \"KEYWORD\".\"KEYWORD\" = 'dignity') AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND \"MOVIE_INFO\".\"NOTE\" LIKE '%internet%')) AND (\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.8037},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"KIND1\") AS \"movie_kind\", MIN(\"t9\".\"TITLE\") AS \"complete_nerdy_internet_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('alienation', 'dignity', 'loner', 'nerd')) AS \"t3\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t4\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t6\"\r\nWHERE \"t5\".\"MOVIE_ID0\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID3\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t7\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t7\".\"ID4\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t9\"\r\nWHERE \"t8\".\"ID5\" = \"t9\".\"KIND_ID\" AND \"t8\".\"MOVIE_ID1\" = \"t9\".\"ID\"","rewrite_time":5.3741},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t3\".\"KIND\") AS \"movie_kind\", MIN(\"t5\".\"TITLE\") AS \"complete_nerdy_internet_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('alienation', 'dignity', 'loner', 'nerd')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%') AS \"t4\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t4\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t5\" ON \"t3\".\"ID\" = \"t5\".\"KIND_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":4.9955},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t22\".\"movie_kind\") AS \"movie_kind\", MIN(\"t24\".\"complete_nerdy_internet_movie\") AS \"complete_nerdy_internet_movie\"\r\nFROM (SELECT \"t19\".\"ID3\", \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t15\".\"ID2\", \"t15\".\"ID3\", \"t17\".\"MOVIE_ID\", MIN(\"t15\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t8\".\"ID\" AS \"ID1\", \"t10\".\"ID\" AS \"ID2\", \"t12\".\"ID\" AS \"ID3\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"STATUS_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('alienation', 'dignity', 'loner', 'nerd')\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t13\"\r\nWHERE \"t13\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t13\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t13\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ID\", \"t10\".\"ID\", \"t12\".\"ID\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND \"INFO\" LIKE 'USA:% 200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\"\r\nWHERE \"t15\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t15\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"ID2\", \"t15\".\"ID3\", \"t17\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID2\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"ID3\", \"t19\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_nerdy_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\"\r\nWHERE \"t22\".\"ID3\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":7.1774}],"num_rewrites":5,"raw_query":"SELECT     MIN(kt.kind) AS movie_kind,     MIN(t.title) AS complete_nerdy_internet_movie FROM     complete_cast AS cc,     comp_cast_type AS cct1,     company_name AS cn,     company_type AS ct,     info_type AS it1,     keyword AS k,     kind_type AS kt,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     cct1.kind = 'complete+verified'     AND cn.country_code = '[us]'     AND it1.info = 'release dates'     AND k.keyword in ('nerd', 'loner', 'alienation', 'dignity')     AND kt.kind in ('movie')     AND mi.note like '%internet%'     AND mi.info like 'USA:% 200%'     AND t.production_year > 2000     AND kt.id = t.kind_id     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND t.id = mc.movie_id     AND t.id = cc.movie_id     AND mk.movie_id = mi.movie_id     AND mk.movie_id = mc.movie_id     AND mk.movie_id = cc.movie_id     AND mi.movie_id = mc.movie_id     AND mi.movie_id = cc.movie_id     AND mc.movie_id = cc.movie_id     AND k.id = mk.keyword_id     AND it1.id = mi.info_type_id     AND cn.id = mc.company_id     AND ct.id = mc.company_type_id     AND cct1.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"movie_kind\") AS \"movie_kind\", MIN(\"t19\".\"complete_us_internet_movie\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT \"t15\".\"ID3\", \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t12\".\"ID2\", \"t12\".\"ID3\", \"t14\".\"MOVIE_ID\", MIN(\"t12\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t7\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t10\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"STATUS_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('movie', 'tv movie', 'video game', 'video movie')\r\nGROUP BY \"ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t11\" ON \"t2\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t11\".\"COMPANY_ID\" AND \"t5\".\"ID\" = \"t11\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t7\".\"ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"ID2\", \"t12\".\"ID3\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"ID3\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t19\" ON \"t17\".\"ID3\" = \"t19\".\"KIND_ID\" AND \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":7.2191},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KIND_TYPE\".\"KIND\") AS \"movie_kind\", MIN(\"TITLE\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'complete+verified' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'tv movie' OR \"KIND_TYPE\".\"KIND\" = 'video movie' OR \"KIND_TYPE\".\"KIND\" = 'video game') AND (\"MOVIE_INFO\".\"NOTE\" LIKE '%internet%' AND \"MOVIE_INFO\".\"INFO\" IS NOT NULL)) AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 199%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:% 200%') AND (\"TITLE\".\"PRODUCTION_YEAR\" > 1990 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":1.8311},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"KIND1\") AS \"movie_kind\", MIN(\"t8\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n\"KEYWORD\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('movie', 'tv movie', 'video game', 'video movie')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID4\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t8\"\r\nWHERE \"t7\".\"ID5\" = \"t8\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID1\" = \"t8\".\"ID\"","rewrite_time":5.2189},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"KIND\") AS \"movie_kind\", MIN(\"t4\".\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nCROSS JOIN \"KEYWORD\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('movie', 'tv movie', 'video game', 'video movie')) AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')) AS \"t3\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t3\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t4\" ON \"t2\".\"ID\" = \"t4\".\"KIND_ID\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.7815},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t21\".\"movie_kind\") AS \"movie_kind\", MIN(\"t23\".\"complete_us_internet_movie\") AS \"complete_us_internet_movie\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t14\".\"ID2\", \"t14\".\"ID3\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t8\".\"ID\" AS \"ID1\", \"t9\".\"ID\" AS \"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t11\".\"movie_kind\") AS \"movie_kind\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"STATUS_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"KIND\") AS \"movie_kind\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('movie', 'tv movie', 'video game', 'video movie')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t12\".\"COMPANY_ID\" AND \"t6\".\"ID\" = \"t12\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t8\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"NOTE\" LIKE '%internet%' AND (\"INFO\" LIKE 'USA:% 199%' OR \"INFO\" LIKE 'USA:% 200%')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"ID2\", \"t14\".\"ID3\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_us_internet_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"ID3\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID\" = \"t23\".\"ID\"","rewrite_time":7.0873}],"num_rewrites":5,"raw_query":"SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_us_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind  = 'complete+verified' AND cn.country_code  = '[us]' AND it1.info  = 'release dates' AND kt.kind  in ('movie', 'tv movie', 'video movie', 'video game') AND mi.note  like '%internet%' AND mi.info  is not NULL and (mi.info like 'USA:% 199%' or mi.info like 'USA:% 200%') AND t.production_year  > 1990 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t27\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t19\".\"ROLE_ID\", \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t21\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID3\", \"t12\".\"ID\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t9\".\"PERSON_ID0\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\" AS \"ID3\", \"t11\".\"ID\", \"t9\".\"voiced_char_name\"\r\nFROM (SELECT \"t6\".\"PERSON_ID0\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t6\".\"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID2\" = \"t13\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID3\", \"t12\".\"ID\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID3\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"PERSON_ID0\" = \"t21\".\"ID\"\r\nGROUP BY \"t19\".\"ROLE_ID\", \"t19\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"ROLE_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID\" = \"t27\".\"ID\"","rewrite_time":12.3774},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress_name\", MIN(\"TITLE\".\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates') AND ((\"KEYWORD\".\"KEYWORD\" = 'hero' OR \"KEYWORD\".\"KEYWORD\" = 'martial-arts' OR \"KEYWORD\".\"KEYWORD\" = 'hand-to-hand-combat') AND \"MOVIE_INFO\".\"INFO\" IS NOT NULL AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%201%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%201%') AND \"NAME\".\"GENDER\" = 'f')) AND (\"NAME\".\"NAME\" LIKE '%An%' AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2010) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\")) AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\") AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))))","rewrite_time":2.3048},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME0\") AS \"voiced_char_name\", MIN(\"t11\".\"NAME2\") AS \"voicing_actress_name\", MIN(\"t12\".\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID4\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t8\"\r\nWHERE \"t7\".\"PERSON_ID0\" = \"t8\".\"ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t9\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"ID\"","rewrite_time":7.4937},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"t4\".\"NAME\") AS \"voicing_actress_name\", MIN(\"t6\".\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')) AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%') AS \"t3\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\" ON \"t\".\"ROLE_ID\" = \"t5\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":6.6028},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t28\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t28\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t30\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t24\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID1\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t10\".\"ID\" AS \"ID1\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID0\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID1\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"PERSON_ID0\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t26\".\"ID\" = \"t24\".\"ROLE_ID\"\r\nGROUP BY \"t24\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":10.549},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t22\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t24\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t18\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t11\".\"ID1\", \"t11\".\"MOVIE_ID0\", \"t13\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t9\".\"ID\" AS \"ID1\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t3\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t11\".\"ID1\", \"t11\".\"MOVIE_ID0\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"PERSON_ID0\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"ROLE_ID\" = \"t21\".\"ID\"\r\nGROUP BY \"t19\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":9.5171},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t24\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t24\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t26\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t21\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t20\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID3\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"PERSON_ID0\" = \"t20\".\"ID\"\r\nGROUP BY \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"ROLE_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":12.4722},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t29\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t29\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t31\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t21\".\"ROLE_ID\", \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t23\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t18\".\"PERSON_ID0\", \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID3\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID3\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID0\", \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"PERSON_ID0\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"ROLE_ID\", \"t21\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t27\"\r\nWHERE \"t27\".\"ID\" = \"t25\".\"ROLE_ID\"\r\nGROUP BY \"t25\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":10.4312},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t23\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t23\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t25\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t20\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t15\".\"PERSON_ID0\", \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"MOVIE_ID\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t3\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID3\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID0\", \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"PERSON_ID0\" = \"t19\".\"ID\"\r\nGROUP BY \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t22\" ON \"t20\".\"ROLE_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":11.3126},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t31\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t33\".\"voiced_action_movie_jap_eng\") AS \"voiced_action_movie_jap_eng\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t27\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t23\".\"ROLE_ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID\", \"t16\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID3\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", \"t10\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t12\".\"ID\", \"t10\".\"voiced_char_name\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID2\", \"t9\".\"ID\", \"t7\".\"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t9\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t12\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t14\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID2\" = \"t14\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID3\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID3\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID\", \"t16\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t25\"\r\nWHERE \"t23\".\"PERSON_ID0\" = \"t25\".\"ID\"\r\nGROUP BY \"t23\".\"ROLE_ID\", \"t23\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"ROLE_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_action_movie_jap_eng\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t33\".\"ID\"","rewrite_time":10.1035}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS voiced_char_name, MIN(n.name) AS voicing_actress_name, MIN(t.title) AS voiced_action_movie_jap_eng FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, role_type AS rt, title AS t WHERE ci.note  in ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info  = 'release dates' AND k.keyword  in ('hero', 'martial-arts', 'hand-to-hand-combat') AND mi.info  is not null and (mi.info like 'Japan:%201%' or mi.info like 'USA:%201%') AND n.gender ='f' and n.name like '%An%' AND rt.role ='actress' AND t.production_year  > 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND ci.movie_id = mk.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t27\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t19\".\"ROLE_ID\", \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t21\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID3\", \"t12\".\"ID\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t9\".\"PERSON_ID0\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\" AS \"ID3\", \"t11\".\"ID\", \"t9\".\"voiced_char_name\"\r\nFROM (SELECT \"t6\".\"PERSON_ID0\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", \"t6\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t6\".\"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t12\".\"ID2\" = \"t13\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID3\", \"t12\".\"ID\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID3\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"PERSON_ID0\" = \"t21\".\"ID\"\r\nGROUP BY \"t19\".\"ROLE_ID\", \"t19\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"ROLE_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID\" = \"t27\".\"ID\"","rewrite_time":10.3524},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress_name\", MIN(\"TITLE\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"COMPANY_NAME\".\"NAME\" = 'DreamWorks Animation') AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"KEYWORD\".\"KEYWORD\" = 'hero' OR \"KEYWORD\".\"KEYWORD\" = 'martial-arts' OR \"KEYWORD\".\"KEYWORD\" = 'hand-to-hand-combat' OR \"KEYWORD\".\"KEYWORD\" = 'computer-animated-movie') AND (\"MOVIE_INFO\".\"INFO\" IS NOT NULL AND (\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%201%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%201%'))) AND (\"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE '%An%' AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2010) AND (\"TITLE\".\"TITLE\" LIKE 'Kung Fu Panda%' AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\") AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))))","rewrite_time":2.3335},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME0\") AS \"voiced_char_name\", MIN(\"t11\".\"NAME2\") AS \"voicing_actress_name\", MIN(\"t12\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"t\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%') AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID3\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t6\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID4\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t8\"\r\nWHERE \"t7\".\"PERSON_ID0\" = \"t8\".\"ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t9\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%') AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"ID\"","rewrite_time":7.4563},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"t4\".\"NAME\") AS \"voicing_actress_name\", MIN(\"t6\".\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')) AS \"t2\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%') AS \"t3\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\" ON \"t\".\"ROLE_ID\" = \"t5\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%') AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":6.6013},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t28\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t28\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t30\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t24\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID1\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID0\", \"t10\".\"ID\" AS \"ID1\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t13\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID0\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID1\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID1\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"PERSON_ID0\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t26\".\"ID\" = \"t24\".\"ROLE_ID\"\r\nGROUP BY \"t24\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":10.8747},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t22\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t22\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t24\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t18\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t11\".\"ID1\", \"t11\".\"MOVIE_ID0\", \"t13\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID0\", \"t9\".\"ID\" AS \"ID1\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t3\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID0\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t11\".\"ID1\", \"t11\".\"MOVIE_ID0\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"KEYWORD_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"PERSON_ID0\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t21\" ON \"t19\".\"ROLE_ID\" = \"t21\".\"ID\"\r\nGROUP BY \"t19\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":9.9679},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t24\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t24\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t26\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t21\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t20\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID0\" = \"t15\".\"MOVIE_ID\" AND \"t13\".\"ID3\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID\", \"t13\".\"MOVIE_ID0\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"PERSON_ID0\" = \"t20\".\"ID\"\r\nGROUP BY \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"ROLE_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":9.5316},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t29\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t29\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t31\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t21\".\"ROLE_ID\", \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t23\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t18\".\"PERSON_ID0\", \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\", MIN(\"t18\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\" AS \"ID3\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t11\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"ROLE_ID\", \"t8\".\"ID\", \"t10\".\"ID\", \"t11\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t14\".\"ID3\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\", \"t14\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID0\", \"t18\".\"ROLE_ID\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t23\"\r\nWHERE \"t21\".\"PERSON_ID0\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"ROLE_ID\", \"t21\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t27\"\r\nWHERE \"t27\".\"ID\" = \"t25\".\"ROLE_ID\"\r\nGROUP BY \"t25\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":10.5926},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t23\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t23\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t25\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t20\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t15\".\"PERSON_ID0\", \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"MOVIE_ID\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t3\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"ROLE_ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t10\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t12\".\"MOVIE_ID0\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID3\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID0\", \"t12\".\"ROLE_ID\", \"t12\".\"ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID0\", \"t15\".\"ROLE_ID\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"PERSON_ID0\" = \"t19\".\"ID\"\r\nGROUP BY \"t17\".\"ROLE_ID\", \"t17\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t22\" ON \"t20\".\"ROLE_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":9.9405},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t31\".\"voicing_actress_name\") AS \"voicing_actress_name\", MIN(\"t33\".\"kung_fu_panda\") AS \"kung_fu_panda\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t27\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t23\".\"ROLE_ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t25\".\"voicing_actress_name\") AS \"voicing_actress_name\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID\", \"t16\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\", MIN(\"t16\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID3\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", \"t10\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t12\".\"ID\", \"t10\".\"voiced_char_name\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", \"t7\".\"ID\" AS \"ID2\", \"t9\".\"ID\", \"t7\".\"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t2\".\"PERSON_ID\" = \"t\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]' AND \"NAME\" = 'DreamWorks Animation'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t9\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('computer-animated-movie', 'hand-to-hand-combat', 'hero', 'martial-arts')\r\nGROUP BY \"ID\") AS \"t12\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t14\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t13\".\"ID2\" = \"t14\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID3\", \"t13\".\"ID\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%201%' OR \"INFO\" LIKE 'USA:%201%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t16\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t16\".\"ID3\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID\", \"t16\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress_name\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t25\"\r\nWHERE \"t23\".\"PERSON_ID0\" = \"t25\".\"ID\"\r\nGROUP BY \"t23\".\"ROLE_ID\", \"t23\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"ROLE_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"kung_fu_panda\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Kung Fu Panda%'\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t33\".\"ID\"","rewrite_time":10.5651}],"num_rewrites":10,"raw_query":"SELECT     MIN(chn.name) AS voiced_char_name,     MIN(n.name) AS voicing_actress_name,     MIN(t.title) AS kung_fu_panda FROM     aka_name AS an,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     info_type AS it,     keyword AS k,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note in (         '(voice)',         '(voice: Japanese version)',         '(voice) (uncredited)',         '(voice: English version)'     )     AND cn.country_code = '[us]'     AND cn.name = 'DreamWorks Animation'     AND it.info = 'release dates'     AND k.keyword in (         'hero',         'martial-arts',         'hand-to-hand-combat',         'computer-animated-movie'     )     AND mi.info is not null     and (         mi.info like 'Japan:%201%'         or mi.info like 'USA:%201%'     )     AND n.gender = 'f'     and n.name like '%An%'     AND rt.role = 'actress'     AND t.production_year > 2010     AND t.title like 'Kung Fu Panda%'     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND t.id = mk.movie_id     AND mc.movie_id = ci.movie_id     AND mc.movie_id = mi.movie_id     AND mc.movie_id = mk.movie_id     AND mi.movie_id = ci.movie_id     AND mi.movie_id = mk.movie_id     AND ci.movie_id = mk.movie_id     AND cn.id = mc.company_id     AND it.id = mi.info_type_id     AND n.id = ci.person_id     AND rt.id = ci.role_id     AND n.id = an.person_id     AND ci.person_id = an.person_id     AND chn.id = ci.person_role_id     AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t16\".\"male_writer\") AS \"male_writer\", MIN(\"t17\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\", MIN(\"t15\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"movie_budget\") AS \"movie_budget\", MIN(\"t10\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID1\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"PERSON_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":6.5045},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND \"INFO_TYPE\".\"INFO\" = 'genres' AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR \"KEYWORD\".\"KEYWORD\" = 'female-nudity') AND \"MOVIE_INFO\".\"INFO\" = 'Horror')) AND (\"NAME\".\"GENDER\" = 'm' AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))))","rewrite_time":1.5894},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"INFO1\") AS \"movie_budget\", MIN(\"t8\".\"INFO2\") AS \"movie_votes\", MIN(\"t8\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')) AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror') AS \"t3\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t5\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t7\"\r\nWHERE \"t7\".\"ID\" = \"t6\".\"PERSON_ID\") AS \"t8\",\r\n\"TITLE\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"TITLE\".\"ID\"","rewrite_time":4.6701},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t3\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t4\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')) AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror') AS \"t3\" ON \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":4.2038},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t20\".\"male_writer\") AS \"male_writer\", MIN(\"t21\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t18\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t18\".\"ID\" = \"t16\".\"PERSON_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"ID\"","rewrite_time":6.4765}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'blood', 'gore', 'death', 'female-nudity') AND mi.info  = 'Horror' AND n.gender  = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t16\".\"male_writer\") AS \"male_writer\", MIN(\"t18\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\", MIN(\"t15\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"movie_budget\") AS \"movie_budget\", MIN(\"t10\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID1\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"PERSON_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Vampire%'\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID0\" = \"t18\".\"ID\"","rewrite_time":6.5202},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND \"INFO_TYPE\".\"INFO\" = 'genres' AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR \"KEYWORD\".\"KEYWORD\" = 'female-nudity') AND \"MOVIE_INFO\".\"INFO\" = 'Horror')) AND (\"NAME\".\"GENDER\" = 'm' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND \"TITLE\".\"TITLE\" LIKE 'Vampire%') AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))))","rewrite_time":3.1465},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"INFO1\") AS \"movie_budget\", MIN(\"t8\".\"INFO2\") AS \"movie_votes\", MIN(\"t8\".\"NAME\") AS \"male_writer\", MIN(\"t9\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')) AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror') AS \"t3\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t5\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t7\"\r\nWHERE \"t7\".\"ID\" = \"t6\".\"PERSON_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Vampire%') AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t9\".\"ID\"","rewrite_time":8.1405},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t3\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t4\".\"NAME\") AS \"male_writer\", MIN(\"t5\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')) AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror') AS \"t3\" ON \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Vampire%') AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":6.8913},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t20\".\"male_writer\") AS \"male_writer\", MIN(\"t22\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t18\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'murder')\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Horror'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t18\".\"ID\" = \"t16\".\"PERSON_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010 AND \"TITLE\" LIKE 'Vampire%'\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t22\".\"ID\"","rewrite_time":6.7121}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'blood', 'gore', 'death', 'female-nudity') AND mi.info  = 'Horror' AND n.gender   = 'm' AND t.production_year  > 2010 AND t.title  like 'Vampire%' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t16\".\"male_writer\") AS \"male_writer\", MIN(\"t17\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\", MIN(\"t15\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\", MIN(\"t11\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\", MIN(\"t9\".\"movie_budget\") AS \"movie_budget\", MIN(\"t10\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t10\" ON \"t9\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID0\" = \"t10\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ID1\", \"t9\".\"MOVIE_ID0\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID1\" = \"t12\".\"KEYWORD_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID0\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"PERSON_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"ID\"","rewrite_time":6.5603},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND \"INFO_TYPE\".\"INFO\" = 'genres' AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR (\"MOVIE_INFO\".\"INFO\" = 'Action' OR \"MOVIE_INFO\".\"INFO\" = 'Sci-Fi') OR (\"MOVIE_INFO\".\"INFO\" = 'Thriller' OR (\"MOVIE_INFO\".\"INFO\" = 'Crime' OR \"MOVIE_INFO\".\"INFO\" = 'War'))))) AND (\"NAME\".\"GENDER\" = 'm' AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))))","rewrite_time":1.7236},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t8\".\"INFO1\") AS \"movie_budget\", MIN(\"t8\".\"INFO2\") AS \"movie_votes\", MIN(\"t8\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t2\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t3\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\") AS \"t4\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t5\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID2\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t7\"\r\nWHERE \"t7\".\"ID\" = \"t6\".\"PERSON_ID\") AS \"t8\",\r\n\"TITLE\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"TITLE\".\"ID\"","rewrite_time":4.7569},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t3\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t4\".\"NAME\") AS \"male_writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_movie_title\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t2\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t3\" ON \"t\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t4\" ON \"t\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t3\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":4.3386},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t20\".\"male_writer\") AS \"male_writer\", MIN(\"t21\".\"violent_movie_title\") AS \"violent_movie_title\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\", MIN(\"t18\".\"male_writer\") AS \"male_writer\"\r\nFROM (SELECT \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t13\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\", MIN(\"t10\".\"movie_budget\") AS \"movie_budget\", MIN(\"t11\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t8\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t8\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t11\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"MOVIE_ID0\") AS \"t13\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t14\".\"KEYWORD_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID0\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"male_writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t18\".\"ID\" = \"t16\".\"PERSON_ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID0\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"ID\"","rewrite_time":6.2598}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info  in ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND n.gender   = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t25\".\"playing_actor\") AS \"playing_actor\", MIN(\"t27\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\", MIN(\"t24\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t11\".\"ID\", \"t9\".\"character_name\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t18\".\"ID4\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\" ON \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID5\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t24\" ON \"t23\".\"PERSON_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t23\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"ID\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID\" = \"t27\".\"ID\"","rewrite_time":9.8415},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character_name\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"NAME\".\"NAME\") AS \"playing_actor\", MIN(\"TITLE\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND (\"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND \"CHAR_NAME\".\"NAME\" IS NOT NULL) AND ((\"CHAR_NAME\".\"NAME\" LIKE '%man%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Man%') AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics' OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR (\"KEYWORD\".\"KEYWORD\" = 'tv-special' OR \"KEYWORD\".\"KEYWORD\" = 'fight')) OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'magnet' OR (\"KEYWORD\".\"KEYWORD\" = 'web' OR (\"KEYWORD\".\"KEYWORD\" = 'claw' OR \"KEYWORD\".\"KEYWORD\" = 'laser')))))) AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND (\"MOVIE_INFO_IDX\".\"INFO\" > '7.0' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND (\"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":2.1144},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME\") AS \"character_name\", MIN(\"t11\".\"INFO0\") AS \"rating\", MIN(\"t11\".\"NAME0\") AS \"playing_actor\", MIN(\"t12\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0') AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t9\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t10\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t10\".\"PERSON_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t12\"\r\nWHERE \"t11\".\"ID6\" = \"t12\".\"KIND_ID\" AND \"t11\".\"MOVIE_ID2\" = \"t12\".\"ID\"","rewrite_time":6.8121},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"character_name\", MIN(\"t5\".\"INFO\") AS \"rating\", MIN(\"NAME\".\"NAME\") AS \"playing_actor\", MIN(\"t6\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t4\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0') AS \"t5\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t6\" ON \"t4\".\"ID\" = \"t6\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":6.0365},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t28\".\"character_name\") AS \"character_name\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t28\".\"playing_actor\") AS \"playing_actor\", MIN(\"t30\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t25\".\"ID1\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t26\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t22\".\"PERSON_ID\", \"t22\".\"ID1\", \"t23\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID0\", \"t18\".\"ID\" AS \"ID1\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID0\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID\", \"t22\".\"ID1\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t26\".\"ID\" = \"t25\".\"PERSON_ID\"\r\nGROUP BY \"t25\".\"ID1\", \"t25\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"ID1\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":9.8121},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t22\".\"playing_actor\") AS \"playing_actor\", MIN(\"t24\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t20\".\"ID1\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\", MIN(\"t21\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID0\", \"t15\".\"ID\" AS \"ID1\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID0\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"ID1\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t21\" ON \"t20\".\"PERSON_ID\" = \"t21\".\"ID\"\r\nGROUP BY \"t20\".\"ID1\", \"t20\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID1\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":9.222},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t24\".\"character_name\") AS \"character_name\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t24\".\"playing_actor\") AS \"playing_actor\", MIN(\"t26\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t23\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID5\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t23\" ON \"t22\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t22\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"ID\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":9.0341},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t29\".\"character_name\") AS \"character_name\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t29\".\"playing_actor\") AS \"playing_actor\", MIN(\"t31\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"character_name\") AS \"character_name\", MIN(\"t26\".\"rating\") AS \"rating\", MIN(\"t27\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t23\".\"PERSON_ID\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID5\", \"t18\".\"ID\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t27\"\r\nWHERE \"t27\".\"ID\" = \"t26\".\"PERSON_ID\"\r\nGROUP BY \"t26\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"ID\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":9.8125},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\", MIN(\"t23\".\"playing_actor\") AS \"playing_actor\", MIN(\"t25\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t21\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t22\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t19\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID5\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t22\" ON \"t21\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t21\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t23\".\"ID\" = \"t25\".\"KIND_ID\" AND \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":8.9844},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"character_name\") AS \"character_name\", MIN(\"t31\".\"rating\") AS \"rating\", MIN(\"t31\".\"playing_actor\") AS \"playing_actor\", MIN(\"t33\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t28\".\"ID\", \"t28\".\"MOVIE_ID\", MIN(\"t28\".\"character_name\") AS \"character_name\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t29\".\"playing_actor\") AS \"playing_actor\"\r\nFROM (SELECT \"t25\".\"PERSON_ID\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID4\", \"t18\".\"ID\" AS \"ID5\", \"t20\".\"ID\", \"t18\".\"character_name\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID\" AS \"ID4\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '7.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\") AS \"t25\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\"\r\nWHERE \"t25\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID5\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"playing_actor\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t28\".\"PERSON_ID\"\r\nGROUP BY \"t28\".\"ID\", \"t28\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"ID\" = \"t33\".\"KIND_ID\" AND \"t31\".\"MOVIE_ID\" = \"t33\".\"ID\"","rewrite_time":9.6189}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(n.name) AS playing_actor, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  like '%complete%' AND chn.name  is not NULL and (chn.name like '%man%' or chn.name like '%Man%') AND it2.info  = 'rating' AND k.keyword  in ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind  = 'movie' AND mi_idx.info  > '7.0' AND t.production_year  > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\", MIN(\"t27\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t11\".\"ID\", \"t9\".\"character_name\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t18\".\"ID4\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\" ON \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID5\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t24\" ON \"t23\".\"PERSON_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t23\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"ID\" = \"t27\".\"KIND_ID\" AND \"t25\".\"MOVIE_ID\" = \"t27\".\"ID\"","rewrite_time":9.2071},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character_name\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND (\"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND \"CHAR_NAME\".\"NAME\" IS NOT NULL) AND ((\"CHAR_NAME\".\"NAME\" LIKE '%man%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Man%') AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics' OR \"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'fight'))) AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND (\"MOVIE_INFO_IDX\".\"INFO\" > '8.0' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND (\"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":2.0144},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME\") AS \"character_name\", MIN(\"t11\".\"INFO0\") AS \"rating\", MIN(\"t12\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0') AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t9\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t10\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t10\".\"PERSON_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t12\"\r\nWHERE \"t11\".\"ID6\" = \"t12\".\"KIND_ID\" AND \"t11\".\"MOVIE_ID2\" = \"t12\".\"ID\"","rewrite_time":6.6339},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"character_name\", MIN(\"t5\".\"INFO\") AS \"rating\", MIN(\"t6\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')) AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t4\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0') AS \"t5\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t6\" ON \"t4\".\"ID\" = \"t6\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":5.772},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t28\".\"character_name\") AS \"character_name\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t25\".\"ID1\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"PERSON_ID\", \"t22\".\"ID1\", \"t23\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID0\", \"t18\".\"ID\" AS \"ID1\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID0\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID\", \"t22\".\"ID1\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t26\".\"ID\" = \"t25\".\"PERSON_ID\"\r\nGROUP BY \"t25\".\"ID1\", \"t25\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"ID1\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":9.4473},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t24\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t20\".\"ID1\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID0\", \"t15\".\"ID\" AS \"ID1\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID0\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"ID1\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t21\" ON \"t20\".\"PERSON_ID\" = \"t21\".\"ID\"\r\nGROUP BY \"t20\".\"ID1\", \"t20\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID1\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":10.5798},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t24\".\"character_name\") AS \"character_name\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID5\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t23\" ON \"t22\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t22\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"ID\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":9.1844},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t29\".\"character_name\") AS \"character_name\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"character_name\") AS \"character_name\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"PERSON_ID\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID5\", \"t18\".\"ID\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t20\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t27\"\r\nWHERE \"t27\".\"ID\" = \"t26\".\"PERSON_ID\"\r\nGROUP BY \"t26\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\"\r\nWHERE \"t29\".\"ID\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":17.051},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\", MIN(\"t25\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t21\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t19\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID5\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t22\" ON \"t21\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t21\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t23\".\"ID\" = \"t25\".\"KIND_ID\" AND \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":9.2983},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"character_name\") AS \"character_name\", MIN(\"t31\".\"rating\") AS \"rating\", MIN(\"t33\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t28\".\"ID\", \"t28\".\"MOVIE_ID\", MIN(\"t28\".\"character_name\") AS \"character_name\", MIN(\"t28\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t25\".\"PERSON_ID\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID4\", \"t18\".\"ID\" AS \"ID5\", \"t20\".\"ID\", \"t18\".\"character_name\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID\" AS \"ID4\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'superhero')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '8.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\") AS \"t25\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\"\r\nWHERE \"t25\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID5\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t28\".\"PERSON_ID\"\r\nGROUP BY \"t28\".\"ID\", \"t28\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"ID\" = \"t33\".\"KIND_ID\" AND \"t31\".\"MOVIE_ID\" = \"t33\".\"ID\"","rewrite_time":9.4469}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  like '%complete%' AND chn.name  is not NULL and (chn.name like '%man%' or chn.name like '%Man%') AND it2.info  = 'rating' AND k.keyword  in ('superhero', 'marvel-comics', 'based-on-comic', 'fight') AND kt.kind  = 'movie' AND mi_idx.info  > '8.0' AND t.production_year  > 2005 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"character_name\") AS \"character_name\", MIN(\"t24\".\"rating\") AS \"rating\", MIN(\"t26\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t11\".\"ID\", \"t9\".\"character_name\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID4\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID5\", \"t18\".\"ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID5\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t23\" ON \"t22\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t22\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"ID\" = \"t26\".\"KIND_ID\" AND \"t24\".\"MOVIE_ID\" = \"t26\".\"ID\"","rewrite_time":9.1137},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"character_name\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND (\"COMP_CAST_TYPE0\".\"KIND\" LIKE '%complete%' AND \"CHAR_NAME\".\"NAME\" IS NOT NULL) AND ((\"CHAR_NAME\".\"NAME\" LIKE '%man%' OR \"CHAR_NAME\".\"NAME\" LIKE '%Man%') AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics' OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR (\"KEYWORD\".\"KEYWORD\" = 'tv-special' OR \"KEYWORD\".\"KEYWORD\" = 'fight')) OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'magnet' OR (\"KEYWORD\".\"KEYWORD\" = 'web' OR (\"KEYWORD\".\"KEYWORD\" = 'claw' OR \"KEYWORD\".\"KEYWORD\" = 'laser')))))) AND (\"KIND_TYPE\".\"KIND\" = 'movie' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\")) AND (\"COMPLETE_CAST\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND (\"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"))))","rewrite_time":2.0722},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"NAME\") AS \"character_name\", MIN(\"t10\".\"INFO0\") AS \"rating\", MIN(\"t11\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t3\",\r\n\"CAST_INFO\"\r\nWHERE \"CAST_INFO\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t7\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t8\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t8\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t9\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t9\".\"PERSON_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t11\"\r\nWHERE \"t10\".\"ID6\" = \"t11\".\"KIND_ID\" AND \"t10\".\"MOVIE_ID2\" = \"t11\".\"ID\"","rewrite_time":6.4068},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"character_name\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"t5\".\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%') AS \"t1\"\r\nINNER JOIN \"CAST_INFO\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')) AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie') AS \"t4\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t5\" ON \"t4\".\"ID\" = \"t5\".\"KIND_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t5\".\"ID\"","rewrite_time":5.8163},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t27\".\"character_name\") AS \"character_name\", MIN(\"t27\".\"rating\") AS \"rating\", MIN(\"t29\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t24\".\"ID1\", \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"character_name\") AS \"character_name\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"ID1\", \"t22\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID0\", \"t18\".\"ID\" AS \"ID1\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"KEYWORD_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"ID1\", \"t22\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t25\"\r\nWHERE \"t25\".\"ID\" = \"t24\".\"PERSON_ID\"\r\nGROUP BY \"t24\".\"ID1\", \"t24\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\"\r\nWHERE \"t27\".\"ID1\" = \"t29\".\"KIND_ID\" AND \"t27\".\"MOVIE_ID\" = \"t29\".\"ID\"","rewrite_time":9.4469},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\", MIN(\"t23\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t19\".\"ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t19\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"ID1\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"character_name\") AS \"character_name\", MIN(\"t17\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID0\", \"t15\".\"ID\" AS \"ID1\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t9\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"KEYWORD_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"ID1\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t20\" ON \"t19\".\"PERSON_ID\" = \"t20\".\"ID\"\r\nGROUP BY \"t19\".\"ID1\", \"t19\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t21\".\"ID1\" = \"t23\".\"KIND_ID\" AND \"t21\".\"MOVIE_ID\" = \"t23\".\"ID\"","rewrite_time":8.7862},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t23\".\"character_name\") AS \"character_name\", MIN(\"t23\".\"rating\") AS \"rating\", MIN(\"t25\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t21\".\"ID\", \"t21\".\"MOVIE_ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t21\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t19\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID5\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t22\" ON \"t21\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t21\".\"ID\", \"t21\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t23\".\"ID\" = \"t25\".\"KIND_ID\" AND \"t23\".\"MOVIE_ID\" = \"t25\".\"ID\"","rewrite_time":8.5976},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t28\".\"character_name\") AS \"character_name\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"character_name\") AS \"character_name\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"PERSON_ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\" AS \"ID5\", \"t18\".\"ID\", MIN(\"t12\".\"character_name\") AS \"character_name\", MIN(\"t19\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t12\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t14\".\"ID\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t16\".\"ID\", \"t18\".\"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t23\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID5\" = \"t23\".\"KEYWORD_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t26\".\"ID\" = \"t25\".\"PERSON_ID\"\r\nGROUP BY \"t25\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\"\r\nWHERE \"t28\".\"ID\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":9.5614},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t22\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\", MIN(\"t24\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t20\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t18\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", MIN(\"t9\".\"character_name\") AS \"character_name\", MIN(\"t16\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t8\" ON \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t9\".\"MOVIE_ID0\" = \"t16\".\"MOVIE_ID\" AND \"t11\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID0\", \"t13\".\"ID\", \"t15\".\"ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID5\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t21\" ON \"t20\".\"PERSON_ID\" = \"t21\".\"ID\"\r\nGROUP BY \"t20\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t22\".\"ID\" = \"t24\".\"KIND_ID\" AND \"t22\".\"MOVIE_ID\" = \"t24\".\"ID\"","rewrite_time":8.822},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"character_name\") AS \"character_name\", MIN(\"t30\".\"rating\") AS \"rating\", MIN(\"t32\".\"complete_hero_movie\") AS \"complete_hero_movie\"\r\nFROM (SELECT \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"character_name\") AS \"character_name\", MIN(\"t27\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"ID\", \"t25\".\"MOVIE_ID\", MIN(\"t24\".\"character_name\") AS \"character_name\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\", MIN(\"t21\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", \"t18\".\"ID4\", \"t18\".\"ID\" AS \"ID5\", \"t20\".\"ID\", \"t18\".\"character_name\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", \"t15\".\"ID\" AS \"ID4\", \"t17\".\"ID\", \"t15\".\"character_name\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t12\".\"character_name\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" LIKE '%complete%'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" LIKE '%man%' OR \"NAME\" LIKE '%Man%'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\") AS \"t10\"\r\nWHERE \"t10\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'claw', 'fight', 'laser', 'magnet', 'marvel-comics', 'superhero', 'tv-special', 'violence', 'web')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'movie'\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID0\", \"t21\".\"ID5\", \"t21\".\"ID\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID5\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t28\"\r\nWHERE \"t28\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"ID\" = \"t32\".\"KIND_ID\" AND \"t30\".\"MOVIE_ID\" = \"t32\".\"ID\"","rewrite_time":9.4244}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  like '%complete%' AND chn.name  is not NULL and (chn.name like '%man%' or chn.name like '%Man%') AND it2.info  = 'rating' AND k.keyword  in ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind  = 'movie' AND t.production_year  > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"producing_company\", \"link_type\", \"complete_western_sequel\")","rewrite_time":6.315},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE (\"COMP_CAST_TYPE\".\"KIND\" = 'cast' OR \"COMP_CAST_TYPE\".\"KIND\" = 'crew') AND \"COMP_CAST_TYPE0\".\"KIND\" = 'complete' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%')) AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"KEYWORD\".\"KEYWORD\" = 'sequel' AND (\"LINK_TYPE\".\"LINK\" LIKE '%follow%' AND \"MOVIE_COMPANIES\".\"NOTE\" IS NULL)) AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'German') AND \"TITLE\".\"PRODUCTION_YEAR\" >= 1950 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2000 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))))","rewrite_time":3.64},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"producing_company\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID3\" = \"t2\".\"ID\"","rewrite_time":4.2347},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.4128},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":3.0929},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2000) AS \"t0\" ON \"t\".\"MOVIE_ID3\" = \"t0\".\"ID\"","rewrite_time":2.3771},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID3\" = \"ID\"","rewrite_time":3.8003},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.4418}],"num_rewrites":8,"raw_query":"SELECT     MIN(cn.name) AS producing_company,     MIN(lt.link) AS link_type,     MIN(t.title) AS complete_western_sequel FROM     complete_cast AS cc,     comp_cast_type AS cct1,     comp_cast_type AS cct2,     company_name AS cn,     company_type AS ct,     keyword AS k,     link_type AS lt,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     movie_link AS ml,     title AS t WHERE     cct1.kind in ('cast', 'crew')     AND cct2.kind = 'complete'     AND cn.country_code != '[pl]'     AND (         cn.name LIKE '%Film%'         OR cn.name LIKE '%Warner%'     )     AND ct.kind = 'production companies'     AND k.keyword = 'sequel'     AND lt.link LIKE '%follow%'     AND mc.note IS NULL     AND mi.info IN ('Sweden', 'Germany', 'Swedish', 'German')     AND t.production_year BETWEEN 1950     AND 2000     AND lt.id = ml.link_type_id     AND ml.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND t.id = mc.movie_id     AND mc.company_type_id = ct.id     AND mc.company_id = cn.id     AND mi.movie_id = t.id     AND t.id = cc.movie_id     AND cct1.id = cc.subject_id     AND cct2.id = cc.status_id     AND ml.movie_id = mk.movie_id     AND ml.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id     AND ml.movie_id = mi.movie_id     AND mk.movie_id = mi.movie_id     AND mc.movie_id = mi.movie_id     AND ml.movie_id = cc.movie_id     AND mk.movie_id = cc.movie_id     AND mc.movie_id = cc.movie_id     AND mi.movie_id = cc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"producing_company\", \"link_type\", \"complete_western_sequel\")","rewrite_time":2.992},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE (\"COMP_CAST_TYPE\".\"KIND\" = 'cast' OR \"COMP_CAST_TYPE\".\"KIND\" = 'crew') AND (\"COMP_CAST_TYPE0\".\"KIND\" = 'complete' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]') AND ((\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%') AND \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND (\"KEYWORD\".\"KEYWORD\" = 'sequel' AND \"LINK_TYPE\".\"LINK\" LIKE '%follow%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NULL AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'German') AND (\"TITLE\".\"PRODUCTION_YEAR\" = 1998 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))))","rewrite_time":2.0737},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"producing_company\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 1998\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID3\" = \"t2\".\"ID\"","rewrite_time":2.9284},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.3882},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":4.241},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 1998) AS \"t0\" ON \"t\".\"MOVIE_ID3\" = \"t0\".\"ID\"","rewrite_time":2.5292},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID3\" = \"ID\"","rewrite_time":3.5535},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.4103}],"num_rewrites":8,"raw_query":"SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cct1.kind  in ('cast', 'crew') AND cct2.kind  = 'complete' AND cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Germany','Swedish', 'German') AND t.production_year  = 1998 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND t.id = cc.movie_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id AND ml.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = cc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT *\r\nFROM (VALUES (NULL, NULL, NULL)) AS \"t\" (\"producing_company\", \"link_type\", \"complete_western_sequel\")","rewrite_time":3.1962},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"producing_company\", MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" LIKE 'complete%' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[pl]' AND (\"COMPANY_NAME\".\"NAME\" LIKE '%Film%' OR \"COMPANY_NAME\".\"NAME\" LIKE '%Warner%')) AND (\"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"KEYWORD\".\"KEYWORD\" = 'sequel' AND (\"LINK_TYPE\".\"LINK\" LIKE '%follow%' AND \"MOVIE_COMPANIES\".\"NOTE\" IS NULL)) AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Denmark') OR (\"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'Denish' OR (\"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR \"MOVIE_INFO\".\"INFO\" = 'English')))) AND \"TITLE\".\"PRODUCTION_YEAR\" >= 1950 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" = \"COMPANY_TYPE\".\"ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\" AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))))","rewrite_time":2.1269},{"rule_order":"[rule_filter, rule_agg, rule_cal, rule_project, rule_orderby]","rewrite_query":"SELECT MIN(\"t0\".\"NAME\") AS \"producing_company\", MIN(\"t0\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t0\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"MOVIE_ID3\" = \"t2\".\"ID\"","rewrite_time":2.8346},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"NAME\", \"LINK\", \"TITLE\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.0441},{"rule_order":"[rule_cal, rule_join, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"IMDB_ID0\", \"EPISODE_OF_ID\", \"SERIES_YEARS\", \"MD5SUM0\", \"IMDB_INDEX\", \"PRODUCTION_YEAR\", \"KIND_ID\", \"SEASON_NR\", \"TITLE\", \"PHONETIC_CODE0\", \"ID10\", \"EPISODE_NR\")\r\nWHERE 1 = 0","rewrite_time":2.8837},{"rule_order":"[rule_filter]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"producing_company\", MIN(\"t\".\"LINK\") AS \"link_type\", MIN(\"t0\".\"TITLE\") AS \"complete_western_sequel\"\r\nFROM (SELECT *\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\")\r\nWHERE 1 = 0) AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1950 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t0\" ON \"t\".\"MOVIE_ID3\" = \"t0\".\"ID\"","rewrite_time":2.4147},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"\r\nWHERE \"MOVIE_ID3\" = \"ID\"","rewrite_time":3.6748},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"NAME\") AS \"producing_company\", MIN(\"LINK\") AS \"link_type\", MIN(\"complete_western_sequel\") AS \"complete_western_sequel\"\r\nFROM (SELECT \"MOVIE_ID3\", \"NAME\", \"LINK\", \"ID10\" AS \"ID\", \"complete_western_sequel\"\r\nFROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS \"t\" (\"MOVIE_ID\", \"SUBJECT_ID\", \"ID\", \"STATUS_ID\", \"KIND\", \"ID0\", \"KIND0\", \"ID1\", \"NAME_PCODE_NF\", \"IMDB_ID\", \"MD5SUM\", \"NAME_PCODE_SF\", \"ID2\", \"NAME\", \"COUNTRY_CODE\", \"KIND1\", \"ID3\", \"KEYWORD\", \"PHONETIC_CODE\", \"ID4\", \"LINK\", \"ID5\", \"NOTE\", \"MOVIE_ID0\", \"COMPANY_TYPE_ID\", \"ID6\", \"COMPANY_ID\", \"INFO_TYPE_ID\", \"NOTE0\", \"MOVIE_ID1\", \"ID7\", \"INFO\", \"MOVIE_ID2\", \"ID8\", \"KEYWORD_ID\", \"LINKED_MOVIE_ID\", \"MOVIE_ID3\", \"LINK_TYPE_ID\", \"ID9\", \"ID10\", \"complete_western_sequel\")\r\nWHERE 1 = 0) AS \"t0\"","rewrite_time":3.5623}],"num_rewrites":8,"raw_query":"SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  like 'complete%' AND cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English') AND t.production_year BETWEEN 1950 AND 2010 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND t.id = cc.movie_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id AND ml.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = cc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t32\".\"movie_company\") AS \"movie_company\", MIN(\"t32\".\"rating\") AS \"rating\", MIN(\"t34\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"ID\" AS \"ID6\", \"t20\".\"ID\", \"t18\".\"movie_company\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"movie_company\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"movie_company\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\" AS \"ID3\", \"t11\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t7\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t7\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t23\".\"COMPANY_TYPE_ID\" AND \"t21\".\"ID2\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID4\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\" ON \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID6\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID\", \"t30\".\"MOVIE_ID\") AS \"t32\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\" ON \"t32\".\"ID\" = \"t34\".\"KIND_ID\" AND \"t32\".\"MOVIE_ID\" = \"t34\".\"ID\"","rewrite_time":11.9216},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'crew' AND \"COMP_CAST_TYPE0\".\"KIND\" <> 'complete+verified' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND \"INFO_TYPE\".\"INFO\" = 'countries') AND (\"INFO_TYPE0\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Danish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND (\"MOVIE_INFO_IDX\".\"INFO\" < '8.5' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":2.5222},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"NAME\") AS \"movie_company\", MIN(\"t14\".\"INFO2\") AS \"rating\", MIN(\"t15\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t3\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t8\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\" AND \"t3\".\"ID\" = \"t8\".\"COMPANY_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"t10\".\"INFO_TYPE_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID5\" = \"t12\".\"INFO_TYPE_ID\") AS \"t13\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t13\".\"ID6\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t14\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t15\"\r\nWHERE \"t14\".\"ID7\" = \"t15\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID1\" = \"t15\".\"ID\"","rewrite_time":7.9118},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"movie_company\", MIN(\"t8\".\"INFO\") AS \"rating\", MIN(\"t9\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t1\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t5\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t6\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t7\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t7\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t9\" ON \"t5\".\"ID\" = \"t9\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":7.25},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t33\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\", MIN(\"t35\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID1\", \"t14\".\"ID\" AS \"ID2\", \"t16\".\"ID\" AS \"ID3\", \"t18\".\"ID\" AS \"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID3\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t35\"\r\nWHERE \"t33\".\"ID4\" = \"t35\".\"KIND_ID\" AND \"t33\".\"MOVIE_ID\" = \"t35\".\"ID\"","rewrite_time":12.1146},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\", MIN(\"t29\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID1\", \"t12\".\"ID\" AS \"ID2\", \"t14\".\"ID\" AS \"ID3\", \"t16\".\"ID\" AS \"ID4\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID3\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t27\".\"ID4\" = \"t29\".\"KIND_ID\" AND \"t27\".\"MOVIE_ID\" = \"t29\".\"ID\"","rewrite_time":11.526},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID5\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t28\" ON \"t27\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t27\".\"ID6\" = \"t28\".\"KEYWORD_ID\"\r\nGROUP BY \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\" ON \"t29\".\"ID\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":11.3265},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t34\".\"movie_company\") AS \"movie_company\", MIN(\"t34\".\"rating\") AS \"rating\", MIN(\"t36\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t31\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\" AS \"ID5\", \"t16\".\"ID\" AS \"ID6\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID4\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t32\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t32\".\"MOVIE_ID\" AND \"t31\".\"ID6\" = \"t32\".\"KEYWORD_ID\"\r\nGROUP BY \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t34\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t36\"\r\nWHERE \"t34\".\"ID\" = \"t36\".\"KIND_ID\" AND \"t34\".\"MOVIE_ID\" = \"t36\".\"ID\"","rewrite_time":11.9151},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t28\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID4\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\" ON \"t26\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID6\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\" ON \"t28\".\"ID\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":18.4036},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t38\".\"movie_company\") AS \"movie_company\", MIN(\"t38\".\"rating\") AS \"rating\", MIN(\"t40\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t35\".\"ID\", \"t35\".\"MOVIE_ID\", MIN(\"t35\".\"movie_company\") AS \"movie_company\", MIN(\"t35\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"ID\" AS \"ID6\", \"t22\".\"ID\", \"t20\".\"movie_company\"\r\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID\" AS \"ID5\", \"t19\".\"ID\", \"t17\".\"movie_company\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID\" AS \"ID4\", \"t16\".\"ID\", \"t14\".\"movie_company\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t13\".\"ID\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t9\".\"ID\" AS \"ID2\", \"t10\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t25\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t25\".\"COMPANY_TYPE_ID\" AND \"t23\".\"ID2\" = \"t25\".\"COMPANY_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID4\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\" AND \"t31\".\"ID5\" = \"t33\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t35\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t36\"\r\nWHERE \"t35\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\" AND \"t35\".\"ID6\" = \"t36\".\"KEYWORD_ID\"\r\nGROUP BY \"t35\".\"ID\", \"t35\".\"MOVIE_ID\") AS \"t38\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t40\"\r\nWHERE \"t38\".\"ID\" = \"t40\".\"KIND_ID\" AND \"t38\".\"MOVIE_ID\" = \"t40\".\"ID\"","rewrite_time":11.4911}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind  = 'crew' AND cct2.kind  != 'complete+verified' AND cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info  < '8.5' AND t.production_year  > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t32\".\"movie_company\") AS \"movie_company\", MIN(\"t32\".\"rating\") AS \"rating\", MIN(\"t34\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"ID\" AS \"ID6\", \"t20\".\"ID\", \"t18\".\"movie_company\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"movie_company\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"movie_company\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\" AS \"ID3\", \"t11\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t7\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t7\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t23\".\"COMPANY_TYPE_ID\" AND \"t21\".\"ID2\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID4\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\" ON \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID6\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID\", \"t30\".\"MOVIE_ID\") AS \"t32\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\" ON \"t32\".\"ID\" = \"t34\".\"KIND_ID\" AND \"t32\".\"MOVIE_ID\" = \"t34\".\"ID\"","rewrite_time":11.872},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'crew' AND \"COMP_CAST_TYPE0\".\"KIND\" <> 'complete+verified' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND \"INFO_TYPE\".\"INFO\" = 'countries') AND (\"INFO_TYPE0\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'German') AND (\"MOVIE_INFO_IDX\".\"INFO\" > '6.5' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":2.4942},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"NAME\") AS \"movie_company\", MIN(\"t14\".\"INFO2\") AS \"rating\", MIN(\"t15\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t3\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t8\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\" AND \"t3\".\"ID\" = \"t8\".\"COMPANY_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')) AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"t10\".\"INFO_TYPE_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5') AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID5\" = \"t12\".\"INFO_TYPE_ID\") AS \"t13\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t13\".\"ID6\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t14\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t15\"\r\nWHERE \"t14\".\"ID7\" = \"t15\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID1\" = \"t15\".\"ID\"","rewrite_time":8.4598},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"movie_company\", MIN(\"t8\".\"INFO\") AS \"rating\", MIN(\"t9\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t1\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t5\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t6\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')) AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t7\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5') AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t7\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t9\" ON \"t5\".\"ID\" = \"t9\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":9.061},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t33\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\", MIN(\"t35\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID1\", \"t14\".\"ID\" AS \"ID2\", \"t16\".\"ID\" AS \"ID3\", \"t18\".\"ID\" AS \"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID3\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t35\"\r\nWHERE \"t33\".\"ID4\" = \"t35\".\"KIND_ID\" AND \"t33\".\"MOVIE_ID\" = \"t35\".\"ID\"","rewrite_time":11.9181},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\", MIN(\"t29\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID1\", \"t12\".\"ID\" AS \"ID2\", \"t14\".\"ID\" AS \"ID3\", \"t16\".\"ID\" AS \"ID4\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID3\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t27\".\"ID4\" = \"t29\".\"KIND_ID\" AND \"t27\".\"MOVIE_ID\" = \"t29\".\"ID\"","rewrite_time":11.0984},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID5\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t28\" ON \"t27\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t27\".\"ID6\" = \"t28\".\"KEYWORD_ID\"\r\nGROUP BY \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\" ON \"t29\".\"ID\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":11.7878},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t34\".\"movie_company\") AS \"movie_company\", MIN(\"t34\".\"rating\") AS \"rating\", MIN(\"t36\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t31\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\" AS \"ID5\", \"t16\".\"ID\" AS \"ID6\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID4\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t32\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t32\".\"MOVIE_ID\" AND \"t31\".\"ID6\" = \"t32\".\"KEYWORD_ID\"\r\nGROUP BY \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t34\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t36\"\r\nWHERE \"t34\".\"ID\" = \"t36\".\"KIND_ID\" AND \"t34\".\"MOVIE_ID\" = \"t36\".\"ID\"","rewrite_time":11.7936},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t28\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID4\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\" ON \"t26\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID6\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\" ON \"t28\".\"ID\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":10.9259},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t38\".\"movie_company\") AS \"movie_company\", MIN(\"t38\".\"rating\") AS \"rating\", MIN(\"t40\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t35\".\"ID\", \"t35\".\"MOVIE_ID\", MIN(\"t35\".\"movie_company\") AS \"movie_company\", MIN(\"t35\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"ID\" AS \"ID6\", \"t22\".\"ID\", \"t20\".\"movie_company\"\r\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID\" AS \"ID5\", \"t19\".\"ID\", \"t17\".\"movie_company\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID\" AS \"ID4\", \"t16\".\"ID\", \"t14\".\"movie_company\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t13\".\"ID\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t9\".\"ID\" AS \"ID2\", \"t10\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'crew'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" <> 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t25\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t25\".\"COMPANY_TYPE_ID\" AND \"t23\".\"ID2\" = \"t25\".\"COMPANY_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('German', 'Germany', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID4\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '6.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\" AND \"t31\".\"ID5\" = \"t33\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t35\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t36\"\r\nWHERE \"t35\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\" AND \"t35\".\"ID6\" = \"t36\".\"KEYWORD_ID\"\r\nGROUP BY \"t35\".\"ID\", \"t35\".\"MOVIE_ID\") AS \"t38\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t40\"\r\nWHERE \"t38\".\"ID\" = \"t40\".\"KIND_ID\" AND \"t38\".\"MOVIE_ID\" = \"t40\".\"ID\"","rewrite_time":11.4297}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind  = 'crew' AND cct2.kind  != 'complete+verified' AND cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info  IN ('Sweden', 'Germany', 'Swedish', 'German') AND mi_idx.info  > '6.5' AND t.production_year  > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t32\".\"movie_company\") AS \"movie_company\", MIN(\"t32\".\"rating\") AS \"rating\", MIN(\"t34\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"ID\" AS \"ID6\", \"t20\".\"ID\", \"t18\".\"movie_company\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID\" AS \"ID5\", \"t17\".\"ID\", \"t15\".\"movie_company\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ID2\", \"t12\".\"ID3\", \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\", \"t12\".\"movie_company\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ID2\", \"t9\".\"ID\" AS \"ID3\", \"t11\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t7\".\"ID\" AS \"ID2\", \"t8\".\"ID\", \"t7\".\"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t11\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t17\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t20\") AS \"t21\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID3\" = \"t23\".\"COMPANY_TYPE_ID\" AND \"t21\".\"ID2\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID4\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID5\", \"t24\".\"ID6\", \"t24\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\" ON \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID6\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID\", \"t30\".\"MOVIE_ID\") AS \"t32\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\" ON \"t32\".\"ID\" = \"t34\".\"KIND_ID\" AND \"t32\".\"MOVIE_ID\" = \"t34\".\"ID\"","rewrite_time":11.2853},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"movie_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"COMPANY_NAME\",\r\n\"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"KIND_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" = 'complete' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND \"INFO_TYPE\".\"INFO\" = 'countries') AND (\"INFO_TYPE0\".\"INFO\" = 'rating' AND (\"KEYWORD\".\"KEYWORD\" = 'murder' OR \"KEYWORD\".\"KEYWORD\" = 'murder-in-title' OR \"KEYWORD\".\"KEYWORD\" = 'blood' OR \"KEYWORD\".\"KEYWORD\" = 'violence') AND ((\"KIND_TYPE\".\"KIND\" = 'movie' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%')) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND (\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Danish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND (\"MOVIE_INFO_IDX\".\"INFO\" < '8.5' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))) AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":2.4359},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"NAME\") AS \"movie_company\", MIN(\"t14\".\"INFO2\") AS \"rating\", MIN(\"t15\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t3\",\r\n\"COMPANY_TYPE\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t5\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t6\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t8\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t8\".\"COMPANY_TYPE_ID\" AND \"t3\".\"ID\" = \"t8\".\"COMPANY_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"t10\".\"INFO_TYPE_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"MOVIE_ID\" AND \"t11\".\"ID5\" = \"t12\".\"INFO_TYPE_ID\") AS \"t13\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t13\".\"ID6\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t14\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t15\"\r\nWHERE \"t14\".\"ID7\" = \"t15\".\"KIND_ID\" AND \"t14\".\"MOVIE_ID1\" = \"t15\".\"ID\"","rewrite_time":7.9332},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"movie_company\", MIN(\"t8\".\"INFO\") AS \"rating\", MIN(\"t9\".\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t1\"\r\nCROSS JOIN \"COMPANY_TYPE\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')) AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')) AS \"t5\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t6\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"COMPANY_TYPE\".\"ID\" = \"t6\".\"COMPANY_TYPE_ID\" AND \"t1\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t7\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5') AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"t8\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t7\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t9\" ON \"t5\".\"ID\" = \"t9\".\"KIND_ID\" AND \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":7.1369},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t33\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\", MIN(\"t35\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\", MIN(\"t30\".\"movie_company\") AS \"movie_company\", MIN(\"t30\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID1\", \"t14\".\"ID\" AS \"ID2\", \"t16\".\"ID\" AS \"ID3\", \"t18\".\"ID\" AS \"ID4\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t22\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID2\", \"t22\".\"ID3\", \"t22\".\"ID4\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID3\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"ID4\", \"t30\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t35\"\r\nWHERE \"t33\".\"ID4\" = \"t35\".\"KIND_ID\" AND \"t33\".\"MOVIE_ID\" = \"t35\".\"ID\"","rewrite_time":11.9326},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\", MIN(\"t29\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\", MIN(\"t25\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\", MIN(\"t22\".\"movie_company\") AS \"movie_company\", MIN(\"t24\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID1\", \"t12\".\"ID\" AS \"ID2\", \"t14\".\"ID\" AS \"ID3\", \"t16\".\"ID\" AS \"ID4\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID2\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t22\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID3\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"ID4\", \"t25\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t27\".\"ID4\" = \"t29\".\"KIND_ID\" AND \"t27\".\"MOVIE_ID\" = \"t29\".\"ID\"","rewrite_time":11.0966},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t29\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\", MIN(\"t31\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t27\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t24\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID4\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"ID5\", \"t21\".\"ID6\", \"t21\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID5\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"ID6\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t28\" ON \"t27\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t27\".\"ID6\" = \"t28\".\"KEYWORD_ID\"\r\nGROUP BY \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t31\" ON \"t29\".\"ID\" = \"t31\".\"KIND_ID\" AND \"t29\".\"MOVIE_ID\" = \"t31\".\"ID\"","rewrite_time":11.0333},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t34\".\"movie_company\") AS \"movie_company\", MIN(\"t34\".\"rating\") AS \"rating\", MIN(\"t36\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t31\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\", MIN(\"t29\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t12\".\"ID\" AS \"ID4\", \"t14\".\"ID\" AS \"ID5\", \"t16\".\"ID\" AS \"ID6\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t9\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t20\".\"COMPANY_TYPE_ID\" AND \"t9\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID4\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID5\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID6\", \"t27\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t32\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t32\".\"MOVIE_ID\" AND \"t31\".\"ID6\" = \"t32\".\"KEYWORD_ID\"\r\nGROUP BY \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t34\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t36\"\r\nWHERE \"t34\".\"ID\" = \"t36\".\"KIND_ID\" AND \"t34\".\"MOVIE_ID\" = \"t36\".\"ID\"","rewrite_time":12.1285},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t28\".\"movie_company\") AS \"movie_company\", MIN(\"t28\".\"rating\") AS \"rating\", MIN(\"t30\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t26\".\"movie_company\") AS \"movie_company\", MIN(\"t26\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t23\".\"movie_company\") AS \"movie_company\", MIN(\"t25\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t10\".\"ID\" AS \"ID4\", \"t12\".\"ID\" AS \"ID5\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t7\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t5\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t8\".\"ID\" = \"t18\".\"COMPANY_TYPE_ID\" AND \"t7\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID4\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"ID6\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\" ON \"t26\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID6\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t30\" ON \"t28\".\"ID\" = \"t30\".\"KIND_ID\" AND \"t28\".\"MOVIE_ID\" = \"t30\".\"ID\"","rewrite_time":11.3185},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t38\".\"movie_company\") AS \"movie_company\", MIN(\"t38\".\"rating\") AS \"rating\", MIN(\"t40\".\"complete_euro_dark_movie\") AS \"complete_euro_dark_movie\"\r\nFROM (SELECT \"t35\".\"ID\", \"t35\".\"MOVIE_ID\", MIN(\"t35\".\"movie_company\") AS \"movie_company\", MIN(\"t35\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\", MIN(\"t31\".\"movie_company\") AS \"movie_company\", MIN(\"t33\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\", MIN(\"t27\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t23\".\"movie_company\") AS \"movie_company\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"ID\" AS \"ID6\", \"t22\".\"ID\", \"t20\".\"movie_company\"\r\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID\" AS \"ID5\", \"t19\".\"ID\", \"t17\".\"movie_company\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID\" AS \"ID4\", \"t16\".\"ID\", \"t14\".\"movie_company\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ID2\", \"t11\".\"ID\" AS \"ID3\", \"t13\".\"ID\", \"t11\".\"movie_company\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t9\".\"ID\" AS \"ID2\", \"t10\".\"ID\", \"t9\".\"movie_company\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"movie_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'countries'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'murder', 'murder-in-title', 'violence')\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'movie')\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\", \"COMPANY_ID\") AS \"t25\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t23\".\"ID3\" = \"t25\".\"COMPANY_TYPE_ID\" AND \"t23\".\"ID2\" = \"t25\".\"COMPANY_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Danish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t29\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t29\".\"MOVIE_ID\" AND \"t27\".\"ID4\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t27\".\"ID5\", \"t27\".\"ID6\", \"t27\".\"ID\", \"t29\".\"MOVIE_ID\") AS \"t31\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '8.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\" AND \"t31\".\"ID5\" = \"t33\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t31\".\"ID6\", \"t31\".\"ID\", \"t31\".\"MOVIE_ID\") AS \"t35\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t36\"\r\nWHERE \"t35\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\" AND \"t35\".\"ID6\" = \"t36\".\"KEYWORD_ID\"\r\nGROUP BY \"t35\".\"ID\", \"t35\".\"MOVIE_ID\") AS \"t38\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"complete_euro_dark_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t40\"\r\nWHERE \"t38\".\"ID\" = \"t40\".\"KIND_ID\" AND \"t38\".\"MOVIE_ID\" = \"t40\".\"ID\"","rewrite_time":11.519}],"num_rewrites":10,"raw_query":"SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  = 'complete' AND cn.country_code  != '[us]' AND it1.info  = 'countries' AND it2.info  = 'rating' AND k.keyword  in ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind  in ('movie', 'episode') AND mc.note  not like '%(USA)%' and mc.note like '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info  < '8.5' AND t.production_year  > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t38\".\"voiced_char\") AS \"voiced_char\", MIN(\"t38\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t40\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t35\".\"MOVIE_ID0\", MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"ROLE_ID\", \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", \"t32\".\"ID\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID6\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t23\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\" AS \"ID7\", \"t22\".\"ID\", \"t20\".\"voiced_char\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"MOVIE_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"ID5\", \"t17\".\"ID\" AS \"ID6\", \"t19\".\"ID\", \"t17\".\"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"MOVIE_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\" AS \"ID5\", \"t16\".\"ID\", \"t14\".\"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"MOVIE_ID0\", \"t11\".\"ROLE_ID\", \"t13\".\"ID\", \"t11\".\"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t24\".\"COMPANY_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID6\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t25\".\"ID6\" = \"t27\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t28\".\"ID\" = \"t29\".\"KEYWORD_ID\"\r\nGROUP BY \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\") AS \"t30\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t32\" ON \"t30\".\"PERSON_ID0\" = \"t32\".\"ID\"\r\nGROUP BY \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", \"t32\".\"ID\") AS \"t33\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t34\" ON \"t33\".\"ID\" = \"t34\".\"PERSON_ID\" AND \"t33\".\"ID7\" = \"t34\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t33\".\"ROLE_ID\", \"t33\".\"MOVIE_ID0\") AS \"t35\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t37\" ON \"t35\".\"ROLE_ID\" = \"t37\".\"ID\"\r\nGROUP BY \"t35\".\"MOVIE_ID0\") AS \"t38\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t40\" ON \"t38\".\"MOVIE_ID0\" = \"t40\".\"ID\"","rewrite_time":17.8389},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND (\"CHAR_NAME\".\"NAME\" = 'Queen' AND ((\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]')) AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND (\"INFO_TYPE0\".\"INFO\" = 'trivia' AND \"KEYWORD\".\"KEYWORD\" = 'computer-animation') AND (\"MOVIE_INFO\".\"INFO\" IS NOT NULL AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%200%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%200%') AND \"NAME\".\"GENDER\" = 'f'))) AND (\"NAME\".\"NAME\" LIKE '%An%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"TITLE\" = 'Shrek 2' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2000 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2010)) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\")))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"))) AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\")) AND (\"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"INFO_TYPE0\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":3.2187},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"NAME0\") AS \"voiced_char\", MIN(\"t18\".\"NAME2\") AS \"voicing_actress\", MIN(\"t19\".\"TITLE\") AS \"voiced_animation\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen') AS \"t3\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')) AS \"t4\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t4\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t3\".\"ID\" = \"t4\".\"PERSON_ROLE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t6\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t7\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia') AS \"t8\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t9\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t5\".\"MOVIE_ID0\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID1\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID6\" = \"t11\".\"INFO_TYPE_ID\") AS \"t12\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t12\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t12\".\"ID8\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t13\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID0\" = \"t14\".\"ID\") AS \"t15\",\r\n\"PERSON_INFO\"\r\nWHERE \"t15\".\"ID12\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t15\".\"ID7\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AS \"t16\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t17\"\r\nWHERE \"t17\".\"ID\" = \"t16\".\"ROLE_ID\") AS \"t18\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)) AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID2\" = \"t19\".\"ID\"","rewrite_time":11.8247},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"voiced_char\", MIN(\"t8\".\"NAME\") AS \"voicing_actress\", MIN(\"t10\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen') AS \"t1\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')) AS \"t2\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t1\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia') AS \"t5\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t6\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t2\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t7\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t7\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t8\" ON \"t2\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nINNER JOIN \"PERSON_INFO\" ON \"t8\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t5\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t9\" ON \"t2\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)) AS \"t10\" ON \"t7\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":10.3646},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t43\".\"voiced_char\") AS \"voiced_char\", MIN(\"t43\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t45\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t39\".\"MOVIE_ID0\", MIN(\"t39\".\"voiced_char\") AS \"voiced_char\", MIN(\"t39\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\", MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t36\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t32\".\"ROLE_ID\", \"t32\".\"ID1\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID1\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"ID2\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\" AS \"ID0\", \"t20\".\"ID\" AS \"ID1\", \"t22\".\"ID\" AS \"ID2\", \"t23\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t23\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\", \"t20\".\"ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t27\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t25\".\"ID0\" = \"t27\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"ID2\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t30\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\" AND \"t29\".\"ID2\" = \"t30\".\"KEYWORD_ID\"\r\nGROUP BY \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID1\", \"t29\".\"MOVIE_ID0\") AS \"t32\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t34\"\r\nWHERE \"t32\".\"PERSON_ID0\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"ROLE_ID\", \"t32\".\"ID1\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\") AS \"t36\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t37\"\r\nWHERE \"t36\".\"ID\" = \"t37\".\"PERSON_ID\" AND \"t36\".\"ID1\" = \"t37\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\") AS \"t39\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t41\"\r\nWHERE \"t41\".\"ID\" = \"t39\".\"ROLE_ID\"\r\nGROUP BY \"t39\".\"MOVIE_ID0\") AS \"t43\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t45\"\r\nWHERE \"t43\".\"MOVIE_ID0\" = \"t45\".\"ID\"","rewrite_time":18.1364},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t34\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t36\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t31\".\"MOVIE_ID0\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t26\".\"ROLE_ID\", \"t26\".\"ID1\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\", MIN(\"t28\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID1\", \"t21\".\"ID2\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID0\", \"t17\".\"ID\" AS \"ID1\", \"t19\".\"ID\" AS \"ID2\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t17\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID1\", \"t21\".\"ID2\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID2\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"MOVIE_ID0\") AS \"t26\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t28\" ON \"t26\".\"PERSON_ID0\" = \"t28\".\"ID\"\r\nGROUP BY \"t26\".\"ROLE_ID\", \"t26\".\"ID1\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t30\" ON \"t29\".\"ID\" = \"t30\".\"PERSON_ID\" AND \"t29\".\"ID1\" = \"t30\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\") AS \"t31\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t33\" ON \"t31\".\"ROLE_ID\" = \"t33\".\"ID\"\r\nGROUP BY \"t31\".\"MOVIE_ID0\") AS \"t34\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t36\" ON \"t34\".\"MOVIE_ID0\" = \"t36\".\"ID\"","rewrite_time":16.4052},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t36\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t38\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t31\".\"ROLE_ID\", \"t31\".\"MOVIE_ID0\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", \"t30\".\"ID\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t23\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID6\", \"t17\".\"ID\" AS \"ID7\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID6\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", \"t25\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\" ON \"t26\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\") AS \"t28\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t30\" ON \"t28\".\"PERSON_ID0\" = \"t30\".\"ID\"\r\nGROUP BY \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", \"t30\".\"ID\") AS \"t31\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t32\" ON \"t31\".\"ID\" = \"t32\".\"PERSON_ID\" AND \"t31\".\"ID7\" = \"t32\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t31\".\"ROLE_ID\", \"t31\".\"MOVIE_ID0\") AS \"t33\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t35\" ON \"t33\".\"ROLE_ID\" = \"t35\".\"ID\"\r\nGROUP BY \"t33\".\"MOVIE_ID0\") AS \"t36\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t38\" ON \"t36\".\"MOVIE_ID0\" = \"t38\".\"ID\"","rewrite_time":16.3027},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t44\".\"voiced_char\") AS \"voiced_char\", MIN(\"t44\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t46\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t40\".\"MOVIE_ID0\", MIN(\"t40\".\"voiced_char\") AS \"voiced_char\", MIN(\"t40\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t37\".\"ROLE_ID\", \"t37\".\"MOVIE_ID0\", MIN(\"t37\".\"voiced_char\") AS \"voiced_char\", MIN(\"t37\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", \"t35\".\"ID\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"PERSON_ID0\", \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", \"t28\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\" AS \"ID6\", \"t20\".\"ID\" AS \"ID7\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t23\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\", \"t20\".\"ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t26\".\"ID6\" = \"t28\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", \"t28\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"PERSON_ID0\", \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\") AS \"t33\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t35\"\r\nWHERE \"t33\".\"PERSON_ID0\" = \"t35\".\"ID\"\r\nGROUP BY \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", \"t35\".\"ID\") AS \"t37\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t38\"\r\nWHERE \"t37\".\"ID\" = \"t38\".\"PERSON_ID\" AND \"t37\".\"ID7\" = \"t38\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t37\".\"ROLE_ID\", \"t37\".\"MOVIE_ID0\") AS \"t40\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t42\"\r\nWHERE \"t42\".\"ID\" = \"t40\".\"ROLE_ID\"\r\nGROUP BY \"t40\".\"MOVIE_ID0\") AS \"t44\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t46\"\r\nWHERE \"t44\".\"MOVIE_ID0\" = \"t46\".\"ID\"","rewrite_time":18.1056},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t37\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t32\".\"MOVIE_ID0\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\", MIN(\"t27\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID6\", \"t17\".\"ID\" AS \"ID7\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t17\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID6\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\") AS \"t27\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t29\" ON \"t27\".\"PERSON_ID0\" = \"t29\".\"ID\"\r\nGROUP BY \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t31\" ON \"t30\".\"ID\" = \"t31\".\"PERSON_ID\" AND \"t30\".\"ID7\" = \"t31\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\") AS \"t32\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t34\" ON \"t32\".\"ROLE_ID\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"MOVIE_ID0\") AS \"t35\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t37\" ON \"t35\".\"MOVIE_ID0\" = \"t37\".\"ID\"","rewrite_time":16.5125},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t47\".\"voiced_char\") AS \"voiced_char\", MIN(\"t47\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t49\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t43\".\"MOVIE_ID0\", MIN(\"t43\".\"voiced_char\") AS \"voiced_char\", MIN(\"t43\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t40\".\"ROLE_ID\", \"t40\".\"MOVIE_ID0\", MIN(\"t40\".\"voiced_char\") AS \"voiced_char\", MIN(\"t40\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t36\".\"ROLE_ID\", \"t36\".\"ID7\", \"t36\".\"MOVIE_ID0\", \"t38\".\"ID\", MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t38\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"PERSON_ID0\", \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"ID\", \"t29\".\"MOVIE_ID\", \"t31\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID6\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"MOVIE_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\" AS \"ID7\", \"t25\".\"ID\", \"t23\".\"voiced_char\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID5\", \"t20\".\"ID\" AS \"ID6\", \"t22\".\"ID\", \"t20\".\"voiced_char\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"MOVIE_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"ID\" AS \"ID5\", \"t19\".\"ID\", \"t17\".\"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"MOVIE_ID0\", \"t14\".\"ROLE_ID\", \"t16\".\"ID\", \"t14\".\"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t25\") AS \"t26\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t27\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID5\" = \"t27\".\"COMPANY_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID6\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t31\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t29\".\"ID6\" = \"t31\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"ID\", \"t29\".\"MOVIE_ID\", \"t31\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t34\"\r\nWHERE \"t33\".\"MOVIE_ID\" = \"t34\".\"MOVIE_ID\" AND \"t33\".\"ID\" = \"t34\".\"KEYWORD_ID\"\r\nGROUP BY \"t33\".\"PERSON_ID0\", \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\") AS \"t36\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t38\"\r\nWHERE \"t36\".\"PERSON_ID0\" = \"t38\".\"ID\"\r\nGROUP BY \"t36\".\"ROLE_ID\", \"t36\".\"ID7\", \"t36\".\"MOVIE_ID0\", \"t38\".\"ID\") AS \"t40\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t41\"\r\nWHERE \"t40\".\"ID\" = \"t41\".\"PERSON_ID\" AND \"t40\".\"ID7\" = \"t41\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t40\".\"ROLE_ID\", \"t40\".\"MOVIE_ID0\") AS \"t43\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t45\"\r\nWHERE \"t45\".\"ID\" = \"t43\".\"ROLE_ID\"\r\nGROUP BY \"t43\".\"MOVIE_ID0\") AS \"t47\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010)\r\nGROUP BY \"ID\") AS \"t49\"\r\nWHERE \"t47\".\"MOVIE_ID0\" = \"t49\".\"ID\"","rewrite_time":17.8595}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS voiced_char, MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_animation FROM aka_name AS an, complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, info_type AS it3, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, person_info AS pi, role_type AS rt, title AS t WHERE cct1.kind  ='cast' AND cct2.kind  ='complete+verified' AND chn.name  = 'Queen' AND ci.note  in ('(voice)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info  = 'release dates' AND it3.info  = 'trivia' AND k.keyword  = 'computer-animation' AND mi.info  is not null and (mi.info like 'Japan:%200%' or mi.info like 'USA:%200%') AND n.gender ='f' and n.name like '%An%' AND rt.role ='actress' AND t.title  = 'Shrek 2' AND t.production_year  between 2000 and 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND n.id = pi.person_id AND ci.person_id = pi.person_id AND it3.id = pi.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t38\".\"voiced_char\") AS \"voiced_char\", MIN(\"t38\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t40\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t35\".\"MOVIE_ID0\", MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"ROLE_ID\", \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", \"t32\".\"ID\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID6\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\", MIN(\"t23\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID5\", \"t20\".\"ID6\", \"t20\".\"ID\" AS \"ID7\", \"t22\".\"ID\", \"t20\".\"voiced_char\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"MOVIE_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"ID5\", \"t17\".\"ID\" AS \"ID6\", \"t19\".\"ID\", \"t17\".\"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"MOVIE_ID0\", \"t14\".\"ROLE_ID\", \"t14\".\"ID\" AS \"ID5\", \"t16\".\"ID\", \"t14\".\"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"MOVIE_ID0\", \"t11\".\"ROLE_ID\", \"t13\".\"ID\", \"t11\".\"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID5\" = \"t24\".\"COMPANY_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID6\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t24\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t25\".\"ID6\" = \"t27\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t28\".\"ID\" = \"t29\".\"KEYWORD_ID\"\r\nGROUP BY \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\") AS \"t30\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t32\" ON \"t30\".\"PERSON_ID0\" = \"t32\".\"ID\"\r\nGROUP BY \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", \"t32\".\"ID\") AS \"t33\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t34\" ON \"t33\".\"ID\" = \"t34\".\"PERSON_ID\" AND \"t33\".\"ID7\" = \"t34\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t33\".\"ROLE_ID\", \"t33\".\"MOVIE_ID0\") AS \"t35\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t37\" ON \"t35\".\"ROLE_ID\" = \"t37\".\"ID\"\r\nGROUP BY \"t35\".\"MOVIE_ID0\") AS \"t38\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t40\" ON \"t38\".\"MOVIE_ID0\" = \"t40\".\"ID\"","rewrite_time":17.0826},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND (\"CHAR_NAME\".\"NAME\" = 'Queen' AND ((\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]')) AND (\"INFO_TYPE\".\"INFO\" = 'release dates' AND \"INFO_TYPE0\".\"INFO\" = 'height' AND (\"KEYWORD\".\"KEYWORD\" = 'computer-animation' AND (\"MOVIE_INFO\".\"INFO\" LIKE 'USA:%200%' AND \"NAME\".\"GENDER\" = 'f'))) AND (\"NAME\".\"NAME\" LIKE '%An%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"TITLE\" = 'Shrek 2' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2000 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2005)) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\")))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"))) AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\")) AND (\"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"INFO_TYPE0\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":3.11},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"NAME0\") AS \"voiced_char\", MIN(\"t18\".\"NAME2\") AS \"voicing_actress\", MIN(\"t19\".\"TITLE\") AS \"voiced_animation\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen') AS \"t3\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')) AS \"t4\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t4\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t3\".\"ID\" = \"t4\".\"PERSON_ROLE_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t6\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t7\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height') AS \"t8\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t9\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t5\".\"MOVIE_ID0\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t10\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%') AS \"t11\"\r\nWHERE \"t10\".\"MOVIE_ID1\" = \"t11\".\"MOVIE_ID\" AND \"t10\".\"ID6\" = \"t11\".\"INFO_TYPE_ID\") AS \"t12\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t12\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t12\".\"ID8\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t13\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t14\"\r\nWHERE \"t13\".\"PERSON_ID0\" = \"t14\".\"ID\") AS \"t15\",\r\n\"PERSON_INFO\"\r\nWHERE \"t15\".\"ID12\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t15\".\"ID7\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AS \"t16\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t17\"\r\nWHERE \"t17\".\"ID\" = \"t16\".\"ROLE_ID\") AS \"t18\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)) AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID2\" = \"t19\".\"ID\"","rewrite_time":11.4908},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"NAME\") AS \"voiced_char\", MIN(\"t8\".\"NAME\") AS \"voicing_actress\", MIN(\"t10\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen') AS \"t1\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')) AS \"t2\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"t1\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height') AS \"t5\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t6\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t2\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%') AS \"t7\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"t7\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t8\" ON \"t2\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nINNER JOIN \"PERSON_INFO\" ON \"t8\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t5\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t9\" ON \"t2\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)) AS \"t10\" ON \"t7\".\"MOVIE_ID\" = \"t10\".\"ID\"","rewrite_time":10.118},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t43\".\"voiced_char\") AS \"voiced_char\", MIN(\"t43\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t45\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t39\".\"MOVIE_ID0\", MIN(\"t39\".\"voiced_char\") AS \"voiced_char\", MIN(\"t39\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\", MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t36\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t32\".\"ROLE_ID\", \"t32\".\"ID1\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID1\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"ID2\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\" AS \"ID0\", \"t20\".\"ID\" AS \"ID1\", \"t22\".\"ID\" AS \"ID2\", \"t23\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t23\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\", \"t20\".\"ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t27\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t25\".\"ID0\" = \"t27\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"ID2\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t30\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\" AND \"t29\".\"ID2\" = \"t30\".\"KEYWORD_ID\"\r\nGROUP BY \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID1\", \"t29\".\"MOVIE_ID0\") AS \"t32\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t34\"\r\nWHERE \"t32\".\"PERSON_ID0\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"ROLE_ID\", \"t32\".\"ID1\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\") AS \"t36\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t37\"\r\nWHERE \"t36\".\"ID\" = \"t37\".\"PERSON_ID\" AND \"t36\".\"ID1\" = \"t37\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\") AS \"t39\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t41\"\r\nWHERE \"t41\".\"ID\" = \"t39\".\"ROLE_ID\"\r\nGROUP BY \"t39\".\"MOVIE_ID0\") AS \"t43\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t45\"\r\nWHERE \"t43\".\"MOVIE_ID0\" = \"t45\".\"ID\"","rewrite_time":17.8866},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t34\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t36\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t31\".\"MOVIE_ID0\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t26\".\"ROLE_ID\", \"t26\".\"ID1\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\", MIN(\"t28\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID1\", \"t21\".\"ID2\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID0\", \"t17\".\"ID\" AS \"ID1\", \"t19\".\"ID\" AS \"ID2\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t17\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID1\", \"t21\".\"ID2\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID2\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"MOVIE_ID0\") AS \"t26\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t28\" ON \"t26\".\"PERSON_ID0\" = \"t28\".\"ID\"\r\nGROUP BY \"t26\".\"ROLE_ID\", \"t26\".\"ID1\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t30\" ON \"t29\".\"ID\" = \"t30\".\"PERSON_ID\" AND \"t29\".\"ID1\" = \"t30\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\") AS \"t31\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t33\" ON \"t31\".\"ROLE_ID\" = \"t33\".\"ID\"\r\nGROUP BY \"t31\".\"MOVIE_ID0\") AS \"t34\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t36\" ON \"t34\".\"MOVIE_ID0\" = \"t36\".\"ID\"","rewrite_time":16.0467},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t36\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t38\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t31\".\"ROLE_ID\", \"t31\".\"MOVIE_ID0\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", \"t30\".\"ID\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t23\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID6\", \"t17\".\"ID\" AS \"ID7\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\"\r\nWHERE \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t23\".\"ID6\" = \"t25\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID7\", \"t23\".\"ID\", \"t23\".\"MOVIE_ID\", \"t25\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t27\" ON \"t26\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID\" = \"t27\".\"KEYWORD_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\") AS \"t28\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t30\" ON \"t28\".\"PERSON_ID0\" = \"t30\".\"ID\"\r\nGROUP BY \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"MOVIE_ID0\", \"t30\".\"ID\") AS \"t31\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t32\" ON \"t31\".\"ID\" = \"t32\".\"PERSON_ID\" AND \"t31\".\"ID7\" = \"t32\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t31\".\"ROLE_ID\", \"t31\".\"MOVIE_ID0\") AS \"t33\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t35\" ON \"t33\".\"ROLE_ID\" = \"t35\".\"ID\"\r\nGROUP BY \"t33\".\"MOVIE_ID0\") AS \"t36\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t38\" ON \"t36\".\"MOVIE_ID0\" = \"t38\".\"ID\"","rewrite_time":15.8317},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t44\".\"voiced_char\") AS \"voiced_char\", MIN(\"t44\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t46\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t40\".\"MOVIE_ID0\", MIN(\"t40\".\"voiced_char\") AS \"voiced_char\", MIN(\"t40\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t37\".\"ROLE_ID\", \"t37\".\"MOVIE_ID0\", MIN(\"t37\".\"voiced_char\") AS \"voiced_char\", MIN(\"t37\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", \"t35\".\"ID\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"PERSON_ID0\", \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", \"t28\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\" AS \"ID6\", \"t20\".\"ID\" AS \"ID7\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t14\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t22\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t23\"\r\nWHERE \"t14\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t16\".\"ID\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID0\", \"t14\".\"ROLE_ID\", \"t18\".\"ID\", \"t20\".\"ID\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t26\".\"ID6\" = \"t28\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t26\".\"MOVIE_ID\", \"t28\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"ID\" = \"t31\".\"KEYWORD_ID\"\r\nGROUP BY \"t30\".\"PERSON_ID0\", \"t30\".\"ROLE_ID\", \"t30\".\"ID7\", \"t30\".\"MOVIE_ID0\") AS \"t33\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t35\"\r\nWHERE \"t33\".\"PERSON_ID0\" = \"t35\".\"ID\"\r\nGROUP BY \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", \"t35\".\"ID\") AS \"t37\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t38\"\r\nWHERE \"t37\".\"ID\" = \"t38\".\"PERSON_ID\" AND \"t37\".\"ID7\" = \"t38\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t37\".\"ROLE_ID\", \"t37\".\"MOVIE_ID0\") AS \"t40\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t42\"\r\nWHERE \"t42\".\"ID\" = \"t40\".\"ROLE_ID\"\r\nGROUP BY \"t40\".\"MOVIE_ID0\") AS \"t44\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t46\"\r\nWHERE \"t44\".\"MOVIE_ID0\" = \"t46\".\"ID\"","rewrite_time":17.5158},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t37\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t32\".\"MOVIE_ID0\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\", MIN(\"t27\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\" AS \"ID6\", \"t17\".\"ID\" AS \"ID7\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\", MIN(\"t11\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"ROLE_ID\", MIN(\"t8\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t10\" ON \"t6\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t10\".\"PERSON_ID\" AND \"t8\".\"ID\" = \"t10\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t17\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t11\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID0\", \"t11\".\"ROLE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t20\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID6\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\") AS \"t27\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t29\" ON \"t27\".\"PERSON_ID0\" = \"t29\".\"ID\"\r\nGROUP BY \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t31\" ON \"t30\".\"ID\" = \"t31\".\"PERSON_ID\" AND \"t30\".\"ID7\" = \"t31\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\") AS \"t32\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t34\" ON \"t32\".\"ROLE_ID\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"MOVIE_ID0\") AS \"t35\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t37\" ON \"t35\".\"MOVIE_ID0\" = \"t37\".\"ID\"","rewrite_time":16.4266},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t47\".\"voiced_char\") AS \"voiced_char\", MIN(\"t47\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t49\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t43\".\"MOVIE_ID0\", MIN(\"t43\".\"voiced_char\") AS \"voiced_char\", MIN(\"t43\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t40\".\"ROLE_ID\", \"t40\".\"MOVIE_ID0\", MIN(\"t40\".\"voiced_char\") AS \"voiced_char\", MIN(\"t40\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t36\".\"ROLE_ID\", \"t36\".\"ID7\", \"t36\".\"MOVIE_ID0\", \"t38\".\"ID\", MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t38\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t33\".\"PERSON_ID0\", \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\", MIN(\"t33\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"ID\", \"t29\".\"MOVIE_ID\", \"t31\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID6\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t27\".\"MOVIE_ID\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"MOVIE_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID5\", \"t23\".\"ID6\", \"t23\".\"ID\" AS \"ID7\", \"t25\".\"ID\", \"t23\".\"voiced_char\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID5\", \"t20\".\"ID\" AS \"ID6\", \"t22\".\"ID\", \"t20\".\"voiced_char\"\r\nFROM (SELECT \"t17\".\"PERSON_ID0\", \"t17\".\"MOVIE_ID0\", \"t17\".\"ROLE_ID\", \"t17\".\"ID\" AS \"ID5\", \"t19\".\"ID\", \"t17\".\"voiced_char\"\r\nFROM (SELECT \"t14\".\"PERSON_ID0\", \"t14\".\"MOVIE_ID0\", \"t14\".\"ROLE_ID\", \"t16\".\"ID\", \"t14\".\"voiced_char\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"ROLE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nWHERE \"NAME\" = 'Queen'\r\nGROUP BY \"ID\") AS \"t10\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t12\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t12\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t10\".\"ID\" = \"t12\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t19\") AS \"t20\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'height'\r\nGROUP BY \"ID\") AS \"t22\") AS \"t23\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t25\") AS \"t26\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t27\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"ID5\" = \"t27\".\"COMPANY_ID\"\r\nGROUP BY \"t26\".\"PERSON_ID0\", \"t26\".\"ROLE_ID\", \"t26\".\"ID6\", \"t26\".\"ID7\", \"t26\".\"ID\", \"t27\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t31\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\" AND \"t29\".\"ID6\" = \"t31\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"ID\", \"t29\".\"MOVIE_ID\", \"t31\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t34\"\r\nWHERE \"t33\".\"MOVIE_ID\" = \"t34\".\"MOVIE_ID\" AND \"t33\".\"ID\" = \"t34\".\"KEYWORD_ID\"\r\nGROUP BY \"t33\".\"PERSON_ID0\", \"t33\".\"ROLE_ID\", \"t33\".\"ID7\", \"t33\".\"MOVIE_ID0\") AS \"t36\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t38\"\r\nWHERE \"t36\".\"PERSON_ID0\" = \"t38\".\"ID\"\r\nGROUP BY \"t36\".\"ROLE_ID\", \"t36\".\"ID7\", \"t36\".\"MOVIE_ID0\", \"t38\".\"ID\") AS \"t40\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t41\"\r\nWHERE \"t40\".\"ID\" = \"t41\".\"PERSON_ID\" AND \"t40\".\"ID7\" = \"t41\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t40\".\"ROLE_ID\", \"t40\".\"MOVIE_ID0\") AS \"t43\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t45\"\r\nWHERE \"t45\".\"ID\" = \"t43\".\"ROLE_ID\"\r\nGROUP BY \"t43\".\"MOVIE_ID0\") AS \"t47\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"TITLE\" = 'Shrek 2' AND (\"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2005)\r\nGROUP BY \"ID\") AS \"t49\"\r\nWHERE \"t47\".\"MOVIE_ID0\" = \"t49\".\"ID\"","rewrite_time":17.6891}],"num_rewrites":10,"raw_query":"SELECT MIN(chn.name) AS voiced_char, MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_animation FROM aka_name AS an, complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, info_type AS it3, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, person_info AS pi, role_type AS rt, title AS t WHERE cct1.kind  ='cast' AND cct2.kind  ='complete+verified' AND chn.name  = 'Queen' AND ci.note  in ('(voice)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info  = 'release dates' AND it3.info  = 'height' AND k.keyword  = 'computer-animation' AND mi.info  like 'USA:%200%' AND n.gender ='f' and n.name like '%An%' AND rt.role ='actress' AND t.title  = 'Shrek 2' AND t.production_year  between 2000 and 2005 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND n.id = pi.person_id AND ci.person_id = pi.person_id AND it3.id = pi.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t37\".\"voiced_char\") AS \"voiced_char\", MIN(\"t37\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t39\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t34\".\"MOVIE_ID0\", MIN(\"t34\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t32\".\"ROLE_ID\", \"t32\".\"MOVIE_ID0\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"MOVIE_ID0\", \"t31\".\"ID\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t27\".\"PERSON_ID0\", \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID7\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\", \"t26\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t24\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID6\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\", MIN(\"t22\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t19\".\"PERSON_ID0\", \"t19\".\"MOVIE_ID0\", \"t19\".\"ROLE_ID\", \"t19\".\"ID5\", \"t19\".\"ID6\", \"t19\".\"ID\" AS \"ID7\", \"t21\".\"ID\", \"t19\".\"voiced_char\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID5\", \"t16\".\"ID\" AS \"ID6\", \"t18\".\"ID\", \"t16\".\"voiced_char\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"MOVIE_ID0\", \"t13\".\"ROLE_ID\", \"t13\".\"ID\" AS \"ID5\", \"t15\".\"ID\", \"t13\".\"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"MOVIE_ID0\", \"t10\".\"ROLE_ID\", \"t12\".\"ID\", \"t10\".\"voiced_char\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"ROLE_ID\", MIN(\"t7\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t9\" ON \"t6\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t9\".\"PERSON_ID\" AND \"t7\".\"ID\" = \"t9\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t12\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t15\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t18\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t21\") AS \"t22\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t23\" ON \"t22\".\"MOVIE_ID0\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"ID5\" = \"t23\".\"COMPANY_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID6\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID6\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID7\", \"t24\".\"ID\", \"t24\".\"MOVIE_ID\", \"t26\".\"MOVIE_ID\") AS \"t27\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t28\" ON \"t27\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\" AND \"t27\".\"ID\" = \"t28\".\"KEYWORD_ID\"\r\nGROUP BY \"t27\".\"PERSON_ID0\", \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\") AS \"t29\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t31\" ON \"t29\".\"PERSON_ID0\" = \"t31\".\"ID\"\r\nGROUP BY \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"MOVIE_ID0\", \"t31\".\"ID\") AS \"t32\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t33\" ON \"t32\".\"ID\" = \"t33\".\"PERSON_ID\" AND \"t32\".\"ID7\" = \"t33\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t32\".\"ROLE_ID\", \"t32\".\"MOVIE_ID0\") AS \"t34\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t36\" ON \"t34\".\"ROLE_ID\" = \"t36\".\"ID\"\r\nGROUP BY \"t34\".\"MOVIE_ID0\") AS \"t37\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t39\" ON \"t37\".\"MOVIE_ID0\" = \"t39\".\"ID\"","rewrite_time":16.3109},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND \"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND ((\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"INFO_TYPE\".\"INFO\" = 'release dates')) AND (\"INFO_TYPE0\".\"INFO\" = 'trivia' AND \"KEYWORD\".\"KEYWORD\" = 'computer-animation' AND (\"MOVIE_INFO\".\"INFO\" IS NOT NULL AND ((\"MOVIE_INFO\".\"INFO\" LIKE 'Japan:%200%' OR \"MOVIE_INFO\".\"INFO\" LIKE 'USA:%200%') AND \"NAME\".\"GENDER\" = 'f'))) AND (\"NAME\".\"NAME\" LIKE '%An%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2000 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2010 AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\")))) AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\")) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\"))) AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"ROLE_TYPE\".\"ID\" = \"CAST_INFO\".\"ROLE_ID\" AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\")) AND (\"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"INFO_TYPE0\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\")))))","rewrite_time":3.0117},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t17\".\"NAME0\") AS \"voiced_char\", MIN(\"t17\".\"NAME2\") AS \"voicing_actress\", MIN(\"t18\".\"TITLE\") AS \"voiced_animation\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t3\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t5\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t6\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia') AS \"t7\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t8\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t10\"\r\nWHERE \"t9\".\"MOVIE_ID1\" = \"t10\".\"MOVIE_ID\" AND \"t9\".\"ID6\" = \"t10\".\"INFO_TYPE_ID\") AS \"t11\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t11\".\"ID8\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t12\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t13\"\r\nWHERE \"t12\".\"PERSON_ID0\" = \"t13\".\"ID\") AS \"t14\",\r\n\"PERSON_INFO\"\r\nWHERE \"t14\".\"ID12\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t14\".\"ID7\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AS \"t15\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t16\"\r\nWHERE \"t16\".\"ID\" = \"t15\".\"ROLE_ID\") AS \"t17\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID2\" = \"t18\".\"ID\"","rewrite_time":11.1608},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char\", MIN(\"t7\".\"NAME\") AS \"voicing_actress\", MIN(\"t9\".\"TITLE\") AS \"voiced_animation\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t1\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"t1\".\"PERSON_ROLE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia') AS \"t4\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation') AS \"t5\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%') AS \"t6\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"t6\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t7\" ON \"t1\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nINNER JOIN \"PERSON_INFO\" ON \"t7\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t4\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t8\" ON \"t1\".\"ROLE_ID\" = \"t8\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t9\" ON \"t6\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":9.7336},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t42\".\"voiced_char\") AS \"voiced_char\", MIN(\"t42\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t44\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t38\".\"MOVIE_ID0\", MIN(\"t38\".\"voiced_char\") AS \"voiced_char\", MIN(\"t38\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t35\".\"ROLE_ID\", \"t35\".\"MOVIE_ID0\", MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t31\".\"ROLE_ID\", \"t31\".\"ID1\", \"t31\".\"MOVIE_ID0\", \"t33\".\"ID\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID1\", \"t28\".\"MOVIE_ID0\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"ID2\", \"t24\".\"MOVIE_ID\", \"t26\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t24\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t17\".\"ID\" AS \"ID0\", \"t19\".\"ID\" AS \"ID1\", \"t21\".\"ID\" AS \"ID2\", \"t22\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ROLE_ID\", MIN(\"t9\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t11\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t9\".\"ID\" = \"t11\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t22\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t15\".\"ID\" = \"t22\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t26\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t24\".\"ID0\" = \"t26\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID1\", \"t24\".\"ID2\", \"t24\".\"MOVIE_ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t29\"\r\nWHERE \"t28\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\" AND \"t28\".\"ID2\" = \"t29\".\"KEYWORD_ID\"\r\nGROUP BY \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID1\", \"t28\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"PERSON_ID0\" = \"t33\".\"ID\"\r\nGROUP BY \"t31\".\"ROLE_ID\", \"t31\".\"ID1\", \"t31\".\"MOVIE_ID0\", \"t33\".\"ID\") AS \"t35\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t36\"\r\nWHERE \"t35\".\"ID\" = \"t36\".\"PERSON_ID\" AND \"t35\".\"ID1\" = \"t36\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t35\".\"ROLE_ID\", \"t35\".\"MOVIE_ID0\") AS \"t38\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t40\"\r\nWHERE \"t40\".\"ID\" = \"t38\".\"ROLE_ID\"\r\nGROUP BY \"t38\".\"MOVIE_ID0\") AS \"t42\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t44\"\r\nWHERE \"t42\".\"MOVIE_ID0\" = \"t44\".\"ID\"","rewrite_time":17.2695},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t33\".\"voiced_char\") AS \"voiced_char\", MIN(\"t33\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t35\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t28\".\"ROLE_ID\", \"t28\".\"MOVIE_ID0\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\", MIN(\"t28\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"MOVIE_ID0\", \"t27\".\"ID\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\", MIN(\"t27\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID1\", \"t23\".\"MOVIE_ID0\", MIN(\"t23\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"MOVIE_ID\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"ID\" AS \"ID2\", \"t19\".\"MOVIE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"ROLE_ID\", MIN(\"t7\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t9\" ON \"t6\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t9\".\"PERSON_ID\" AND \"t7\".\"ID\" = \"t9\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t16\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t19\" ON \"t10\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t19\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t20\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID0\", \"t20\".\"ROLE_ID\", \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"MOVIE_ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID2\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID0\", \"t23\".\"ROLE_ID\", \"t23\".\"ID1\", \"t23\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t27\" ON \"t25\".\"PERSON_ID0\" = \"t27\".\"ID\"\r\nGROUP BY \"t25\".\"ROLE_ID\", \"t25\".\"ID1\", \"t25\".\"MOVIE_ID0\", \"t27\".\"ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t29\" ON \"t28\".\"ID\" = \"t29\".\"PERSON_ID\" AND \"t28\".\"ID1\" = \"t29\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t28\".\"ROLE_ID\", \"t28\".\"MOVIE_ID0\") AS \"t30\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t32\" ON \"t30\".\"ROLE_ID\" = \"t32\".\"ID\"\r\nGROUP BY \"t30\".\"MOVIE_ID0\") AS \"t33\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t35\" ON \"t33\".\"MOVIE_ID0\" = \"t35\".\"ID\"","rewrite_time":15.5132},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t35\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t37\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t32\".\"MOVIE_ID0\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t32\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\", MIN(\"t30\".\"voiced_char\") AS \"voiced_char\", MIN(\"t30\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\", MIN(\"t27\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\" AS \"ID7\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"ROLE_ID\", MIN(\"t7\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t9\" ON \"t6\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t9\".\"PERSON_ID\" AND \"t7\".\"ID\" = \"t9\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t19\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t19\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\" ON \"t22\".\"MOVIE_ID\" = \"t24\".\"MOVIE_ID\" AND \"t22\".\"ID6\" = \"t24\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t22\".\"PERSON_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID7\", \"t22\".\"ID\", \"t22\".\"MOVIE_ID\", \"t24\".\"MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID\" = \"t26\".\"KEYWORD_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"MOVIE_ID0\") AS \"t27\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t29\" ON \"t27\".\"PERSON_ID0\" = \"t29\".\"ID\"\r\nGROUP BY \"t27\".\"ROLE_ID\", \"t27\".\"ID7\", \"t27\".\"MOVIE_ID0\", \"t29\".\"ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t31\" ON \"t30\".\"ID\" = \"t31\".\"PERSON_ID\" AND \"t30\".\"ID7\" = \"t31\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t30\".\"ROLE_ID\", \"t30\".\"MOVIE_ID0\") AS \"t32\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t34\" ON \"t32\".\"ROLE_ID\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"MOVIE_ID0\") AS \"t35\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t37\" ON \"t35\".\"MOVIE_ID0\" = \"t37\".\"ID\"","rewrite_time":15.8312},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t43\".\"voiced_char\") AS \"voiced_char\", MIN(\"t43\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t45\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t39\".\"MOVIE_ID0\", MIN(\"t39\".\"voiced_char\") AS \"voiced_char\", MIN(\"t39\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\", MIN(\"t36\".\"voiced_char\") AS \"voiced_char\", MIN(\"t36\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t32\".\"ROLE_ID\", \"t32\".\"ID7\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t17\".\"ID\" AS \"ID6\", \"t19\".\"ID\" AS \"ID7\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\", MIN(\"t13\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ROLE_ID\", MIN(\"t9\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t11\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t9\".\"ID\" = \"t11\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t21\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t22\"\r\nWHERE \"t13\".\"MOVIE_ID0\" = \"t22\".\"MOVIE_ID\" AND \"t15\".\"ID\" = \"t22\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID0\", \"t13\".\"ROLE_ID\", \"t17\".\"ID\", \"t19\".\"ID\", \"t21\".\"ID\", \"t22\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t27\"\r\nWHERE \"t25\".\"MOVIE_ID\" = \"t27\".\"MOVIE_ID\" AND \"t25\".\"ID6\" = \"t27\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t25\".\"MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t29\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t30\"\r\nWHERE \"t29\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\" AND \"t29\".\"ID\" = \"t30\".\"KEYWORD_ID\"\r\nGROUP BY \"t29\".\"PERSON_ID0\", \"t29\".\"ROLE_ID\", \"t29\".\"ID7\", \"t29\".\"MOVIE_ID0\") AS \"t32\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t34\"\r\nWHERE \"t32\".\"PERSON_ID0\" = \"t34\".\"ID\"\r\nGROUP BY \"t32\".\"ROLE_ID\", \"t32\".\"ID7\", \"t32\".\"MOVIE_ID0\", \"t34\".\"ID\") AS \"t36\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t37\"\r\nWHERE \"t36\".\"ID\" = \"t37\".\"PERSON_ID\" AND \"t36\".\"ID7\" = \"t37\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t36\".\"ROLE_ID\", \"t36\".\"MOVIE_ID0\") AS \"t39\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t41\"\r\nWHERE \"t41\".\"ID\" = \"t39\".\"ROLE_ID\"\r\nGROUP BY \"t39\".\"MOVIE_ID0\") AS \"t43\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t45\"\r\nWHERE \"t43\".\"MOVIE_ID0\" = \"t45\".\"ID\"","rewrite_time":16.9716},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t34\".\"voiced_char\") AS \"voiced_char\", MIN(\"t34\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t36\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t31\".\"MOVIE_ID0\", MIN(\"t31\".\"voiced_char\") AS \"voiced_char\", MIN(\"t31\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\", MIN(\"t29\".\"voiced_char\") AS \"voiced_char\", MIN(\"t29\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\", MIN(\"t26\".\"voiced_char\") AS \"voiced_char\", MIN(\"t28\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID7\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID7\", \"t21\".\"ID\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\" AS \"ID6\", \"t16\".\"ID\" AS \"ID7\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\", MIN(\"t10\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"ROLE_ID\", MIN(\"t7\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\" ON \"t0\".\"SUBJECT_ID\" = \"t2\".\"ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"STATUS_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t9\" ON \"t6\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t6\".\"PERSON_ID\" = \"t9\".\"PERSON_ID\" AND \"t7\".\"ID\" = \"t9\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t14\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t16\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t19\" ON \"t10\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t19\".\"COMPANY_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID0\", \"t10\".\"ROLE_ID\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\" AND \"t21\".\"ID6\" = \"t23\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID0\", \"t21\".\"ROLE_ID\", \"t21\".\"ID7\", \"t21\".\"ID\", \"t21\".\"MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID0\", \"t24\".\"ROLE_ID\", \"t24\".\"ID7\", \"t24\".\"MOVIE_ID0\") AS \"t26\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t28\" ON \"t26\".\"PERSON_ID0\" = \"t28\".\"ID\"\r\nGROUP BY \"t26\".\"ROLE_ID\", \"t26\".\"ID7\", \"t26\".\"MOVIE_ID0\", \"t28\".\"ID\") AS \"t29\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t30\" ON \"t29\".\"ID\" = \"t30\".\"PERSON_ID\" AND \"t29\".\"ID7\" = \"t30\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t29\".\"ROLE_ID\", \"t29\".\"MOVIE_ID0\") AS \"t31\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t33\" ON \"t31\".\"ROLE_ID\" = \"t33\".\"ID\"\r\nGROUP BY \"t31\".\"MOVIE_ID0\") AS \"t34\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t36\" ON \"t34\".\"MOVIE_ID0\" = \"t36\".\"ID\"","rewrite_time":15.4829},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t46\".\"voiced_char\") AS \"voiced_char\", MIN(\"t46\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t48\".\"voiced_animation\") AS \"voiced_animation\"\r\nFROM (SELECT \"t42\".\"MOVIE_ID0\", MIN(\"t42\".\"voiced_char\") AS \"voiced_char\", MIN(\"t42\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t39\".\"ROLE_ID\", \"t39\".\"MOVIE_ID0\", MIN(\"t39\".\"voiced_char\") AS \"voiced_char\", MIN(\"t39\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t35\".\"ROLE_ID\", \"t35\".\"ID7\", \"t35\".\"MOVIE_ID0\", \"t37\".\"ID\", MIN(\"t35\".\"voiced_char\") AS \"voiced_char\", MIN(\"t37\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t32\".\"PERSON_ID0\", \"t32\".\"ROLE_ID\", \"t32\".\"ID7\", \"t32\".\"MOVIE_ID0\", MIN(\"t32\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"ID\", \"t28\".\"MOVIE_ID\", \"t30\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t28\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID6\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\", MIN(\"t25\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t22\".\"PERSON_ID0\", \"t22\".\"MOVIE_ID0\", \"t22\".\"ROLE_ID\", \"t22\".\"ID5\", \"t22\".\"ID6\", \"t22\".\"ID\" AS \"ID7\", \"t24\".\"ID\", \"t22\".\"voiced_char\"\r\nFROM (SELECT \"t19\".\"PERSON_ID0\", \"t19\".\"MOVIE_ID0\", \"t19\".\"ROLE_ID\", \"t19\".\"ID5\", \"t19\".\"ID\" AS \"ID6\", \"t21\".\"ID\", \"t19\".\"voiced_char\"\r\nFROM (SELECT \"t16\".\"PERSON_ID0\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ROLE_ID\", \"t16\".\"ID\" AS \"ID5\", \"t18\".\"ID\", \"t16\".\"voiced_char\"\r\nFROM (SELECT \"t13\".\"PERSON_ID0\", \"t13\".\"MOVIE_ID0\", \"t13\".\"ROLE_ID\", \"t15\".\"ID\", \"t13\".\"voiced_char\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ROLE_ID\", MIN(\"t9\".\"voiced_char\") AS \"voiced_char\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t2\"\r\nWHERE \"t2\".\"ID\" = \"t0\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"STATUS_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"STATUS_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t11\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t11\".\"PERSON_ID\" = \"t8\".\"PERSON_ID\" AND \"t9\".\"ID\" = \"t11\".\"PERSON_ROLE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t15\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'release dates'\r\nGROUP BY \"ID\") AS \"t18\") AS \"t19\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'trivia'\r\nGROUP BY \"ID\") AS \"t21\") AS \"t22\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'computer-animation'\r\nGROUP BY \"ID\") AS \"t24\") AS \"t25\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t26\"\r\nWHERE \"t25\".\"MOVIE_ID0\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"ID5\" = \"t26\".\"COMPANY_ID\"\r\nGROUP BY \"t25\".\"PERSON_ID0\", \"t25\".\"ROLE_ID\", \"t25\".\"ID6\", \"t25\".\"ID7\", \"t25\".\"ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" LIKE 'Japan:%200%' OR \"INFO\" LIKE 'USA:%200%'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t30\"\r\nWHERE \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\" AND \"t28\".\"ID6\" = \"t30\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t28\".\"PERSON_ID0\", \"t28\".\"ROLE_ID\", \"t28\".\"ID7\", \"t28\".\"ID\", \"t28\".\"MOVIE_ID\", \"t30\".\"MOVIE_ID\") AS \"t32\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t33\"\r\nWHERE \"t32\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\" AND \"t32\".\"ID\" = \"t33\".\"KEYWORD_ID\"\r\nGROUP BY \"t32\".\"PERSON_ID0\", \"t32\".\"ROLE_ID\", \"t32\".\"ID7\", \"t32\".\"MOVIE_ID0\") AS \"t35\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t37\"\r\nWHERE \"t35\".\"PERSON_ID0\" = \"t37\".\"ID\"\r\nGROUP BY \"t35\".\"ROLE_ID\", \"t35\".\"ID7\", \"t35\".\"MOVIE_ID0\", \"t37\".\"ID\") AS \"t39\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t40\"\r\nWHERE \"t39\".\"ID\" = \"t40\".\"PERSON_ID\" AND \"t39\".\"ID7\" = \"t40\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t39\".\"ROLE_ID\", \"t39\".\"MOVIE_ID0\") AS \"t42\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t44\"\r\nWHERE \"t44\".\"ID\" = \"t42\".\"ROLE_ID\"\r\nGROUP BY \"t42\".\"MOVIE_ID0\") AS \"t46\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"voiced_animation\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t48\"\r\nWHERE \"t46\".\"MOVIE_ID0\" = \"t48\".\"ID\"","rewrite_time":16.7519}],"num_rewrites":10,"raw_query":"SELECT     MIN(chn.name) AS voiced_char,     MIN(n.name) AS voicing_actress,     MIN(t.title) AS voiced_animation FROM     aka_name AS an,     complete_cast AS cc,     comp_cast_type AS cct1,     comp_cast_type AS cct2,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     info_type AS it,     info_type AS it3,     keyword AS k,     movie_companies AS mc,     movie_info AS mi,     movie_keyword AS mk,     name AS n,     person_info AS pi,     role_type AS rt,     title AS t WHERE     cct1.kind = 'cast'     AND cct2.kind = 'complete+verified'     AND ci.note in (         '(voice)',         '(voice: Japanese version)',         '(voice) (uncredited)',         '(voice: English version)'     )     AND cn.country_code = '[us]'     AND it.info = 'release dates'     AND it3.info = 'trivia'     AND k.keyword = 'computer-animation'     AND mi.info is not null     and (         mi.info like 'Japan:%200%'         or mi.info like 'USA:%200%'     )     AND n.gender = 'f'     and n.name like '%An%'     AND rt.role = 'actress'     AND t.production_year between 2000     and 2010     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND t.id = ci.movie_id     AND t.id = mk.movie_id     AND t.id = cc.movie_id     AND mc.movie_id = ci.movie_id     AND mc.movie_id = mi.movie_id     AND mc.movie_id = mk.movie_id     AND mc.movie_id = cc.movie_id     AND mi.movie_id = ci.movie_id     AND mi.movie_id = mk.movie_id     AND mi.movie_id = cc.movie_id     AND ci.movie_id = mk.movie_id     AND ci.movie_id = cc.movie_id     AND mk.movie_id = cc.movie_id     AND cn.id = mc.company_id     AND it.id = mi.info_type_id     AND n.id = ci.person_id     AND rt.id = ci.role_id     AND n.id = an.person_id     AND ci.person_id = an.person_id     AND chn.id = ci.person_role_id     AND n.id = pi.person_id     AND ci.person_id = pi.person_id     AND it3.id = pi.info_type_id     AND k.id = mk.keyword_id     AND cct1.id = cc.subject_id     AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.9725},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[de]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))","rewrite_time":0.8663},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t1\".\"ID0\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n\"TITLE\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.1382},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.0423},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[de]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t6\".\"KEYWORD_ID\" = \"t5\".\"ID0\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":4.9209}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[de]'     AND k.keyword = 'character-name-in-title'     AND cn.id = mc.company_id     AND mc.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.4915},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[nl]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))","rewrite_time":0.6924},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t1\".\"ID0\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n\"TITLE\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":2.0118},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":1.8023},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t6\".\"KEYWORD_ID\" = \"t5\".\"ID0\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.524}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[nl]'     AND k.keyword = 'character-name-in-title'     AND cn.id = mc.company_id     AND mc.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[sm]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.5399},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[sm]' AND (\"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))","rewrite_time":0.7961},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[sm]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t1\".\"ID0\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n\"TITLE\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":1.9226},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[sm]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":1.8597},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[sm]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t6\".\"KEYWORD_ID\" = \"t5\".\"ID0\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.5493}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[sm]'     AND k.keyword = 'character-name-in-title'     AND cn.id = mc.company_id     AND mc.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE 'char%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t5\" ON \"t4\".\"ID0\" = \"t5\".\"KEYWORD_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.644},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"COMPANY_NAME\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"KEYWORD\".\"KEYWORD\" LIKE 'char%' AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"))","rewrite_time":0.7801},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE 'char%') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t1\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t1\".\"ID0\" AND \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t2\",\r\n\"TITLE\"\r\nWHERE \"t2\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":1.9024},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE 'char%') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":1.7381},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE 'char%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\"\r\nWHERE \"t6\".\"KEYWORD_ID\" = \"t5\".\"ID0\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.4888}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     company_name AS cn,     keyword AS k,     movie_companies AS mc,     movie_keyword AS mk,     title AS t WHERE     cn.country_code = '[us]'     AND k.keyword like 'char%'     AND cn.id = mc.company_id     AND mc.movie_id = t.id     AND t.id = mk.movie_id     AND mk.keyword_id = k.id     AND mc.movie_id = mk.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t26\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\" AS \"ID0\", \"t14\".\"ID\" AS \"ID1\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t8\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":9.9484},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"COMP_CAST_TYPE\".\"KIND\" = 'cast' OR \"COMP_CAST_TYPE\".\"KIND\" = 'crew') AND (\"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)')) AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Thriller'))) AND (\"NAME\".\"GENDER\" = 'm' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":2.174},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"INFO1\") AS \"movie_budget\", MIN(\"t13\".\"INFO2\") AS \"movie_votes\", MIN(\"t13\".\"NAME\") AS \"writer\", MIN(\"t14\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')) AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t5\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t6\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t10\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t10\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t11\".\"PERSON_ID\") AS \"t13\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"t14\".\"ID\"","rewrite_time":6.932},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t5\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t6\".\"NAME\") AS \"writer\", MIN(\"t7\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')) AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t1\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t4\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t5\" ON \"t1\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t6\" ON \"t1\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":6.5015},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"movie_budget\") AS \"movie_budget\", MIN(\"t30\".\"movie_votes\") AS \"movie_votes\", MIN(\"t30\".\"writer\") AS \"writer\", MIN(\"t32\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t26\".\"MOVIE_ID1\", MIN(\"t26\".\"movie_budget\") AS \"movie_budget\", MIN(\"t26\".\"movie_votes\") AS \"movie_votes\", MIN(\"t28\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\", MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID0\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID1\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\") AS \"t26\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t28\"\r\nWHERE \"t28\".\"ID\" = \"t26\".\"PERSON_ID\"\r\nGROUP BY \"t26\".\"MOVIE_ID1\") AS \"t30\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"MOVIE_ID1\" = \"t32\".\"ID\"","rewrite_time":9.9748},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\", MIN(\"t25\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t22\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID0\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t22\" ON \"t20\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID1\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID1\" = \"t25\".\"ID\"","rewrite_time":9.3363},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t25\".\"movie_budget\") AS \"movie_budget\", MIN(\"t25\".\"movie_votes\") AS \"movie_votes\", MIN(\"t25\".\"writer\") AS \"writer\", MIN(\"t27\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID0\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID1\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"PERSON_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":9.1305},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t33\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\" AS \"MOVIE_ID\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t33\".\"ID\"","rewrite_time":10.3177},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t26\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":9.1585},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t33\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\" AS \"ID0\", \"t17\".\"ID\" AS \"ID1\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t33\".\"ID\"","rewrite_time":10.2391}],"num_rewrites":10,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_violent_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  in ('cast', 'crew') AND cct2.kind  ='complete+verified' AND ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info  in ('Horror', 'Thriller') AND n.gender  = 'm' AND t.production_year  > 2000 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t26\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\" AS \"ID0\", \"t14\".\"ID\" AS \"ID1\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t8\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":10.1466},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"COMP_CAST_TYPE\".\"KIND\" = 'cast' OR \"COMP_CAST_TYPE\".\"KIND\" = 'crew') AND (\"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)')) AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Thriller'))) AND (\"NAME\".\"GENDER\" = 'm' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND ((\"TITLE\".\"TITLE\" LIKE '%Freddy%' OR \"TITLE\".\"TITLE\" LIKE '%Jason%' OR \"TITLE\".\"TITLE\" LIKE 'Saw%') AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":2.2922},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"INFO1\") AS \"movie_budget\", MIN(\"t13\".\"INFO2\") AS \"movie_votes\", MIN(\"t13\".\"NAME\") AS \"writer\", MIN(\"t14\".\"TITLE\") AS \"complete_gore_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')) AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t5\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t6\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t10\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t10\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t11\".\"PERSON_ID\") AS \"t13\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')) AS \"t14\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"t14\".\"ID\"","rewrite_time":7.179},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t5\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t6\".\"NAME\") AS \"writer\", MIN(\"t7\".\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')) AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t1\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t4\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t5\" ON \"t1\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t6\" ON \"t1\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')) AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":6.4165},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"movie_budget\") AS \"movie_budget\", MIN(\"t30\".\"movie_votes\") AS \"movie_votes\", MIN(\"t30\".\"writer\") AS \"writer\", MIN(\"t32\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t26\".\"MOVIE_ID1\", MIN(\"t26\".\"movie_budget\") AS \"movie_budget\", MIN(\"t26\".\"movie_votes\") AS \"movie_votes\", MIN(\"t28\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\", MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID0\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID1\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\") AS \"t26\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t28\"\r\nWHERE \"t28\".\"ID\" = \"t26\".\"PERSON_ID\"\r\nGROUP BY \"t26\".\"MOVIE_ID1\") AS \"t30\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"MOVIE_ID1\" = \"t32\".\"ID\"","rewrite_time":10.0574},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\", MIN(\"t25\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t22\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID0\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t22\" ON \"t20\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID1\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t25\" ON \"t23\".\"MOVIE_ID1\" = \"t25\".\"ID\"","rewrite_time":9.542},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t25\".\"movie_budget\") AS \"movie_budget\", MIN(\"t25\".\"movie_votes\") AS \"movie_votes\", MIN(\"t25\".\"writer\") AS \"writer\", MIN(\"t27\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID0\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID1\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"PERSON_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t27\" ON \"t25\".\"MOVIE_ID0\" = \"t27\".\"ID\"","rewrite_time":9.3446},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t33\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\" AS \"MOVIE_ID\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t33\".\"ID\"","rewrite_time":10.2951},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t26\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t26\" ON \"t24\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":10.6376},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t33\".\"complete_gore_movie\") AS \"complete_gore_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\" AS \"ID0\", \"t17\".\"ID\" AS \"ID1\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" IN ('cast', 'crew')\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_gore_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t33\".\"ID\"","rewrite_time":10.3893}],"num_rewrites":10,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_gore_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  in ('cast', 'crew') AND cct2.kind  ='complete+verified' AND ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info  in ('Horror', 'Thriller') AND n.gender  = 'm' AND t.production_year  > 2000 and (t.title like '%Freddy%' or t.title like '%Jason%' or t.title like 'Saw%') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t25\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\" AS \"ID0\", \"t14\".\"ID\" AS \"ID1\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t8\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t10\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t12\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t8\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t10\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t8\".\"PERSON_ID\", \"t8\".\"MOVIE_ID\", \"t12\".\"ID\", \"t14\".\"ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\"","rewrite_time":9.4409},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"COMPLETE_CAST\",\r\n\"COMP_CAST_TYPE\",\r\n\"COMP_CAST_TYPE\" AS \"COMP_CAST_TYPE0\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"COMP_CAST_TYPE\".\"KIND\" = 'cast' AND (\"COMP_CAST_TYPE0\".\"KIND\" = 'complete+verified' AND (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)')) AND (\"INFO_TYPE\".\"INFO\" = 'genres' AND \"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR (\"MOVIE_INFO\".\"INFO\" = 'Action' OR \"MOVIE_INFO\".\"INFO\" = 'Sci-Fi') OR (\"MOVIE_INFO\".\"INFO\" = 'Thriller' OR (\"MOVIE_INFO\".\"INFO\" = 'Crime' OR \"MOVIE_INFO\".\"INFO\" = 'War'))))) AND (\"NAME\".\"GENDER\" = 'm' AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"COMPLETE_CAST\".\"MOVIE_ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\") AND (\"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND (\"COMP_CAST_TYPE\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\" AND \"COMP_CAST_TYPE0\".\"ID\" = \"COMPLETE_CAST\".\"STATUS_ID\"))))","rewrite_time":2.0989},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"INFO1\") AS \"movie_budget\", MIN(\"t13\".\"INFO2\") AS \"movie_votes\", MIN(\"t13\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPLETE_CAST\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\"\r\nWHERE \"t\".\"ID\" = \"COMPLETE_CAST\".\"SUBJECT_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"STATUS_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t5\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t6\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID0\" = \"t8\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t8\".\"INFO_TYPE_ID\") AS \"t9\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t9\".\"ID4\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t10\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t10\".\"ID5\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t12\"\r\nWHERE \"t12\".\"ID\" = \"t11\".\"PERSON_ID\") AS \"t13\",\r\n\"TITLE\"\r\nWHERE \"t13\".\"MOVIE_ID1\" = \"TITLE\".\"ID\"","rewrite_time":6.8011},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t5\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t6\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"COMPLETE_CAST\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast') AS \"t\" ON \"COMPLETE_CAST\".\"SUBJECT_ID\" = \"t\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified') AS \"t0\" ON \"COMPLETE_CAST\".\"STATUS_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t1\" ON \"COMPLETE_CAST\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t4\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t5\" ON \"t1\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t4\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t6\" ON \"t1\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t5\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":6.1789},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"movie_budget\") AS \"movie_budget\", MIN(\"t30\".\"movie_votes\") AS \"movie_votes\", MIN(\"t30\".\"writer\") AS \"writer\", MIN(\"t31\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t26\".\"MOVIE_ID1\", MIN(\"t26\".\"movie_budget\") AS \"movie_budget\", MIN(\"t26\".\"movie_votes\") AS \"movie_votes\", MIN(\"t28\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\", MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\"\r\nWHERE \"t20\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID0\" = \"t21\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", \"t20\".\"ID1\", \"t20\".\"MOVIE_ID1\") AS \"t23\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t24\"\r\nWHERE \"t23\".\"MOVIE_ID0\" = \"t24\".\"MOVIE_ID\" AND \"t23\".\"ID1\" = \"t24\".\"KEYWORD_ID\"\r\nGROUP BY \"t23\".\"PERSON_ID\", \"t23\".\"MOVIE_ID1\") AS \"t26\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t28\"\r\nWHERE \"t28\".\"ID\" = \"t26\".\"PERSON_ID\"\r\nGROUP BY \"t26\".\"MOVIE_ID1\") AS \"t30\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t31\"\r\nWHERE \"t30\".\"MOVIE_ID1\" = \"t31\".\"ID\"","rewrite_time":9.9471},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t23\".\"movie_budget\") AS \"movie_budget\", MIN(\"t23\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\", MIN(\"t24\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t20\".\"MOVIE_ID1\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t22\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID0\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID0\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", \"t16\".\"ID1\", \"t16\".\"MOVIE_ID1\") AS \"t18\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID1\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID1\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t22\" ON \"t20\".\"PERSON_ID\" = \"t22\".\"ID\"\r\nGROUP BY \"t20\".\"MOVIE_ID1\") AS \"t23\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID1\" = \"t24\".\"ID\"","rewrite_time":9.1672},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t25\".\"movie_budget\") AS \"movie_budget\", MIN(\"t25\".\"movie_votes\") AS \"movie_votes\", MIN(\"t25\".\"writer\") AS \"writer\", MIN(\"t26\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\", MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nCROSS JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID0\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID\", \"t18\".\"ID1\", \"t18\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"ID1\" = \"t21\".\"KEYWORD_ID\"\r\nGROUP BY \"t20\".\"PERSON_ID\", \"t20\".\"MOVIE_ID0\") AS \"t22\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t24\" ON \"t22\".\"PERSON_ID\" = \"t24\".\"ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID0\") AS \"t25\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t26\" ON \"t25\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":9.1597},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t32\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\" AS \"MOVIE_ID\", \"t14\".\"ID\" AS \"ID0\", \"t16\".\"ID\" AS \"ID1\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT *\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t10\".\"MOVIE_ID0\" = \"t18\".\"MOVIE_ID\" AND \"t12\".\"ID\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID0\", \"t14\".\"ID\", \"t16\".\"ID\", \"t18\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t32\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t32\".\"ID\"","rewrite_time":9.7981},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t25\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\" AS \"ID0\", \"t13\".\"ID\" AS \"ID1\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\" ON \"t\".\"SUBJECT_ID\" = \"t1\".\"ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t4\" ON \"t2\".\"STATUS_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t11\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t9\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t11\".\"ID\", \"t13\".\"ID\", \"t15\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\" AND \"t17\".\"ID0\" = \"t18\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t17\".\"PERSON_ID\", \"t17\".\"MOVIE_ID\", \"t17\".\"ID1\", \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID1\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"PERSON_ID\" = \"t23\".\"ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\"","rewrite_time":10.7445},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t31\".\"movie_budget\") AS \"movie_budget\", MIN(\"t31\".\"movie_votes\") AS \"movie_votes\", MIN(\"t31\".\"writer\") AS \"writer\", MIN(\"t32\".\"complete_violent_movie\") AS \"complete_violent_movie\"\r\nFROM (SELECT \"t27\".\"MOVIE_ID0\", MIN(\"t27\".\"movie_budget\") AS \"movie_budget\", MIN(\"t27\".\"movie_votes\") AS \"movie_votes\", MIN(\"t29\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\", MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\" AS \"ID0\", \"t17\".\"ID\" AS \"ID1\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t9\".\"PERSON_ID\", \"t9\".\"MOVIE_ID\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\"\r\nFROM (SELECT \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\"\r\nFROM \"COMPLETE_CAST\"\r\nGROUP BY \"MOVIE_ID\", \"SUBJECT_ID\", \"STATUS_ID\") AS \"t\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'cast'\r\nGROUP BY \"ID\") AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t\".\"SUBJECT_ID\"\r\nGROUP BY \"t\".\"MOVIE_ID\", \"t\".\"STATUS_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMP_CAST_TYPE\"\r\nWHERE \"KIND\" = 'complete+verified'\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t3\".\"STATUS_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t9\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t13\".\"ID\" = \"t19\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t15\".\"ID\", \"t17\".\"ID\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"ID0\" = \"t22\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t21\".\"PERSON_ID\", \"t21\".\"MOVIE_ID\", \"t21\".\"ID1\", \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"ID1\" = \"t25\".\"KEYWORD_ID\"\r\nGROUP BY \"t24\".\"PERSON_ID\", \"t24\".\"MOVIE_ID0\") AS \"t27\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t29\"\r\nWHERE \"t29\".\"ID\" = \"t27\".\"PERSON_ID\"\r\nGROUP BY \"t27\".\"MOVIE_ID0\") AS \"t31\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"complete_violent_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t32\"\r\nWHERE \"t31\".\"MOVIE_ID0\" = \"t32\".\"ID\"","rewrite_time":9.7196}],"num_rewrites":10,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_violent_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind  = 'cast' AND cct2.kind  ='complete+verified' AND ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info  in ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND n.gender  = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t20\".\"movie_budget\") AS \"movie_budget\", MIN(\"t20\".\"movie_votes\") AS \"movie_votes\", MIN(\"t20\".\"writer\") AS \"writer\", MIN(\"t21\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\", MIN(\"t19\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\", MIN(\"t15\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID\", \"t13\".\"ID2\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t14\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"ID2\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID\", \"t13\".\"ID2\", \"t13\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t19\" ON \"t17\".\"PERSON_ID\" = \"t19\".\"ID\"\r\nGROUP BY \"t17\".\"MOVIE_ID0\") AS \"t20\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID0\" = \"t21\".\"ID\"","rewrite_time":8.7186},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND (\"COMPANY_NAME\".\"NAME\" LIKE 'Lionsgate%' AND \"INFO_TYPE\".\"INFO\" = 'genres') AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Thriller'))) AND (\"NAME\".\"GENDER\" = 'm' AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":2.0563},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t10\".\"INFO1\") AS \"movie_budget\", MIN(\"t10\".\"INFO2\") AS \"movie_votes\", MIN(\"t10\".\"NAME0\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t6\".\"ID2\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t7\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t7\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t8\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t9\"\r\nWHERE \"t9\".\"ID\" = \"t8\".\"PERSON_ID\") AS \"t10\",\r\n\"TITLE\"\r\nWHERE \"t10\".\"MOVIE_ID1\" = \"TITLE\".\"ID\"","rewrite_time":6.1733},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t5\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t5\" ON \"t\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":5.735},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t25\".\"movie_budget\") AS \"movie_budget\", MIN(\"t25\".\"movie_votes\") AS \"movie_votes\", MIN(\"t25\".\"writer\") AS \"writer\", MIN(\"t26\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t23\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t23\"\r\nWHERE \"t23\".\"ID\" = \"t21\".\"PERSON_ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t25\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t26\"\r\nWHERE \"t25\".\"MOVIE_ID0\" = \"t26\".\"ID\"","rewrite_time":8.3763}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS violent_liongate_movie FROM cast_info AS ci, company_name AS cn, info_type AS it1, info_type AS it2, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND cn.name  like 'Lionsgate%' AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info  in ('Horror', 'Thriller') AND n.gender   = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = mc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t21\".\"writer\") AS \"writer\", MIN(\"t23\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\", MIN(\"t20\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t14\".\"PERSON_ID\", \"t14\".\"MOVIE_ID\", \"t14\".\"ID2\", \"t14\".\"MOVIE_ID0\", MIN(\"t14\".\"movie_budget\") AS \"movie_budget\", MIN(\"t15\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Blu-ray)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\" ON \"t0\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\" AND \"t14\".\"ID1\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"PERSON_ID\", \"t14\".\"MOVIE_ID\", \"t14\".\"ID2\", \"t14\".\"MOVIE_ID0\") AS \"t16\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t17\" ON \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID2\" = \"t17\".\"KEYWORD_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID0\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"PERSON_ID\" = \"t20\".\"ID\"\r\nGROUP BY \"t18\".\"MOVIE_ID0\") AS \"t21\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t23\" ON \"t21\".\"MOVIE_ID0\" = \"t23\".\"ID\"","rewrite_time":9.0389},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND (\"COMPANY_NAME\".\"NAME\" LIKE 'Lionsgate%' AND \"INFO_TYPE\".\"INFO\" = 'genres') AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND (\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(Blu-ray)%' AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR \"MOVIE_INFO\".\"INFO\" = 'Thriller'))) AND (\"NAME\".\"GENDER\" = 'm' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND ((\"TITLE\".\"TITLE\" LIKE '%Freddy%' OR \"TITLE\".\"TITLE\" LIKE '%Jason%' OR \"TITLE\".\"TITLE\" LIKE 'Saw%') AND \"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":2.2179},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"INFO1\") AS \"movie_budget\", MIN(\"t11\".\"INFO2\") AS \"movie_votes\", MIN(\"t11\".\"NAME0\") AS \"writer\", MIN(\"t12\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Blu-ray)%') AS \"t4\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"COMPANY_ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t6\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t7\".\"ID2\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t8\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t8\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t9\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t10\"\r\nWHERE \"t10\".\"ID\" = \"t9\".\"PERSON_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')) AS \"t12\"\r\nWHERE \"t11\".\"MOVIE_ID1\" = \"t12\".\"ID\"","rewrite_time":6.6139},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t5\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"t6\".\"NAME\") AS \"writer\", MIN(\"t7\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Blu-ray)%') AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t4\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')) AS \"t5\" ON \"t\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t5\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm') AS \"t6\" ON \"t\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')) AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":5.9334},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t26\".\"movie_budget\") AS \"movie_budget\", MIN(\"t26\".\"movie_votes\") AS \"movie_votes\", MIN(\"t26\".\"writer\") AS \"writer\", MIN(\"t28\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t22\".\"MOVIE_ID0\", MIN(\"t22\".\"movie_budget\") AS \"movie_budget\", MIN(\"t22\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\", MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID\", \"t16\".\"ID2\", \"t16\".\"MOVIE_ID0\", MIN(\"t16\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ID1\", \"t12\".\"ID2\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Blu-ray)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t10\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t12\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Horror', 'Thriller')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\"\r\nWHERE \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t12\".\"ID0\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t12\".\"PERSON_ID\", \"t12\".\"MOVIE_ID\", \"t12\".\"ID1\", \"t12\".\"ID2\", \"t14\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\" AND \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t16\".\"PERSON_ID\", \"t16\".\"MOVIE_ID\", \"t16\".\"ID2\", \"t16\".\"MOVIE_ID0\") AS \"t19\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\" AND \"t19\".\"ID2\" = \"t20\".\"KEYWORD_ID\"\r\nGROUP BY \"t19\".\"PERSON_ID\", \"t19\".\"MOVIE_ID0\") AS \"t22\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t24\"\r\nWHERE \"t24\".\"ID\" = \"t22\".\"PERSON_ID\"\r\nGROUP BY \"t22\".\"MOVIE_ID0\") AS \"t26\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000 AND (\"TITLE\" LIKE '%Freddy%' OR \"TITLE\" LIKE '%Jason%' OR \"TITLE\" LIKE 'Saw%')\r\nGROUP BY \"ID\") AS \"t28\"\r\nWHERE \"t26\".\"MOVIE_ID0\" = \"t28\".\"ID\"","rewrite_time":8.829}],"num_rewrites":5,"raw_query":"SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS violent_liongate_movie FROM cast_info AS ci, company_name AS cn, info_type AS it1, info_type AS it2, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note  in ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND cn.name  like 'Lionsgate%' AND it1.info  = 'genres' AND it2.info  = 'votes' AND k.keyword  in ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mc.note  like '%(Blu-ray)%' AND mi.info  in ('Horror', 'Thriller') AND n.gender  = 'm' AND t.production_year  > 2000 and (t.title like '%Freddy%' or t.title like '%Jason%' or t.title like 'Saw%') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = mc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"movie_budget\") AS \"movie_budget\", MIN(\"t19\".\"movie_votes\") AS \"movie_votes\", MIN(\"t19\".\"writer\") AS \"writer\", MIN(\"t20\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t17\".\"MOVIE_ID0\", MIN(\"t17\".\"movie_budget\") AS \"movie_budget\", MIN(\"t17\".\"movie_votes\") AS \"movie_votes\", MIN(\"t18\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\", MIN(\"t15\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID\", \"t13\".\"ID2\", \"t13\".\"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\", MIN(\"t14\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"ID2\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t12\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t0\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\" AND \"t10\".\"ID0\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t10\".\"PERSON_ID\", \"t10\".\"MOVIE_ID\", \"t10\".\"ID1\", \"t10\".\"ID2\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\" AND \"t13\".\"ID1\" = \"t14\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t13\".\"PERSON_ID\", \"t13\".\"MOVIE_ID\", \"t13\".\"ID2\", \"t13\".\"MOVIE_ID0\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID2\" = \"t16\".\"KEYWORD_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID0\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t18\" ON \"t17\".\"PERSON_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t17\".\"MOVIE_ID0\") AS \"t19\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\" ON \"t19\".\"MOVIE_ID0\" = \"t20\".\"ID\"","rewrite_time":8.3259},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KEYWORD\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(writer)' OR \"CAST_INFO\".\"NOTE\" = '(head writer)' OR \"CAST_INFO\".\"NOTE\" = '(written by)' OR \"CAST_INFO\".\"NOTE\" = '(story)' OR \"CAST_INFO\".\"NOTE\" = '(story editor)') AND (\"COMPANY_NAME\".\"NAME\" LIKE 'Lionsgate%' AND \"INFO_TYPE\".\"INFO\" = 'genres') AND (\"INFO_TYPE0\".\"INFO\" = 'votes' AND ((\"KEYWORD\".\"KEYWORD\" = 'murder' OR (\"KEYWORD\".\"KEYWORD\" = 'violence' OR \"KEYWORD\".\"KEYWORD\" = 'blood') OR (\"KEYWORD\".\"KEYWORD\" = 'gore' OR \"KEYWORD\".\"KEYWORD\" = 'death' OR (\"KEYWORD\".\"KEYWORD\" = 'female-nudity' OR \"KEYWORD\".\"KEYWORD\" = 'hospital'))) AND (\"MOVIE_INFO\".\"INFO\" = 'Horror' OR (\"MOVIE_INFO\".\"INFO\" = 'Action' OR \"MOVIE_INFO\".\"INFO\" = 'Sci-Fi') OR (\"MOVIE_INFO\".\"INFO\" = 'Thriller' OR (\"MOVIE_INFO\".\"INFO\" = 'Crime' OR \"MOVIE_INFO\".\"INFO\" = 'War'))))) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\") AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\")) AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\") AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"))))","rewrite_time":2.0852},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"INFO1\") AS \"movie_budget\", MIN(\"t9\".\"INFO2\") AS \"movie_votes\", MIN(\"t9\".\"NAME0\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t5\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\" AND \"t4\".\"ID1\" = \"t5\".\"INFO_TYPE_ID\") AS \"t6\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t6\".\"ID2\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\") AS \"t7\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t7\".\"ID3\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t8\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t8\".\"PERSON_ID\") AS \"t9\",\r\n\"TITLE\"\r\nWHERE \"t9\".\"MOVIE_ID1\" = \"TITLE\".\"ID\"","rewrite_time":6.3167},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t4\".\"INFO\") AS \"movie_budget\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"movie_votes\", MIN(\"NAME\".\"NAME\") AS \"writer\", MIN(\"TITLE\".\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')) AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')) AS \"t3\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')) AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\" AND \"t1\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t3\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"NAME\" ON \"t\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":5.4797},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t24\".\"movie_budget\") AS \"movie_budget\", MIN(\"t24\".\"movie_votes\") AS \"movie_votes\", MIN(\"t24\".\"writer\") AS \"writer\", MIN(\"t25\".\"violent_liongate_movie\") AS \"violent_liongate_movie\"\r\nFROM (SELECT \"t21\".\"MOVIE_ID0\", MIN(\"t21\".\"movie_budget\") AS \"movie_budget\", MIN(\"t21\".\"movie_votes\") AS \"movie_votes\", MIN(\"t22\".\"writer\") AS \"writer\"\r\nFROM (SELECT \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\", MIN(\"t18\".\"movie_budget\") AS \"movie_budget\", MIN(\"t18\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"MOVIE_ID0\", MIN(\"t15\".\"movie_budget\") AS \"movie_budget\", MIN(\"t16\".\"movie_votes\") AS \"movie_votes\"\r\nFROM (SELECT \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"movie_budget\") AS \"movie_budget\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\" AS \"ID0\", \"t6\".\"ID\" AS \"ID1\", \"t8\".\"ID\" AS \"ID2\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(head writer)', '(story editor)', '(story)', '(writer)', '(written by)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"NAME\" LIKE 'Lionsgate%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'genres'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'votes'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('blood', 'death', 'female-nudity', 'gore', 'hospital', 'murder', 'violence')\r\nGROUP BY \"ID\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t2\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t4\".\"ID\", \"t6\".\"ID\", \"t8\".\"ID\") AS \"t11\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_budget\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Action', 'Crime', 'Horror', 'Sci-Fi', 'Thriller', 'War')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t13\"\r\nWHERE \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\" AND \"t11\".\"ID0\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"PERSON_ID\", \"t11\".\"MOVIE_ID\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t13\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"movie_votes\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\" AND \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t15\".\"PERSON_ID\", \"t15\".\"MOVIE_ID\", \"t15\".\"ID2\", \"t15\".\"MOVIE_ID0\") AS \"t18\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\" AND \"t18\".\"ID2\" = \"t19\".\"KEYWORD_ID\"\r\nGROUP BY \"t18\".\"PERSON_ID\", \"t18\".\"MOVIE_ID0\") AS \"t21\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"writer\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t22\".\"ID\" = \"t21\".\"PERSON_ID\"\r\nGROUP BY \"t21\".\"MOVIE_ID0\") AS \"t24\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"violent_liongate_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t25\"\r\nWHERE \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\"","rewrite_time":8.3438}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi.info) AS movie_budget,     MIN(mi_idx.info) AS movie_votes,     MIN(n.name) AS writer,     MIN(t.title) AS violent_liongate_movie FROM     cast_info AS ci,     company_name AS cn,     info_type AS it1,     info_type AS it2,     keyword AS k,     movie_companies AS mc,     movie_info AS mi,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     name AS n,     title AS t WHERE     ci.note in (         '(writer)',         '(head writer)',         '(written by)',         '(story)',         '(story editor)'     )     AND cn.name like 'Lionsgate%'     AND it1.info = 'genres'     AND it2.info = 'votes'     AND k.keyword in (         'murder',         'violence',         'blood',         'gore',         'death',         'female-nudity',         'hospital'     )     AND mi.info in (         'Horror',         'Action',         'Sci-Fi',         'Thriller',         'Crime',         'War'     )     AND t.id = mi.movie_id     AND t.id = mi_idx.movie_id     AND t.id = ci.movie_id     AND t.id = mk.movie_id     AND t.id = mc.movie_id     AND ci.movie_id = mi.movie_id     AND ci.movie_id = mi_idx.movie_id     AND ci.movie_id = mk.movie_id     AND ci.movie_id = mc.movie_id     AND mi.movie_id = mi_idx.movie_id     AND mi.movie_id = mk.movie_id     AND mi.movie_id = mc.movie_id     AND mi_idx.movie_id = mk.movie_id     AND mi_idx.movie_id = mc.movie_id     AND mk.movie_id = mc.movie_id     AND n.id = ci.person_id     AND it1.id = mi.info_type_id     AND it2.id = mi_idx.info_type_id     AND k.id = mk.keyword_id     AND cn.id = mc.company_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"link_type\") AS \"link_type\", MIN(\"t7\".\"first_movie\") AS \"first_movie\", MIN(\"t8\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t5\".\"LINKED_MOVIE_ID\", MIN(\"t5\".\"link_type\") AS \"link_type\", MIN(\"t6\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t4\".\"LINKED_MOVIE_ID\", MIN(\"t3\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t2\".\"MOVIE_ID\", MIN(\"t1\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = '10,000-mile-club'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"LINK\") AS \"link_type\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"KEYWORD_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t4\" ON \"t3\".\"ID0\" = \"t4\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\", \"t4\".\"LINKED_MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t5\".\"LINKED_MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"LINKED_MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":3.6673},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM \"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = '10,000-mile-club' AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\" AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"TITLE\".\"ID\"))","rewrite_time":1.2162},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = '10,000-mile-club') AS \"t\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t\".\"ID\") AS \"t0\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t0\".\"ID0\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\") AS \"t1\",\r\n\"TITLE\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"TITLE\".\"ID\") AS \"t2\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"t2\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\"","rewrite_time":2.564},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = '10,000-mile-club') AS \"t\"\r\nCROSS JOIN \"LINK_TYPE\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"TITLE\".\"ID\"\r\nINNER JOIN \"TITLE\" AS \"TITLE0\" ON \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\"","rewrite_time":2.2012},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t10\".\"link_type\") AS \"link_type\", MIN(\"t10\".\"first_movie\") AS \"first_movie\", MIN(\"t11\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t7\".\"LINKED_MOVIE_ID\", MIN(\"t7\".\"link_type\") AS \"link_type\", MIN(\"t8\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t5\".\"LINKED_MOVIE_ID\", MIN(\"t4\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t2\".\"MOVIE_ID\", MIN(\"t1\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = '10,000-mile-club'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"LINK\") AS \"link_type\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t2\".\"KEYWORD_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t1\".\"ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t5\"\r\nWHERE \"t4\".\"ID0\" = \"t5\".\"LINK_TYPE_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\", \"t5\".\"LINKED_MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"LINKED_MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t10\".\"LINKED_MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":3.1662}],"num_rewrites":5,"raw_query":"SELECT     MIN(lt.link) AS link_type,     MIN(t1.title) AS first_movie,     MIN(t2.title) AS second_movie FROM     keyword AS k,     link_type AS lt,     movie_keyword AS mk,     movie_link AS ml,     title AS t1,     title AS t2 WHERE     k.keyword = '10,000-mile-club'     AND mk.keyword_id = k.id     AND t1.id = mk.movie_id     AND ml.movie_id = t1.id     AND ml.linked_movie_id = t2.id     AND lt.id = ml.link_type_id     AND mk.movie_id = t1.id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"link_type\") AS \"link_type\", MIN(\"t7\".\"first_movie\") AS \"first_movie\", MIN(\"t8\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t5\".\"LINKED_MOVIE_ID\", MIN(\"t5\".\"link_type\") AS \"link_type\", MIN(\"t6\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t4\".\"LINKED_MOVIE_ID\", MIN(\"t3\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t2\".\"MOVIE_ID\", MIN(\"t1\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"LINK\") AS \"link_type\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"KEYWORD_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t4\" ON \"t3\".\"ID0\" = \"t4\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID\", \"t4\".\"LINKED_MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t5\".\"LINKED_MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"LINKED_MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":3.1493},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM \"KEYWORD\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_KEYWORD\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'character-name-in-title' AND (\"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"KEYWORD\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\" AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"TITLE\".\"ID\"))","rewrite_time":1.0533},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"LINK\") AS \"link_type\", MIN(\"t2\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"KEYWORD_ID\" = \"t\".\"ID\") AS \"t0\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t0\".\"ID0\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\") AS \"t1\",\r\n\"TITLE\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"TITLE\".\"ID\") AS \"t2\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"t2\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\"","rewrite_time":2.2454},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"LINK_TYPE\".\"LINK\") AS \"link_type\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title') AS \"t\"\r\nCROSS JOIN \"LINK_TYPE\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"TITLE\".\"ID\"\r\nINNER JOIN \"TITLE\" AS \"TITLE0\" ON \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE0\".\"ID\"","rewrite_time":2.0387},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t10\".\"link_type\") AS \"link_type\", MIN(\"t10\".\"first_movie\") AS \"first_movie\", MIN(\"t11\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t7\".\"LINKED_MOVIE_ID\", MIN(\"t7\".\"link_type\") AS \"link_type\", MIN(\"t8\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t5\".\"LINKED_MOVIE_ID\", MIN(\"t4\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t2\".\"MOVIE_ID\", MIN(\"t1\".\"link_type\") AS \"link_type\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'character-name-in-title'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"LINK\") AS \"link_type\"\r\nFROM \"LINK_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t2\".\"KEYWORD_ID\" = \"t0\".\"ID\"\r\nGROUP BY \"t1\".\"ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t5\"\r\nWHERE \"t4\".\"ID0\" = \"t5\".\"LINK_TYPE_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID\", \"t5\".\"LINKED_MOVIE_ID\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"LINKED_MOVIE_ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t10\".\"LINKED_MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":3.0756}],"num_rewrites":5,"raw_query":"SELECT MIN(lt.link) AS link_type, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM keyword AS k, link_type AS lt, movie_keyword AS mk, movie_link AS ml, title AS t1, title AS t2 WHERE k.keyword ='character-name-in-title' AND mk.keyword_id = k.id AND t1.id = mk.movie_id AND ml.movie_id = t1.id AND ml.linked_movie_id = t2.id AND lt.id = ml.link_type_id AND mk.movie_id = t1.id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t19\".\"ID0\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t21\".\"ID1\" = \"t22\".\"INFO_TYPE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"ID2\" = \"t25\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t27\" ON \"t26\".\"ID5\" = \"t27\".\"LINK_TYPE_ID\" AND \"t26\".\"MOVIE_ID1\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"MOVIE_ID\" = \"t27\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\" ON \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":13.0131},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"MOVIE_INFO_IDX0\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"KIND_TYPE\" AS \"KIND_TYPE0\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_INFO_IDX\" AS \"MOVIE_INFO_IDX0\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND (\"KIND_TYPE\".\"KIND\" = 'tv series' AND \"KIND_TYPE0\".\"KIND\" = 'tv series' AND ((\"LINK_TYPE\".\"LINK\" = 'sequel' OR \"LINK_TYPE\".\"LINK\" = 'follows' OR \"LINK_TYPE\".\"LINK\" = 'followed by') AND \"MOVIE_INFO_IDX0\".\"INFO\" < '3.0')) AND (\"TITLE0\".\"PRODUCTION_YEAR\" >= 2005 AND (\"TITLE0\".\"PRODUCTION_YEAR\" <= 2008 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"TITLE0\".\"ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"INFO_TYPE_ID\")) AND (\"TITLE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"KIND_TYPE0\".\"ID\" = \"TITLE0\".\"KIND_ID\" AND \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AND (\"TITLE0\".\"ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\"))))","rewrite_time":3.4269},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME\") AS \"first_company\", MIN(\"t11\".\"NAME0\") AS \"second_company\", MIN(\"t11\".\"INFO1\") AS \"first_rating\", MIN(\"t11\".\"INFO2\") AS \"second_rating\", MIN(\"t11\".\"TITLE\") AS \"first_movie\", MIN(\"t12\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t3\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')) AS \"t4\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t5\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\"\r\nWHERE \"t5\".\"ID0\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AS \"t6\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t6\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0') AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID0\") AS \"t9\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t9\".\"ID5\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t9\".\"MOVIE_ID1\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t9\".\"MOVIE_ID2\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t10\",\r\n\"TITLE\"\r\nWHERE \"t10\".\"MOVIE_ID3\" = \"TITLE\".\"ID\" AND \"t10\".\"ID3\" = \"TITLE\".\"KIND_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008) AS \"t12\"\r\nWHERE \"t11\".\"LINKED_MOVIE_ID\" = \"t12\".\"ID\" AND \"t11\".\"ID4\" = \"t12\".\"KIND_ID\"","rewrite_time":7.679},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"t5\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"t6\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_NAME\" AS \"COMPANY_NAME0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')) AS \"t4\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\" ON \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0') AS \"t5\" ON \"t1\".\"ID\" = \"t5\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES0\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t4\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t5\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"t2\".\"ID\" = \"TITLE\".\"KIND_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008) AS \"t6\" ON \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"t6\".\"ID\" AND \"t3\".\"ID\" = \"t6\".\"KIND_ID\"","rewrite_time":6.6538},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", MIN(\"t27\".\"first_company\") AS \"first_company\", MIN(\"t27\".\"second_company\") AS \"second_company\", MIN(\"t27\".\"first_rating\") AS \"first_rating\", MIN(\"t27\".\"second_rating\") AS \"second_rating\", MIN(\"t28\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID0\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t25\"\r\nWHERE \"t24\".\"ID5\" = \"t25\".\"LINK_TYPE_ID\" AND \"t24\".\"MOVIE_ID1\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t25\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t28\".\"ID\" AND \"t27\".\"ID3\" = \"t28\".\"KIND_ID\"\r\nGROUP BY \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\") AS \"t30\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":11.4283},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\", MIN(\"t26\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\", MIN(\"t23\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\", MIN(\"t19\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\", MIN(\"t16\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"first_company\") AS \"first_company\", MIN(\"t13\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t14\" ON \"t13\".\"ID0\" = \"t14\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t21\" ON \"t20\".\"ID5\" = \"t21\".\"LINK_TYPE_ID\" AND \"t20\".\"MOVIE_ID1\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"MOVIE_ID\" = \"t21\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t22\".\"MOVIE_ID0\" = \"t23\".\"ID\" AND \"t22\".\"ID3\" = \"t23\".\"KIND_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"LINKED_MOVIE_ID\" = \"t26\".\"ID\" AND \"t24\".\"ID4\" = \"t26\".\"KIND_ID\"","rewrite_time":10.4525},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\", MIN(\"t26\".\"first_movie\") AS \"first_movie\", MIN(\"t28\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"ID2\" = \"t21\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\"\r\nGROUP BY \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t23\" ON \"t22\".\"ID5\" = \"t23\".\"LINK_TYPE_ID\" AND \"t22\".\"MOVIE_ID1\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t23\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\" AND \"t24\".\"ID3\" = \"t25\".\"KIND_ID\"\r\nGROUP BY \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\" ON \"t26\".\"LINKED_MOVIE_ID\" = \"t28\".\"ID\" AND \"t26\".\"ID4\" = \"t28\".\"KIND_ID\"","rewrite_time":10.5202},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"first_company\") AS \"first_company\", MIN(\"t31\".\"second_company\") AS \"second_company\", MIN(\"t31\".\"first_rating\") AS \"first_rating\", MIN(\"t31\".\"second_rating\") AS \"second_rating\", MIN(\"t31\".\"first_movie\") AS \"first_movie\", MIN(\"t33\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"ID2\" = \"t23\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID0\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t26\"\r\nWHERE \"t25\".\"ID5\" = \"t26\".\"LINK_TYPE_ID\" AND \"t25\".\"MOVIE_ID1\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"MOVIE_ID\" = \"t26\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\"\r\nWHERE \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t31\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"LINKED_MOVIE_ID\" = \"t33\".\"ID\" AND \"t31\".\"ID4\" = \"t33\".\"KIND_ID\"","rewrite_time":11.302},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\", MIN(\"t27\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t16\".\"first_company\") AS \"first_company\", MIN(\"t16\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\" ON \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\" ON \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t22\" ON \"t21\".\"ID5\" = \"t22\".\"LINK_TYPE_ID\" AND \"t21\".\"MOVIE_ID1\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"ID\" AND \"t23\".\"ID3\" = \"t24\".\"KIND_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"LINKED_MOVIE_ID\" = \"t27\".\"ID\" AND \"t25\".\"ID4\" = \"t27\".\"KIND_ID\"","rewrite_time":10.4439},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t36\".\"first_company\") AS \"first_company\", MIN(\"t36\".\"second_company\") AS \"second_company\", MIN(\"t36\".\"first_rating\") AS \"first_rating\", MIN(\"t36\".\"second_rating\") AS \"second_rating\", MIN(\"t36\".\"first_movie\") AS \"first_movie\", MIN(\"t38\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\", MIN(\"t33\".\"first_company\") AS \"first_company\", MIN(\"t33\".\"second_company\") AS \"second_company\", MIN(\"t33\".\"first_rating\") AS \"first_rating\", MIN(\"t33\".\"second_rating\") AS \"second_rating\", MIN(\"t34\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t21\"\r\nWHERE \"t20\".\"ID0\" = \"t21\".\"COMPANY_ID\"\r\nGROUP BY \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t23\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\" AND \"t28\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID0\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t31\"\r\nWHERE \"t30\".\"ID5\" = \"t31\".\"LINK_TYPE_ID\" AND \"t30\".\"MOVIE_ID1\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"MOVIE_ID\" = \"t31\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\"\r\nWHERE \"t33\".\"MOVIE_ID0\" = \"t34\".\"ID\" AND \"t33\".\"ID3\" = \"t34\".\"KIND_ID\"\r\nGROUP BY \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\") AS \"t36\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2008\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t38\"\r\nWHERE \"t36\".\"LINKED_MOVIE_ID\" = \"t38\".\"ID\" AND \"t36\".\"ID4\" = \"t38\".\"KIND_ID\"","rewrite_time":10.8444}],"num_rewrites":10,"raw_query":"SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code  = '[us]' AND it1.info  = 'rating' AND it2.info  = 'rating' AND kt1.kind  in ('tv series') AND kt2.kind  in ('tv series') AND lt.link  in ('sequel', 'follows', 'followed by') AND mi_idx2.info  < '3.0' AND t2.production_year  between 2005 and 2008 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t19\".\"ID0\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t21\".\"ID1\" = \"t22\".\"INFO_TYPE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"ID2\" = \"t25\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t27\" ON \"t26\".\"ID5\" = \"t27\".\"LINK_TYPE_ID\" AND \"t26\".\"MOVIE_ID1\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"MOVIE_ID\" = \"t27\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\" ON \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":12.0739},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"MOVIE_INFO_IDX0\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"KIND_TYPE\" AS \"KIND_TYPE0\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_INFO_IDX\" AS \"MOVIE_INFO_IDX0\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[nl]' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND (\"KIND_TYPE\".\"KIND\" = 'tv series' AND (\"KIND_TYPE0\".\"KIND\" = 'tv series' AND \"LINK_TYPE\".\"LINK\" LIKE '%follow%')) AND (\"MOVIE_INFO_IDX0\".\"INFO\" < '3.0' AND (\"TITLE0\".\"PRODUCTION_YEAR\" = 2007 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"TITLE0\".\"ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"INFO_TYPE_ID\")) AND (\"TITLE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"KIND_TYPE0\".\"ID\" = \"TITLE0\".\"KIND_ID\" AND \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AND (\"TITLE0\".\"ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\"))))","rewrite_time":2.2782},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME\") AS \"first_company\", MIN(\"t11\".\"NAME0\") AS \"second_company\", MIN(\"t11\".\"INFO1\") AS \"first_rating\", MIN(\"t11\".\"INFO2\") AS \"second_rating\", MIN(\"t11\".\"TITLE\") AS \"first_movie\", MIN(\"t12\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]') AS \"t\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t3\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%') AS \"t4\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t5\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\"\r\nWHERE \"t5\".\"ID0\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AS \"t6\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t6\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0') AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID0\") AS \"t9\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t9\".\"ID5\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t9\".\"MOVIE_ID1\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t9\".\"MOVIE_ID2\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t10\",\r\n\"TITLE\"\r\nWHERE \"t10\".\"MOVIE_ID3\" = \"TITLE\".\"ID\" AND \"t10\".\"ID3\" = \"TITLE\".\"KIND_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007) AS \"t12\"\r\nWHERE \"t11\".\"LINKED_MOVIE_ID\" = \"t12\".\"ID\" AND \"t11\".\"ID4\" = \"t12\".\"KIND_ID\"","rewrite_time":6.8502},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"t5\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"t6\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]') AS \"t\"\r\nCROSS JOIN \"COMPANY_NAME\" AS \"COMPANY_NAME0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series') AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%') AS \"t4\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\" ON \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0') AS \"t5\" ON \"t1\".\"ID\" = \"t5\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES0\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t4\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t5\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"t2\".\"ID\" = \"TITLE\".\"KIND_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007) AS \"t6\" ON \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"t6\".\"ID\" AND \"t3\".\"ID\" = \"t6\".\"KIND_ID\"","rewrite_time":6.1996},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", MIN(\"t27\".\"first_company\") AS \"first_company\", MIN(\"t27\".\"second_company\") AS \"second_company\", MIN(\"t27\".\"first_rating\") AS \"first_rating\", MIN(\"t27\".\"second_rating\") AS \"second_rating\", MIN(\"t28\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID0\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t25\"\r\nWHERE \"t24\".\"ID5\" = \"t25\".\"LINK_TYPE_ID\" AND \"t24\".\"MOVIE_ID1\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t25\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t28\".\"ID\" AND \"t27\".\"ID3\" = \"t28\".\"KIND_ID\"\r\nGROUP BY \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\") AS \"t30\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":10.9073},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\", MIN(\"t26\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\", MIN(\"t23\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\", MIN(\"t19\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\", MIN(\"t16\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"first_company\") AS \"first_company\", MIN(\"t13\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t14\" ON \"t13\".\"ID0\" = \"t14\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t21\" ON \"t20\".\"ID5\" = \"t21\".\"LINK_TYPE_ID\" AND \"t20\".\"MOVIE_ID1\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"MOVIE_ID\" = \"t21\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t22\".\"MOVIE_ID0\" = \"t23\".\"ID\" AND \"t22\".\"ID3\" = \"t23\".\"KIND_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"LINKED_MOVIE_ID\" = \"t26\".\"ID\" AND \"t24\".\"ID4\" = \"t26\".\"KIND_ID\"","rewrite_time":10.0444},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\", MIN(\"t26\".\"first_movie\") AS \"first_movie\", MIN(\"t28\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"ID2\" = \"t21\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\"\r\nGROUP BY \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t23\" ON \"t22\".\"ID5\" = \"t23\".\"LINK_TYPE_ID\" AND \"t22\".\"MOVIE_ID1\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t23\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\" AND \"t24\".\"ID3\" = \"t25\".\"KIND_ID\"\r\nGROUP BY \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\" ON \"t26\".\"LINKED_MOVIE_ID\" = \"t28\".\"ID\" AND \"t26\".\"ID4\" = \"t28\".\"KIND_ID\"","rewrite_time":9.8128},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"first_company\") AS \"first_company\", MIN(\"t31\".\"second_company\") AS \"second_company\", MIN(\"t31\".\"first_rating\") AS \"first_rating\", MIN(\"t31\".\"second_rating\") AS \"second_rating\", MIN(\"t31\".\"first_movie\") AS \"first_movie\", MIN(\"t33\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"ID2\" = \"t23\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID0\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t26\"\r\nWHERE \"t25\".\"ID5\" = \"t26\".\"LINK_TYPE_ID\" AND \"t25\".\"MOVIE_ID1\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"MOVIE_ID\" = \"t26\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\"\r\nWHERE \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t31\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"LINKED_MOVIE_ID\" = \"t33\".\"ID\" AND \"t31\".\"ID4\" = \"t33\".\"KIND_ID\"","rewrite_time":10.9291},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\", MIN(\"t27\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t16\".\"first_company\") AS \"first_company\", MIN(\"t16\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\" ON \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\" ON \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t22\" ON \"t21\".\"ID5\" = \"t22\".\"LINK_TYPE_ID\" AND \"t21\".\"MOVIE_ID1\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"ID\" AND \"t23\".\"ID3\" = \"t24\".\"KIND_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"LINKED_MOVIE_ID\" = \"t27\".\"ID\" AND \"t25\".\"ID4\" = \"t27\".\"KIND_ID\"","rewrite_time":10.2582},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t36\".\"first_company\") AS \"first_company\", MIN(\"t36\".\"second_company\") AS \"second_company\", MIN(\"t36\".\"first_rating\") AS \"first_rating\", MIN(\"t36\".\"second_rating\") AS \"second_rating\", MIN(\"t36\".\"first_movie\") AS \"first_movie\", MIN(\"t38\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\", MIN(\"t33\".\"first_company\") AS \"first_company\", MIN(\"t33\".\"second_company\") AS \"second_company\", MIN(\"t33\".\"first_rating\") AS \"first_rating\", MIN(\"t33\".\"second_rating\") AS \"second_rating\", MIN(\"t34\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[nl]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" = 'tv series'\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" LIKE '%follow%'\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t21\"\r\nWHERE \"t20\".\"ID0\" = \"t21\".\"COMPANY_ID\"\r\nGROUP BY \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t23\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\" AND \"t28\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID0\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t31\"\r\nWHERE \"t30\".\"ID5\" = \"t31\".\"LINK_TYPE_ID\" AND \"t30\".\"MOVIE_ID1\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"MOVIE_ID\" = \"t31\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\"\r\nWHERE \"t33\".\"MOVIE_ID0\" = \"t34\".\"ID\" AND \"t33\".\"ID3\" = \"t34\".\"KIND_ID\"\r\nGROUP BY \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\") AS \"t36\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" = 2007\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t38\"\r\nWHERE \"t36\".\"LINKED_MOVIE_ID\" = \"t38\".\"ID\" AND \"t36\".\"ID4\" = \"t38\".\"KIND_ID\"","rewrite_time":12.1482}],"num_rewrites":10,"raw_query":"SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code  = '[nl]' AND it1.info  = 'rating' AND it2.info  = 'rating' AND kt1.kind  in ('tv series') AND kt2.kind  in ('tv series') AND lt.link  LIKE '%follow%' AND mi_idx2.info  < '3.0' AND t2.production_year  = 2007 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\" ON \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t20\" ON \"t19\".\"ID0\" = \"t20\".\"COMPANY_ID\"\r\nGROUP BY \"t19\".\"ID1\", \"t19\".\"ID2\", \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\" ON \"t21\".\"ID1\" = \"t22\".\"INFO_TYPE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID2\", \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID0\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t25\" ON \"t23\".\"ID2\" = \"t25\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID0\" = \"t25\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID1\", \"t25\".\"MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t27\" ON \"t26\".\"ID5\" = \"t27\".\"LINK_TYPE_ID\" AND \"t26\".\"MOVIE_ID1\" = \"t27\".\"MOVIE_ID\" AND \"t26\".\"MOVIE_ID\" = \"t27\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", \"t27\".\"MOVIE_ID\") AS \"t28\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t30\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\" ON \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":10.768},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"COMPANY_NAME\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"MOVIE_INFO_IDX0\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"TITLE0\".\"TITLE\") AS \"second_movie\"\r\nFROM \"COMPANY_NAME\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n\"INFO_TYPE\",\r\n\"INFO_TYPE\" AS \"INFO_TYPE0\",\r\n\"KIND_TYPE\",\r\n\"KIND_TYPE\" AS \"KIND_TYPE0\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_INFO_IDX\" AS \"MOVIE_INFO_IDX0\",\r\n\"MOVIE_LINK\",\r\n\"TITLE\",\r\n\"TITLE\" AS \"TITLE0\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" <> '[us]' AND (\"INFO_TYPE\".\"INFO\" = 'rating' AND \"INFO_TYPE0\".\"INFO\" = 'rating') AND ((\"KIND_TYPE\".\"KIND\" = 'tv series' OR \"KIND_TYPE\".\"KIND\" = 'episode') AND (\"KIND_TYPE0\".\"KIND\" = 'tv series' OR \"KIND_TYPE0\".\"KIND\" = 'episode') AND ((\"LINK_TYPE\".\"LINK\" = 'sequel' OR \"LINK_TYPE\".\"LINK\" = 'follows' OR \"LINK_TYPE\".\"LINK\" = 'followed by') AND \"MOVIE_INFO_IDX0\".\"INFO\" < '3.5')) AND (\"TITLE0\".\"PRODUCTION_YEAR\" >= 2000 AND (\"TITLE0\".\"PRODUCTION_YEAR\" <= 2010 AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"TITLE0\".\"ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" AND (\"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"))) AND (\"KIND_TYPE\".\"ID\" = \"TITLE\".\"KIND_ID\" AND (\"COMPANY_NAME\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"INFO_TYPE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"INFO_TYPE_ID\")) AND (\"TITLE0\".\"ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"KIND_TYPE0\".\"ID\" = \"TITLE0\".\"KIND_ID\" AND \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AND (\"TITLE0\".\"ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\" AND \"MOVIE_INFO_IDX0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES0\".\"MOVIE_ID\"))))","rewrite_time":2.2991},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t11\".\"NAME\") AS \"first_company\", MIN(\"t11\".\"NAME0\") AS \"second_company\", MIN(\"t11\".\"INFO1\") AS \"first_rating\", MIN(\"t11\".\"INFO2\") AS \"second_rating\", MIN(\"t11\".\"TITLE\") AS \"first_movie\", MIN(\"t12\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\",\r\n\"COMPANY_NAME\" AS \"COMPANY_NAME0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')) AS \"t2\",\r\n(SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')) AS \"t3\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')) AS \"t4\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\") AS \"t5\",\r\n\"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\"\r\nWHERE \"t5\".\"ID0\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\") AS \"t6\",\r\n\"MOVIE_INFO_IDX\"\r\nWHERE \"t6\".\"ID1\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5') AS \"t8\"\r\nWHERE \"t7\".\"ID2\" = \"t8\".\"INFO_TYPE_ID\" AND \"t8\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID0\") AS \"t9\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t9\".\"ID5\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t9\".\"MOVIE_ID1\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t9\".\"MOVIE_ID2\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t10\",\r\n\"TITLE\"\r\nWHERE \"t10\".\"MOVIE_ID3\" = \"TITLE\".\"ID\" AND \"t10\".\"ID3\" = \"TITLE\".\"KIND_ID\") AS \"t11\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t12\"\r\nWHERE \"t11\".\"LINKED_MOVIE_ID\" = \"t12\".\"ID\" AND \"t11\".\"ID4\" = \"t12\".\"KIND_ID\"","rewrite_time":7.284},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"NAME\") AS \"first_company\", MIN(\"COMPANY_NAME0\".\"NAME\") AS \"second_company\", MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"first_rating\", MIN(\"t5\".\"INFO\") AS \"second_rating\", MIN(\"TITLE\".\"TITLE\") AS \"first_movie\", MIN(\"t6\".\"TITLE\") AS \"second_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]') AS \"t\"\r\nCROSS JOIN \"COMPANY_NAME\" AS \"COMPANY_NAME0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t1\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')) AS \"t2\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')) AS \"t3\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')) AS \"t4\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_COMPANIES\" AS \"MOVIE_COMPANIES0\" ON \"COMPANY_NAME0\".\"ID\" = \"MOVIE_COMPANIES0\".\"COMPANY_ID\"\r\nINNER JOIN \"MOVIE_INFO_IDX\" ON \"t0\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5') AS \"t5\" ON \"t1\".\"ID\" = \"t5\".\"INFO_TYPE_ID\" AND \"MOVIE_COMPANIES0\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t4\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"MOVIE_INFO_IDX\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"MOVIE_ID\" AND \"t5\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN \"TITLE\" ON \"MOVIE_LINK\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"t2\".\"ID\" = \"TITLE\".\"KIND_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t6\" ON \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"t6\".\"ID\" AND \"t3\".\"ID\" = \"t6\".\"KIND_ID\"","rewrite_time":7.6254},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\", MIN(\"t30\".\"first_movie\") AS \"first_movie\", MIN(\"t32\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\", MIN(\"t27\".\"first_company\") AS \"first_company\", MIN(\"t27\".\"second_company\") AS \"second_company\", MIN(\"t27\".\"first_rating\") AS \"first_rating\", MIN(\"t27\".\"second_rating\") AS \"second_rating\", MIN(\"t28\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t22\"\r\nWHERE \"t20\".\"ID2\" = \"t22\".\"INFO_TYPE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID0\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID1\", \"t22\".\"MOVIE_ID\") AS \"t24\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t25\"\r\nWHERE \"t24\".\"ID5\" = \"t25\".\"LINK_TYPE_ID\" AND \"t24\".\"MOVIE_ID1\" = \"t25\".\"MOVIE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t25\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t24\".\"ID3\", \"t24\".\"ID4\", \"t25\".\"LINKED_MOVIE_ID\", \"t25\".\"MOVIE_ID\") AS \"t27\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\"\r\nWHERE \"t27\".\"MOVIE_ID0\" = \"t28\".\"ID\" AND \"t27\".\"ID3\" = \"t28\".\"KIND_ID\"\r\nGROUP BY \"t27\".\"ID4\", \"t27\".\"LINKED_MOVIE_ID\") AS \"t30\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t32\"\r\nWHERE \"t30\".\"LINKED_MOVIE_ID\" = \"t32\".\"ID\" AND \"t30\".\"ID4\" = \"t32\".\"KIND_ID\"","rewrite_time":12.2477},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\", MIN(\"t26\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\", MIN(\"t23\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\", MIN(\"t20\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\", MIN(\"t19\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\", MIN(\"t16\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t13\".\"first_company\") AS \"first_company\", MIN(\"t13\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t14\" ON \"t13\".\"ID0\" = \"t14\".\"COMPANY_ID\"\r\nGROUP BY \"t13\".\"ID1\", \"t13\".\"ID2\", \"t13\".\"ID3\", \"t13\".\"ID4\", \"t13\".\"ID5\", \"t13\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t16\" ON \"t15\".\"ID1\" = \"t16\".\"INFO_TYPE_ID\" AND \"t15\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\r\nGROUP BY \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID0\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\" ON \"t17\".\"ID2\" = \"t19\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID0\" = \"t19\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID1\", \"t19\".\"MOVIE_ID\") AS \"t20\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t21\" ON \"t20\".\"ID5\" = \"t21\".\"LINK_TYPE_ID\" AND \"t20\".\"MOVIE_ID1\" = \"t21\".\"MOVIE_ID\" AND \"t20\".\"MOVIE_ID\" = \"t21\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t20\".\"ID3\", \"t20\".\"ID4\", \"t21\".\"LINKED_MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t23\" ON \"t22\".\"MOVIE_ID0\" = \"t23\".\"ID\" AND \"t22\".\"ID3\" = \"t23\".\"KIND_ID\"\r\nGROUP BY \"t22\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t26\" ON \"t24\".\"LINKED_MOVIE_ID\" = \"t26\".\"ID\" AND \"t24\".\"ID4\" = \"t26\".\"KIND_ID\"","rewrite_time":11.0868},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t26\".\"second_rating\") AS \"second_rating\", MIN(\"t26\".\"first_movie\") AS \"first_movie\", MIN(\"t28\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\", MIN(\"t24\".\"first_company\") AS \"first_company\", MIN(\"t24\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\", MIN(\"t24\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t22\".\"first_company\") AS \"first_company\", MIN(\"t22\".\"second_company\") AS \"second_company\", MIN(\"t22\".\"first_rating\") AS \"first_rating\", MIN(\"t22\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\", MIN(\"t19\".\"first_company\") AS \"first_company\", MIN(\"t19\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\" ON \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"ID1\" = \"t18\".\"INFO_TYPE_ID\" AND \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t17\".\"MOVIE_ID0\", \"t18\".\"MOVIE_ID\") AS \"t19\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t21\" ON \"t19\".\"ID2\" = \"t21\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID0\" = \"t21\".\"MOVIE_ID\"\r\nGROUP BY \"t19\".\"ID3\", \"t19\".\"ID4\", \"t19\".\"ID5\", \"t19\".\"MOVIE_ID1\", \"t21\".\"MOVIE_ID\") AS \"t22\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t23\" ON \"t22\".\"ID5\" = \"t23\".\"LINK_TYPE_ID\" AND \"t22\".\"MOVIE_ID1\" = \"t23\".\"MOVIE_ID\" AND \"t22\".\"MOVIE_ID\" = \"t23\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t22\".\"ID3\", \"t22\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", \"t23\".\"MOVIE_ID\") AS \"t24\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t25\" ON \"t24\".\"MOVIE_ID0\" = \"t25\".\"ID\" AND \"t24\".\"ID3\" = \"t25\".\"KIND_ID\"\r\nGROUP BY \"t24\".\"ID4\", \"t24\".\"LINKED_MOVIE_ID\") AS \"t26\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t28\" ON \"t26\".\"LINKED_MOVIE_ID\" = \"t28\".\"ID\" AND \"t26\".\"ID4\" = \"t28\".\"KIND_ID\"","rewrite_time":10.3675},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t31\".\"first_company\") AS \"first_company\", MIN(\"t31\".\"second_company\") AS \"second_company\", MIN(\"t31\".\"first_rating\") AS \"first_rating\", MIN(\"t31\".\"second_rating\") AS \"second_rating\", MIN(\"t31\".\"first_movie\") AS \"first_movie\", MIN(\"t33\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\", MIN(\"t28\".\"first_company\") AS \"first_company\", MIN(\"t28\".\"second_company\") AS \"second_company\", MIN(\"t28\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\", MIN(\"t29\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t19\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t15\".\"first_company\") AS \"first_company\", MIN(\"t15\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\"\r\nWHERE \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t16\"\r\nWHERE \"t15\".\"ID0\" = \"t16\".\"COMPANY_ID\"\r\nGROUP BY \"t15\".\"ID1\", \"t15\".\"ID2\", \"t15\".\"ID3\", \"t15\".\"ID4\", \"t15\".\"ID5\", \"t15\".\"MOVIE_ID\", \"t16\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t19\"\r\nWHERE \"t18\".\"ID1\" = \"t19\".\"INFO_TYPE_ID\" AND \"t19\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID2\", \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID0\", \"t19\".\"MOVIE_ID\") AS \"t21\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t23\"\r\nWHERE \"t21\".\"ID2\" = \"t23\".\"INFO_TYPE_ID\" AND \"t23\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID0\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t21\".\"ID5\", \"t21\".\"MOVIE_ID1\", \"t23\".\"MOVIE_ID\") AS \"t25\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t26\"\r\nWHERE \"t25\".\"ID5\" = \"t26\".\"LINK_TYPE_ID\" AND \"t25\".\"MOVIE_ID1\" = \"t26\".\"MOVIE_ID\" AND \"t25\".\"MOVIE_ID\" = \"t26\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t25\".\"ID3\", \"t25\".\"ID4\", \"t26\".\"LINKED_MOVIE_ID\", \"t26\".\"MOVIE_ID\") AS \"t28\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t29\"\r\nWHERE \"t28\".\"MOVIE_ID0\" = \"t29\".\"ID\" AND \"t28\".\"ID3\" = \"t29\".\"KIND_ID\"\r\nGROUP BY \"t28\".\"ID4\", \"t28\".\"LINKED_MOVIE_ID\") AS \"t31\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t33\"\r\nWHERE \"t31\".\"LINKED_MOVIE_ID\" = \"t33\".\"ID\" AND \"t31\".\"ID4\" = \"t33\".\"KIND_ID\"","rewrite_time":11.2926},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t25\".\"first_company\") AS \"first_company\", MIN(\"t25\".\"second_company\") AS \"second_company\", MIN(\"t25\".\"first_rating\") AS \"first_rating\", MIN(\"t25\".\"second_rating\") AS \"second_rating\", MIN(\"t25\".\"first_movie\") AS \"first_movie\", MIN(\"t27\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t23\".\"first_rating\") AS \"first_rating\", MIN(\"t23\".\"second_rating\") AS \"second_rating\", MIN(\"t24\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t21\".\"first_company\") AS \"first_company\", MIN(\"t21\".\"second_company\") AS \"second_company\", MIN(\"t21\".\"first_rating\") AS \"first_rating\", MIN(\"t21\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\", MIN(\"t18\".\"first_company\") AS \"first_company\", MIN(\"t18\".\"second_company\") AS \"second_company\", MIN(\"t18\".\"first_rating\") AS \"first_rating\", MIN(\"t20\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t16\".\"first_company\") AS \"first_company\", MIN(\"t16\".\"second_company\") AS \"second_company\", MIN(\"t17\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t14\".\"first_company\") AS \"first_company\", MIN(\"t14\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"ID\" AS \"ID1\", \"t5\".\"ID\" AS \"ID2\", \"t7\".\"ID\" AS \"ID3\", \"t9\".\"ID\" AS \"ID4\", \"t11\".\"ID\" AS \"ID5\", \"t12\".\"MOVIE_ID\", MIN(\"t0\".\"first_company\") AS \"first_company\", MIN(\"t1\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t5\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t7\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t9\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t12\" ON \"t0\".\"ID\" = \"t12\".\"COMPANY_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"ID\", \"t5\".\"ID\", \"t7\".\"ID\", \"t9\".\"ID\", \"t11\".\"ID\", \"t12\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t15\" ON \"t14\".\"ID0\" = \"t15\".\"COMPANY_ID\"\r\nGROUP BY \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t14\".\"ID5\", \"t14\".\"MOVIE_ID\", \"t15\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t17\" ON \"t16\".\"ID1\" = \"t17\".\"INFO_TYPE_ID\" AND \"t16\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\r\nGROUP BY \"t16\".\"ID2\", \"t16\".\"ID3\", \"t16\".\"ID4\", \"t16\".\"ID5\", \"t16\".\"MOVIE_ID0\", \"t17\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t20\" ON \"t18\".\"ID2\" = \"t20\".\"INFO_TYPE_ID\" AND \"t18\".\"MOVIE_ID0\" = \"t20\".\"MOVIE_ID\"\r\nGROUP BY \"t18\".\"ID3\", \"t18\".\"ID4\", \"t18\".\"ID5\", \"t18\".\"MOVIE_ID1\", \"t20\".\"MOVIE_ID\") AS \"t21\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t22\" ON \"t21\".\"ID5\" = \"t22\".\"LINK_TYPE_ID\" AND \"t21\".\"MOVIE_ID1\" = \"t22\".\"MOVIE_ID\" AND \"t21\".\"MOVIE_ID\" = \"t22\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t21\".\"ID3\", \"t21\".\"ID4\", \"t22\".\"LINKED_MOVIE_ID\", \"t22\".\"MOVIE_ID\") AS \"t23\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t24\" ON \"t23\".\"MOVIE_ID0\" = \"t24\".\"ID\" AND \"t23\".\"ID3\" = \"t24\".\"KIND_ID\"\r\nGROUP BY \"t23\".\"ID4\", \"t23\".\"LINKED_MOVIE_ID\") AS \"t25\"\r\nINNER JOIN (SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t27\" ON \"t25\".\"LINKED_MOVIE_ID\" = \"t27\".\"ID\" AND \"t25\".\"ID4\" = \"t27\".\"KIND_ID\"","rewrite_time":10.6962},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t36\".\"first_company\") AS \"first_company\", MIN(\"t36\".\"second_company\") AS \"second_company\", MIN(\"t36\".\"first_rating\") AS \"first_rating\", MIN(\"t36\".\"second_rating\") AS \"second_rating\", MIN(\"t36\".\"first_movie\") AS \"first_movie\", MIN(\"t38\".\"second_movie\") AS \"second_movie\"\r\nFROM (SELECT \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\", MIN(\"t33\".\"first_company\") AS \"first_company\", MIN(\"t33\".\"second_company\") AS \"second_company\", MIN(\"t33\".\"first_rating\") AS \"first_rating\", MIN(\"t33\".\"second_rating\") AS \"second_rating\", MIN(\"t34\".\"first_movie\") AS \"first_movie\"\r\nFROM (SELECT \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t30\".\"first_company\") AS \"first_company\", MIN(\"t30\".\"second_company\") AS \"second_company\", MIN(\"t30\".\"first_rating\") AS \"first_rating\", MIN(\"t30\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\", MIN(\"t26\".\"first_company\") AS \"first_company\", MIN(\"t26\".\"second_company\") AS \"second_company\", MIN(\"t26\".\"first_rating\") AS \"first_rating\", MIN(\"t28\".\"second_rating\") AS \"second_rating\"\r\nFROM (SELECT \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\" AS \"MOVIE_ID1\", MIN(\"t23\".\"first_company\") AS \"first_company\", MIN(\"t23\".\"second_company\") AS \"second_company\", MIN(\"t24\".\"first_rating\") AS \"first_rating\"\r\nFROM (SELECT \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t20\".\"first_company\") AS \"first_company\", MIN(\"t20\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\", MIN(\"t17\".\"first_company\") AS \"first_company\", MIN(\"t17\".\"second_company\") AS \"second_company\"\r\nFROM (SELECT \"t14\".\"ID\", \"t14\".\"ID0\", \"t14\".\"ID1\", \"t14\".\"ID2\", \"t14\".\"ID3\", \"t14\".\"ID4\", \"t16\".\"ID\" AS \"ID5\", \"t14\".\"first_company\", \"t14\".\"second_company\"\r\nFROM (SELECT \"t11\".\"ID\", \"t11\".\"ID0\", \"t11\".\"ID1\", \"t11\".\"ID2\", \"t11\".\"ID3\", \"t13\".\"ID\" AS \"ID4\", \"t11\".\"first_company\", \"t11\".\"second_company\"\r\nFROM (SELECT \"t8\".\"ID\", \"t8\".\"ID0\", \"t8\".\"ID1\", \"t8\".\"ID2\", \"t10\".\"ID\" AS \"ID3\", \"t8\".\"first_company\", \"t8\".\"second_company\"\r\nFROM (SELECT \"t5\".\"ID\", \"t5\".\"ID0\", \"t5\".\"ID1\", \"t7\".\"ID\" AS \"ID2\", \"t5\".\"first_company\", \"t5\".\"second_company\"\r\nFROM (SELECT \"t2\".\"ID\", \"t2\".\"ID0\", \"t4\".\"ID\" AS \"ID1\", \"t2\".\"first_company\", \"t2\".\"second_company\"\r\nFROM (SELECT \"t0\".\"ID\", \"t1\".\"ID\" AS \"ID0\", \"t0\".\"first_company\", \"t1\".\"second_company\"\r\nFROM (SELECT \"ID\", MIN(\"NAME\") AS \"first_company\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" <> '[us]'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"second_company\"\r\nFROM \"COMPANY_NAME\"\r\nGROUP BY \"ID\") AS \"t1\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t10\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"KIND_TYPE\"\r\nWHERE \"KIND\" IN ('episode', 'tv series')\r\nGROUP BY \"ID\") AS \"t13\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('followed by', 'follows', 'sequel')\r\nGROUP BY \"ID\") AS \"t16\") AS \"t17\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t18\"\r\nWHERE \"t17\".\"ID\" = \"t18\".\"COMPANY_ID\"\r\nGROUP BY \"t17\".\"ID0\", \"t17\".\"ID1\", \"t17\".\"ID2\", \"t17\".\"ID3\", \"t17\".\"ID4\", \"t17\".\"ID5\", \"t18\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t21\"\r\nWHERE \"t20\".\"ID0\" = \"t21\".\"COMPANY_ID\"\r\nGROUP BY \"t20\".\"ID1\", \"t20\".\"ID2\", \"t20\".\"ID3\", \"t20\".\"ID4\", \"t20\".\"ID5\", \"t20\".\"MOVIE_ID\", \"t21\".\"MOVIE_ID\") AS \"t23\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"first_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t24\"\r\nWHERE \"t23\".\"ID1\" = \"t24\".\"INFO_TYPE_ID\" AND \"t24\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\"\r\nGROUP BY \"t23\".\"ID2\", \"t23\".\"ID3\", \"t23\".\"ID4\", \"t23\".\"ID5\", \"t23\".\"MOVIE_ID0\", \"t24\".\"MOVIE_ID\") AS \"t26\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"second_rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" < '3.5'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t28\"\r\nWHERE \"t26\".\"ID2\" = \"t28\".\"INFO_TYPE_ID\" AND \"t28\".\"MOVIE_ID\" = \"t26\".\"MOVIE_ID0\"\r\nGROUP BY \"t26\".\"ID3\", \"t26\".\"ID4\", \"t26\".\"ID5\", \"t26\".\"MOVIE_ID1\", \"t28\".\"MOVIE_ID\") AS \"t30\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t31\"\r\nWHERE \"t30\".\"ID5\" = \"t31\".\"LINK_TYPE_ID\" AND \"t30\".\"MOVIE_ID1\" = \"t31\".\"MOVIE_ID\" AND \"t30\".\"MOVIE_ID\" = \"t31\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t30\".\"ID3\", \"t30\".\"ID4\", \"t31\".\"LINKED_MOVIE_ID\", \"t31\".\"MOVIE_ID\") AS \"t33\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"first_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t34\"\r\nWHERE \"t33\".\"MOVIE_ID0\" = \"t34\".\"ID\" AND \"t33\".\"ID3\" = \"t34\".\"KIND_ID\"\r\nGROUP BY \"t33\".\"ID4\", \"t33\".\"LINKED_MOVIE_ID\") AS \"t36\",\r\n(SELECT \"KIND_ID\", \"ID\", MIN(\"TITLE\") AS \"second_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2000 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"KIND_ID\", \"ID\") AS \"t38\"\r\nWHERE \"t36\".\"LINKED_MOVIE_ID\" = \"t38\".\"ID\" AND \"t36\".\"ID4\" = \"t38\".\"KIND_ID\"","rewrite_time":13.8865}],"num_rewrites":10,"raw_query":"SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code  != '[us]' AND it1.info  = 'rating' AND it2.info  = 'rating' AND kt1.kind  in ('tv series', 'episode') AND kt2.kind  in ('tv series', 'episode') AND lt.link  in ('sequel', 'follows', 'followed by') AND mi_idx2.info  < '3.5' AND t2.production_year  between 2000 and 2010 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')\r\nGROUP BY \"MOVIE_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\" ON \"t2\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":2.4817},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Denmark') OR (\"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'Denish' OR (\"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR \"MOVIE_INFO\".\"INFO\" = 'German'))) AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))","rewrite_time":0.847},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')) AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":1.8932},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')) AS \"t0\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":1.6518},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')\r\nGROUP BY \"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.1658}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     keyword AS k,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     k.keyword like '%sequel%'     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Denish',         'Norwegian',         'German'     )     AND t.production_year > 2005     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi.movie_id     AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Bulgaria'\r\nGROUP BY \"MOVIE_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\" ON \"t2\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":2.2995},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND (\"MOVIE_INFO\".\"INFO\" = 'Bulgaria' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2010) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))","rewrite_time":0.8742},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Bulgaria') AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":1.6776},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Bulgaria') AS \"t0\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":1.6159},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" = 'Bulgaria'\r\nGROUP BY \"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.2134}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     keyword AS k,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     k.keyword like '%sequel%'     AND mi.info IN ('Bulgaria')     AND t.production_year > 2010     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi.movie_id     AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"MOVIE_ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\" ON \"t2\".\"MOVIE_ID\" = \"t3\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"ID\"","rewrite_time":2.2508},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"KEYWORD\",\r\n\"MOVIE_INFO\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Denish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND \"TITLE\".\"PRODUCTION_YEAR\" > 1990) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"))","rewrite_time":0.7909},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t0\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t0\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":1.8108},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t0\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t0\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":1.8215},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t7\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t2\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"MOVIE_ID\") AS \"t2\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t3\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t3\".\"KEYWORD_ID\"\r\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":2.3032}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS movie_title FROM     keyword AS k,     movie_info AS mi,     movie_keyword AS mk,     title AS t WHERE     k.keyword like '%sequel%'     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Denish',         'Norwegian',         'German',         'USA',         'American'     )     AND t.production_year > 1990     AND t.id = mi.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi.movie_id     AND k.id = mk.keyword_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"rating\") AS \"rating\", MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '5.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.8483},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'rating' AND \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND (\"MOVIE_INFO_IDX\".\"INFO\" > '5.0' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":0.8027},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"INFO0\") AS \"rating\", MIN(\"t4\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '5.0') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.3472},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"INFO\") AS \"rating\", MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '5.0') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.1747},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"rating\") AS \"rating\", MIN(\"t11\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '5.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t7\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"KEYWORD_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":2.7577}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi_idx.info) AS rating,     MIN(t.title) AS movie_title FROM     info_type AS it,     keyword AS k,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     title AS t WHERE     it.info = 'rating'     AND k.keyword like '%sequel%'     AND mi_idx.info > '5.0'     AND t.production_year > 2005     AND t.id = mi_idx.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi_idx.movie_id     AND k.id = mk.keyword_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"rating\") AS \"rating\", MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '9.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.846},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'rating' AND \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND (\"MOVIE_INFO_IDX\".\"INFO\" > '9.0' AND \"TITLE\".\"PRODUCTION_YEAR\" > 2010) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":0.9235},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"INFO0\") AS \"rating\", MIN(\"t4\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '9.0') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.0992},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"INFO\") AS \"rating\", MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '9.0') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":1.9568},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"rating\") AS \"rating\", MIN(\"t11\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '9.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t7\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"KEYWORD_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":2.6814}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi_idx.info) AS rating,     MIN(t.title) AS movie_title FROM     info_type AS it,     keyword AS k,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     title AS t WHERE     it.info = 'rating'     AND k.keyword like '%sequel%'     AND mi_idx.info > '9.0'     AND t.production_year > 2010     AND t.id = mi_idx.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi_idx.movie_id     AND k.id = mk.keyword_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"rating\") AS \"rating\", MIN(\"t9\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", MIN(\"t5\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '2.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\" ON \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t6\" ON \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t6\".\"KEYWORD_ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"ID\"","rewrite_time":2.7451},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"MOVIE_INFO_IDX\".\"INFO\") AS \"rating\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"INFO_TYPE\",\r\n\"KEYWORD\",\r\n\"MOVIE_INFO_IDX\",\r\n\"MOVIE_KEYWORD\",\r\n\"TITLE\"\r\nWHERE \"INFO_TYPE\".\"INFO\" = 'rating' AND \"KEYWORD\".\"KEYWORD\" LIKE '%sequel%' AND (\"MOVIE_INFO_IDX\".\"INFO\" > '2.0' AND \"TITLE\".\"PRODUCTION_YEAR\" > 1990) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND (\"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"MOVIE_INFO_IDX\".\"MOVIE_ID\" AND (\"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO_IDX\".\"INFO_TYPE_ID\")))","rewrite_time":0.8977},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t3\".\"INFO0\") AS \"rating\", MIN(\"t4\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '2.0') AS \"t1\"\r\nWHERE \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\") AS \"t2\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t2\".\"ID0\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":2.1671},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t1\".\"INFO\") AS \"rating\", MIN(\"t2\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating') AS \"t\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '2.0') AS \"t1\" ON \"t\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t1\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":1.9715},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t9\".\"rating\") AS \"rating\", MIN(\"t11\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", MIN(\"t6\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"t2\".\"ID\" AS \"ID0\", \"t4\".\"MOVIE_ID\", MIN(\"t4\".\"rating\") AS \"rating\"\r\nFROM (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'rating'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" LIKE '%sequel%'\r\nGROUP BY \"ID\") AS \"t2\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\", MIN(\"INFO\") AS \"rating\"\r\nFROM \"MOVIE_INFO_IDX\"\r\nWHERE \"INFO\" > '2.0'\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t4\"\r\nWHERE \"t0\".\"ID\" = \"t4\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t2\".\"ID\", \"t4\".\"MOVIE_ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t7\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t6\".\"ID0\" = \"t7\".\"KEYWORD_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":2.7213}],"num_rewrites":5,"raw_query":"SELECT     MIN(mi_idx.info) AS rating,     MIN(t.title) AS movie_title FROM     info_type AS it,     keyword AS k,     movie_info_idx AS mi_idx,     movie_keyword AS mk,     title AS t WHERE     it.info = 'rating'     AND k.keyword like '%sequel%'     AND mi_idx.info > '2.0'     AND t.production_year > 1990     AND t.id = mi_idx.movie_id     AND t.id = mk.movie_id     AND mk.movie_id = mi_idx.movie_id     AND k.id = mk.keyword_id     AND it.id = mi_idx.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"typical_european_movie\") AS \"typical_european_movie\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(theatrical)%' AND \"NOTE\" LIKE '%(France)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"typical_european_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID0\" = \"t9\".\"ID\"","rewrite_time":3.1003},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"typical_european_movie\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(theatrical)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(France)%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR \"MOVIE_INFO\".\"INFO\" = 'Denmark') OR (\"MOVIE_INFO\".\"INFO\" = 'Swedish' OR \"MOVIE_INFO\".\"INFO\" = 'Denish' OR (\"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR \"MOVIE_INFO\".\"INFO\" = 'German'))) AND \"TITLE\".\"PRODUCTION_YEAR\" > 2005)) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\")))","rewrite_time":0.9209},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"TITLE\") AS \"typical_european_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n\"INFO_TYPE\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(theatrical)%' AND \"NOTE\" LIKE '%(France)%') AS \"t0\"\r\nWHERE \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID0\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"t4\".\"ID\"","rewrite_time":2.4441},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"typical_european_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN \"INFO_TYPE\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(theatrical)%' AND \"NOTE\" LIKE '%(France)%') AS \"t0\" ON \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.1819},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t11\".\"typical_european_movie\") AS \"typical_european_movie\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(theatrical)%' AND \"NOTE\" LIKE '%(France)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"typical_european_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2005\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":2.921}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS typical_european_movie FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info AS mi,     title AS t WHERE     ct.kind = 'production companies'     AND mc.note like '%(theatrical)%'     and mc.note like '%(France)%'     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Denish',         'Norwegian',         'German'     )     AND t.production_year > 2005     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND mc.movie_id = mi.movie_id     AND ct.id = mc.company_type_id     AND it.id = mi.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"american_vhs_movie\") AS \"american_vhs_movie\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(VHS)%' AND \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" LIKE '%(1994)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('America', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_vhs_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID0\" = \"t9\".\"ID\"","rewrite_time":2.9494},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"american_vhs_movie\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(VHS)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(1994)%' AND (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'America'))) AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\")))","rewrite_time":0.9003},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"TITLE\") AS \"american_vhs_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n\"INFO_TYPE\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(VHS)%' AND \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" LIKE '%(1994)%') AS \"t0\"\r\nWHERE \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('America', 'USA')) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID0\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"t4\".\"ID\"","rewrite_time":2.3434},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"american_vhs_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN \"INFO_TYPE\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(VHS)%' AND \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" LIKE '%(1994)%') AS \"t0\" ON \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('America', 'USA')) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.3747},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t11\".\"american_vhs_movie\") AS \"american_vhs_movie\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(VHS)%' AND \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" LIKE '%(1994)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('America', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_vhs_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":3.0383}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS american_vhs_movie FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info AS mi,     title AS t WHERE     ct.kind = 'production companies'     AND mc.note like '%(VHS)%'     and mc.note like '%(USA)%'     and mc.note like '%(1994)%'     AND mi.info IN ('USA', 'America')     AND t.production_year > 2010     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND mc.movie_id = mi.movie_id     AND ct.id = mc.company_type_id     AND it.id = mi.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t9\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" NOT LIKE '%(TV)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\" ON \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t4\".\"ID0\" = \"t6\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID0\" = \"t9\".\"ID\"","rewrite_time":3.155},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"COMPANY_TYPE\",\r\n\"INFO_TYPE\",\r\n\"MOVIE_COMPANIES\",\r\n\"MOVIE_INFO\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_TYPE\".\"KIND\" = 'production companies' AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(TV)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' AND ((\"MOVIE_INFO\".\"INFO\" = 'Sweden' OR \"MOVIE_INFO\".\"INFO\" = 'Norway' OR (\"MOVIE_INFO\".\"INFO\" = 'Germany' OR (\"MOVIE_INFO\".\"INFO\" = 'Denmark' OR \"MOVIE_INFO\".\"INFO\" = 'Swedish')) OR (\"MOVIE_INFO\".\"INFO\" = 'Denish' OR \"MOVIE_INFO\".\"INFO\" = 'Norwegian' OR (\"MOVIE_INFO\".\"INFO\" = 'German' OR (\"MOVIE_INFO\".\"INFO\" = 'USA' OR \"MOVIE_INFO\".\"INFO\" = 'American')))) AND \"TITLE\".\"PRODUCTION_YEAR\" > 1990)) AND (\"TITLE\".\"ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"MOVIE_ID\" = \"MOVIE_INFO\".\"MOVIE_ID\" AND (\"COMPANY_TYPE\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_TYPE_ID\" AND \"INFO_TYPE\".\"ID\" = \"MOVIE_INFO\".\"INFO_TYPE_ID\")))","rewrite_time":0.9316},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"TITLE\") AS \"american_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\",\r\n\"INFO_TYPE\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" NOT LIKE '%(TV)%') AS \"t0\"\r\nWHERE \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t1\".\"ID0\" = \"t2\".\"INFO_TYPE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t4\"\r\nWHERE \"t3\".\"MOVIE_ID0\" = \"t4\".\"ID\"","rewrite_time":2.2827},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"TITLE\") AS \"american_movie\"\r\nFROM (SELECT *\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies') AS \"t\"\r\nCROSS JOIN \"INFO_TYPE\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" NOT LIKE '%(TV)%') AS \"t0\" ON \"t\".\"ID\" = \"t0\".\"COMPANY_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')) AS \"t1\" ON \"t0\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"INFO_TYPE\".\"ID\" = \"t1\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990) AS \"t2\" ON \"t1\".\"MOVIE_ID\" = \"t2\".\"ID\"","rewrite_time":2.1612},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t11\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\"\r\nFROM (SELECT \"t1\".\"ID\" AS \"ID0\", \"t3\".\"MOVIE_ID\"\r\nFROM (SELECT \"ID\"\r\nFROM \"COMPANY_TYPE\"\r\nWHERE \"KIND\" = 'production companies'\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_TYPE_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' AND \"NOTE\" NOT LIKE '%(TV)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_TYPE_ID\") AS \"t3\"\r\nWHERE \"t0\".\"ID\" = \"t3\".\"COMPANY_TYPE_ID\"\r\nGROUP BY \"t1\".\"ID\", \"t3\".\"MOVIE_ID\") AS \"t5\",\r\n(SELECT \"INFO_TYPE_ID\", \"MOVIE_ID\"\r\nFROM \"MOVIE_INFO\"\r\nWHERE \"INFO\" IN ('American', 'Denish', 'Denmark', 'German', 'Germany', 'Norway', 'Norwegian', 'Sweden', 'Swedish', 'USA')\r\nGROUP BY \"INFO_TYPE_ID\", \"MOVIE_ID\") AS \"t7\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID0\" = \"t7\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 1990\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"MOVIE_ID0\" = \"t11\".\"ID\"","rewrite_time":2.9688}],"num_rewrites":5,"raw_query":"SELECT     MIN(t.title) AS american_movie FROM     company_type AS ct,     info_type AS it,     movie_companies AS mc,     movie_info AS mi,     title AS t WHERE     ct.kind = 'production companies'     AND mc.note not like '%(TV)%'     and mc.note like '%(USA)%'     AND mi.info IN (         'Sweden',         'Norway',         'Germany',         'Denmark',         'Swedish',         'Denish',         'Norwegian',         'German',         'USA',         'American'     )     AND t.production_year > 1990     AND t.id = mi.movie_id     AND t.id = mc.movie_id     AND mc.movie_id = mi.movie_id     AND ct.id = mc.company_type_id     AND it.id = mi.info_type_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\", MIN(\"t8\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":3.0894},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'marvel-cinematic-universe' AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2010 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":1.1591},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t2\".\"NAME\") AS \"actor_name\", MIN(\"t3\".\"TITLE\") AS \"marvel_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"ID\"","rewrite_time":2.3691},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t0\".\"NAME\") AS \"actor_name\", MIN(\"t1\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010) AS \"t1\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":2.111},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t8\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t8\".\"actor_name\") AS \"actor_name\", MIN(\"t10\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2010\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":2.7744}],"num_rewrites":5,"raw_query":"SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2010 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\", MIN(\"t8\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":3.0644},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'sequel' OR (\"KEYWORD\".\"KEYWORD\" = 'second-part' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics') OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'tv-special' OR (\"KEYWORD\".\"KEYWORD\" = 'fight' OR \"KEYWORD\".\"KEYWORD\" = 'violence'))) AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2014 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":1.0475},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t2\".\"NAME\") AS \"actor_name\", MIN(\"t3\".\"TITLE\") AS \"hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014) AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"ID\"","rewrite_time":2.3153},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t0\".\"NAME\") AS \"actor_name\", MIN(\"t1\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014) AS \"t1\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":2.2801},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t8\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t8\".\"actor_name\") AS \"actor_name\", MIN(\"t10\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":2.8438}],"num_rewrites":5,"raw_query":"SELECT     MIN(k.keyword) AS movie_keyword,     MIN(n.name) AS actor_name,     MIN(t.title) AS hero_movie FROM     cast_info AS ci,     keyword AS k,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword in (         'superhero',         'sequel',         'second-part',         'marvel-comics',         'based-on-comic',         'tv-special',         'fight',         'violence'     )     AND n.name LIKE '%Downey%Robert%'     AND t.production_year > 2014     AND k.id = mk.keyword_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mk.movie_id     AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\", MIN(\"t8\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":2.7894},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'marvel-cinematic-universe' AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2014 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":0.8572},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t2\".\"NAME\") AS \"actor_name\", MIN(\"t3\".\"TITLE\") AS \"marvel_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014) AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"ID\"","rewrite_time":2.1064},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t0\".\"NAME\") AS \"actor_name\", MIN(\"t1\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014) AS \"t1\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":1.9322},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t8\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t8\".\"actor_name\") AS \"actor_name\", MIN(\"t10\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2014\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":2.7781}],"num_rewrites":5,"raw_query":"SELECT     MIN(k.keyword) AS movie_keyword,     MIN(n.name) AS actor_name,     MIN(t.title) AS marvel_movie FROM     cast_info AS ci,     keyword AS k,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword = 'marvel-cinematic-universe'     AND n.name LIKE '%Downey%Robert%'     AND t.production_year > 2014     AND k.id = mk.keyword_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mk.movie_id     AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\", MIN(\"t8\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":2.8834},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'sequel' OR (\"KEYWORD\".\"KEYWORD\" = 'second-part' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics') OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'tv-special' OR (\"KEYWORD\".\"KEYWORD\" = 'fight' OR \"KEYWORD\".\"KEYWORD\" = 'violence'))) AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":0.9245},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t2\".\"NAME\") AS \"actor_name\", MIN(\"t3\".\"TITLE\") AS \"hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"ID\"","rewrite_time":2.339},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t0\".\"NAME\") AS \"actor_name\", MIN(\"t1\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t1\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":2.3387},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t8\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t8\".\"actor_name\") AS \"actor_name\", MIN(\"t10\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":4.5514}],"num_rewrites":5,"raw_query":"SELECT     MIN(k.keyword) AS movie_keyword,     MIN(n.name) AS actor_name,     MIN(t.title) AS hero_movie FROM     cast_info AS ci,     keyword AS k,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword in (         'superhero',         'sequel',         'second-part',         'marvel-comics',         'based-on-comic',         'tv-special',         'fight',         'violence'     )     AND n.name LIKE '%Downey%Robert%'     AND t.production_year > 2000     AND k.id = mk.keyword_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mk.movie_id     AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\", MIN(\"t8\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t5\" ON \"t3\".\"PERSON_ID\" = \"t5\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t8\" ON \"t6\".\"MOVIE_ID0\" = \"t8\".\"ID\"","rewrite_time":2.7769},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE \"KEYWORD\".\"KEYWORD\" = 'marvel-cinematic-universe' AND \"NAME\".\"NAME\" LIKE '%Downey%Robert%' AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":0.8911},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t2\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t2\".\"NAME\") AS \"actor_name\", MIN(\"t3\".\"TITLE\") AS \"marvel_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t1\"\r\nWHERE \"t1\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t3\"\r\nWHERE \"t2\".\"MOVIE_ID0\" = \"t3\".\"ID\"","rewrite_time":2.2894},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t0\".\"NAME\") AS \"actor_name\", MIN(\"t1\".\"TITLE\") AS \"marvel_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe') AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%') AS \"t0\" ON \"CAST_INFO\".\"PERSON_ID\" = \"t0\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t1\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t1\".\"ID\"","rewrite_time":2.363},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t8\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t8\".\"actor_name\") AS \"actor_name\", MIN(\"t10\".\"marvel_movie\") AS \"marvel_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t6\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" = 'marvel-cinematic-universe'\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Downey%Robert%'\r\nGROUP BY \"ID\") AS \"t6\"\r\nWHERE \"t6\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t8\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"marvel_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID0\" = \"t10\".\"ID\"","rewrite_time":2.7249}],"num_rewrites":5,"raw_query":"SELECT     MIN(k.keyword) AS movie_keyword,     MIN(n.name) AS actor_name,     MIN(t.title) AS marvel_movie FROM     cast_info AS ci,     keyword AS k,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword = 'marvel-cinematic-universe'     AND n.name LIKE '%Downey%Robert%'     AND t.production_year > 2000     AND k.id = mk.keyword_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mk.movie_id     AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t5\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\", MIN(\"t7\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t3\".\"MOVIE_ID0\", MIN(\"t3\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t4\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\" ON \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t4\" ON \"t3\".\"PERSON_ID\" = \"t4\".\"ID\"\r\nGROUP BY \"t3\".\"MOVIE_ID0\") AS \"t5\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t7\" ON \"t5\".\"MOVIE_ID0\" = \"t7\".\"ID\"","rewrite_time":2.8946},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"KEYWORD\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"TITLE\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\",\r\n\"KEYWORD\",\r\n\"MOVIE_KEYWORD\",\r\n\"NAME\",\r\n\"TITLE\"\r\nWHERE (\"KEYWORD\".\"KEYWORD\" = 'superhero' OR \"KEYWORD\".\"KEYWORD\" = 'sequel' OR (\"KEYWORD\".\"KEYWORD\" = 'second-part' OR \"KEYWORD\".\"KEYWORD\" = 'marvel-comics') OR (\"KEYWORD\".\"KEYWORD\" = 'based-on-comic' OR \"KEYWORD\".\"KEYWORD\" = 'tv-special' OR (\"KEYWORD\".\"KEYWORD\" = 'fight' OR \"KEYWORD\".\"KEYWORD\" = 'violence'))) AND (\"TITLE\".\"PRODUCTION_YEAR\" > 2000 AND \"KEYWORD\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\") AND (\"TITLE\".\"ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\"))","rewrite_time":1.0003},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t1\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"t1\".\"NAME\") AS \"actor_name\", MIN(\"t2\".\"TITLE\") AS \"hero_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"CAST_INFO\",\r\n(SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\",\r\n\"MOVIE_KEYWORD\"\r\nWHERE \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\") AS \"t0\",\r\n\"NAME\"\r\nWHERE \"NAME\".\"ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t2\"\r\nWHERE \"t1\".\"MOVIE_ID0\" = \"t2\".\"ID\"","rewrite_time":2.1049},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t\".\"KEYWORD\") AS \"movie_keyword\", MIN(\"NAME\".\"NAME\") AS \"actor_name\", MIN(\"t0\".\"TITLE\") AS \"hero_movie\"\r\nFROM \"CAST_INFO\"\r\nCROSS JOIN (SELECT *\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')) AS \"t\"\r\nINNER JOIN \"MOVIE_KEYWORD\" ON \"t\".\"ID\" = \"MOVIE_KEYWORD\".\"KEYWORD_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_KEYWORD\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000) AS \"t0\" ON \"MOVIE_KEYWORD\".\"MOVIE_ID\" = \"t0\".\"ID\"","rewrite_time":2.1826},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t7\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t7\".\"actor_name\") AS \"actor_name\", MIN(\"t9\".\"hero_movie\") AS \"hero_movie\"\r\nFROM (SELECT \"t4\".\"MOVIE_ID0\", MIN(\"t4\".\"movie_keyword\") AS \"movie_keyword\", MIN(\"t5\".\"actor_name\") AS \"actor_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID0\", MIN(\"t1\".\"movie_keyword\") AS \"movie_keyword\"\r\nFROM (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"KEYWORD\") AS \"movie_keyword\"\r\nFROM \"KEYWORD\"\r\nWHERE \"KEYWORD\" IN ('based-on-comic', 'fight', 'marvel-comics', 'second-part', 'sequel', 'superhero', 'tv-special', 'violence')\r\nGROUP BY \"ID\") AS \"t1\",\r\n(SELECT \"MOVIE_ID\", \"KEYWORD_ID\"\r\nFROM \"MOVIE_KEYWORD\"\r\nGROUP BY \"MOVIE_ID\", \"KEYWORD_ID\") AS \"t2\"\r\nWHERE \"t1\".\"ID\" = \"t2\".\"KEYWORD_ID\" AND \"t\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\") AS \"t4\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"actor_name\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t5\"\r\nWHERE \"t5\".\"ID\" = \"t4\".\"PERSON_ID\"\r\nGROUP BY \"t4\".\"MOVIE_ID0\") AS \"t7\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"hero_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" > 2000\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t7\".\"MOVIE_ID0\" = \"t9\".\"ID\"","rewrite_time":2.8149}],"num_rewrites":5,"raw_query":"SELECT     MIN(k.keyword) AS movie_keyword,     MIN(n.name) AS actor_name,     MIN(t.title) AS hero_movie FROM     cast_info AS ci,     keyword AS k,     movie_keyword AS mk,     name AS n,     title AS t WHERE     k.keyword in (         'superhero',         'sequel',         'second-part',         'marvel-comics',         'based-on-comic',         'tv-special',         'fight',         'violence'     )     AND t.production_year > 2000     AND k.id = mk.keyword_id     AND t.id = mk.movie_id     AND t.id = ci.movie_id     AND ci.movie_id = mk.movie_id     AND n.id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"of_person\") AS \"of_person\", MIN(\"t16\".\"biography_movie\") AS \"biography_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\" AS \"ID0\", MIN(\"t10\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\" ON \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"LINK_TYPE_ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"of_person\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'B%')\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm'\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t13\" ON \"t11\".\"ID0\" = \"t13\".\"PERSON_ID\" AND \"t11\".\"ID\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"biography_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1995\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":7.2655},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"of_person\", MIN(\"TITLE\".\"TITLE\") AS \"biography_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_LINK\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"TITLE\"\r\nWHERE \"AKA_NAME\".\"NAME\" LIKE '%a%' AND \"INFO_TYPE\".\"INFO\" = 'mini biography' AND (\"LINK_TYPE\".\"LINK\" = 'features' AND (\"NAME\".\"NAME_PCODE_CF\" >= 'A' AND \"NAME\".\"NAME_PCODE_CF\" <= 'F')) AND ((\"NAME\".\"GENDER\" = 'm' OR \"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE 'B%') AND \"PERSON_INFO\".\"NOTE\" = 'Volker Boehm' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 1980 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 1995 AND \"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\"))) AND (\"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE\".\"ID\" AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\")) AND (\"INFO_TYPE\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\" AND \"PERSON_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"PERSON_INFO\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"))))","rewrite_time":1.7472},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME0\") AS \"of_person\", MIN(\"t8\".\"TITLE\") AS \"biography_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%') AS \"t\",\r\n\"CAST_INFO\"\r\nWHERE \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t1\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features') AS \"t2\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t2\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'B%')) AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm') AS \"t6\"\r\nWHERE \"t5\".\"ID4\" = \"t6\".\"PERSON_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1995) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.8919},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"NAME\") AS \"of_person\", MIN(\"t4\".\"TITLE\") AS \"biography_movie\"\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%') AS \"t\"\r\nINNER JOIN \"CAST_INFO\" ON \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features') AS \"t1\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t1\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'B%')) AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm') AS \"t3\" ON \"t2\".\"ID\" = \"t3\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1995) AS \"t4\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.3603},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"of_person\") AS \"of_person\", MIN(\"t20\".\"biography_movie\") AS \"biography_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\" AS \"ID0\", MIN(\"t12\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\"\r\nWHERE \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t8\"\r\nWHERE \"t7\".\"ID\" = \"t8\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID\" = \"t8\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"of_person\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'B%')\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm'\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID0\" = \"t16\".\"PERSON_ID\" AND \"t14\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"biography_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1995\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":6.4577}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS of_person,     MIN(t.title) AS biography_movie FROM     aka_name AS an,     cast_info AS ci,     info_type AS it,     link_type AS lt,     movie_link AS ml,     name AS n,     person_info AS pi,     title AS t WHERE     an.name LIKE '%a%'     AND it.info = 'mini biography'     AND lt.link = 'features'     AND n.name_pcode_cf BETWEEN 'A'     AND 'F'     AND (         n.gender = 'm'         OR (             n.gender = 'f'             AND n.name LIKE 'B%'         )     )     AND pi.note = 'Volker Boehm'     AND t.production_year BETWEEN 1980     AND 1995     AND n.id = an.person_id     AND n.id = pi.person_id     AND ci.person_id = n.id     AND t.id = ci.movie_id     AND ml.linked_movie_id = t.id     AND lt.id = ml.link_type_id     AND it.id = pi.info_type_id     AND pi.person_id = an.person_id     AND pi.person_id = ci.person_id     AND an.person_id = ci.person_id     AND ci.movie_id = ml.linked_movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t14\".\"of_person\") AS \"of_person\", MIN(\"t16\".\"biography_movie\") AS \"biography_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\" AS \"ID0\", MIN(\"t10\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\" ON \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"LINK_TYPE_ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"of_person\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" LIKE 'D%' AND \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm'\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t13\" ON \"t11\".\"ID0\" = \"t13\".\"PERSON_ID\" AND \"t11\".\"ID\" = \"t13\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"biography_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1984\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.4717},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"of_person\", MIN(\"TITLE\".\"TITLE\") AS \"biography_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_LINK\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"TITLE\"\r\nWHERE \"AKA_NAME\".\"NAME\" LIKE '%a%' AND \"INFO_TYPE\".\"INFO\" = 'mini biography' AND (\"LINK_TYPE\".\"LINK\" = 'features' AND \"NAME\".\"NAME_PCODE_CF\" LIKE 'D%') AND (\"NAME\".\"GENDER\" = 'm' AND \"PERSON_INFO\".\"NOTE\" = 'Volker Boehm' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 1980 AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 1984 AND \"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\"))) AND (\"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND (\"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE\".\"ID\" AND \"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\")) AND (\"INFO_TYPE\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\" AND \"PERSON_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\" AND (\"PERSON_INFO\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"))))","rewrite_time":1.4148},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME0\") AS \"of_person\", MIN(\"t8\".\"TITLE\") AS \"biography_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%') AS \"t\",\r\n\"CAST_INFO\"\r\nWHERE \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t1\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features') AS \"t2\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t2\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" LIKE 'D%' AND \"GENDER\" = 'm') AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm') AS \"t6\"\r\nWHERE \"t5\".\"ID4\" = \"t6\".\"PERSON_ID\" AND \"t5\".\"ID1\" = \"t6\".\"INFO_TYPE_ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1984) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.0175},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"NAME\") AS \"of_person\", MIN(\"t4\".\"TITLE\") AS \"biography_movie\"\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%') AS \"t\"\r\nINNER JOIN \"CAST_INFO\" ON \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features') AS \"t1\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t1\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" LIKE 'D%' AND \"GENDER\" = 'm') AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm') AS \"t3\" ON \"t2\".\"ID\" = \"t3\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"t3\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1984) AS \"t4\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":3.5717},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"of_person\") AS \"of_person\", MIN(\"t20\".\"biography_movie\") AS \"biography_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\" AS \"ID0\", MIN(\"t12\".\"of_person\") AS \"of_person\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\"\r\nWHERE \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" = 'features'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t8\"\r\nWHERE \"t7\".\"ID\" = \"t8\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID\" = \"t8\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"of_person\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" LIKE 'D%' AND \"GENDER\" = 'm'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\"\r\nFROM \"PERSON_INFO\"\r\nWHERE \"NOTE\" = 'Volker Boehm'\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t16\"\r\nWHERE \"t14\".\"ID0\" = \"t16\".\"PERSON_ID\" AND \"t14\".\"ID\" = \"t16\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"biography_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 1984\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.603}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS of_person,     MIN(t.title) AS biography_movie FROM     aka_name AS an,     cast_info AS ci,     info_type AS it,     link_type AS lt,     movie_link AS ml,     name AS n,     person_info AS pi,     title AS t WHERE     an.name LIKE '%a%'     AND it.info = 'mini biography'     AND lt.link = 'features'     AND n.name_pcode_cf LIKE 'D%'     AND n.gender = 'm'     AND pi.note = 'Volker Boehm'     AND t.production_year BETWEEN 1980     AND 1984     AND n.id = an.person_id     AND n.id = pi.person_id     AND ci.person_id = n.id     AND t.id = ci.movie_id     AND ml.linked_movie_id = t.id     AND lt.id = ml.link_type_id     AND it.id = pi.info_type_id     AND pi.person_id = an.person_id     AND pi.person_id = ci.person_id     AND an.person_id = ci.person_id     AND ci.movie_id = ml.linked_movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t13\".\"cast_member_name\") AS \"cast_member_name\", MIN(\"t13\".\"cast_member_info\") AS \"cast_member_info\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"cast_member_name\") AS \"cast_member_name\", MIN(\"t12\".\"cast_member_info\") AS \"cast_member_info\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\" AS \"ID0\", MIN(\"t10\".\"cast_member_name\") AS \"cast_member_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%' OR \"NAME\" LIKE 'A%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\" ON \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('featured in', 'features', 'referenced in', 'references')\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t7\" ON \"t6\".\"ID\" = \"t7\".\"LINK_TYPE_ID\" AND \"t2\".\"MOVIE_ID\" = \"t7\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t4\".\"ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"cast_member_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'A%')\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ID\", \"t10\".\"ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"INFO_TYPE_ID\", \"PERSON_ID\", MIN(\"INFO\") AS \"cast_member_info\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t12\" ON \"t11\".\"ID0\" = \"t12\".\"PERSON_ID\" AND \"t11\".\"ID\" = \"t12\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":6.8335},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"NAME\".\"NAME\") AS \"cast_member_name\", MIN(\"PERSON_INFO\".\"INFO\") AS \"cast_member_info\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"INFO_TYPE\",\r\n\"LINK_TYPE\",\r\n\"MOVIE_LINK\",\r\n\"NAME\",\r\n\"PERSON_INFO\",\r\n\"TITLE\"\r\nWHERE \"AKA_NAME\".\"NAME\" IS NOT NULL AND (\"AKA_NAME\".\"NAME\" LIKE '%a%' OR \"AKA_NAME\".\"NAME\" LIKE 'A%') AND (\"INFO_TYPE\".\"INFO\" = 'mini biography' AND ((\"LINK_TYPE\".\"LINK\" = 'references' OR \"LINK_TYPE\".\"LINK\" = 'referenced in' OR \"LINK_TYPE\".\"LINK\" = 'features' OR \"LINK_TYPE\".\"LINK\" = 'featured in') AND \"NAME\".\"NAME_PCODE_CF\" >= 'A')) AND (\"NAME\".\"NAME_PCODE_CF\" <= 'F' AND (\"NAME\".\"GENDER\" = 'm' OR \"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE 'A%') AND (\"PERSON_INFO\".\"NOTE\" IS NOT NULL AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 1980 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2010))) AND (\"NAME\".\"ID\" = \"AKA_NAME\".\"PERSON_ID\" AND \"NAME\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"TITLE\".\"ID\" = \"CAST_INFO\".\"MOVIE_ID\" AND \"MOVIE_LINK\".\"LINKED_MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"LINK_TYPE\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND (\"INFO_TYPE\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\" AND \"PERSON_INFO\".\"PERSON_ID\" = \"AKA_NAME\".\"PERSON_ID\") AND (\"PERSON_INFO\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"))))","rewrite_time":1.7085},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME0\") AS \"cast_member_name\", MIN(\"t6\".\"INFO0\") AS \"cast_member_info\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%' OR \"NAME\" LIKE 'A%') AS \"t\",\r\n\"CAST_INFO\"\r\nWHERE \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t1\",\r\n(SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('featured in', 'features', 'referenced in', 'references')) AS \"t2\",\r\n\"MOVIE_LINK\"\r\nWHERE \"t2\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"t0\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'A%')) AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"t4\".\"ID\") AS \"t5\",\r\n\"PERSON_INFO\"\r\nWHERE \"t5\".\"ID4\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t5\".\"ID1\" = \"PERSON_INFO\".\"INFO_TYPE_ID\") AS \"t6\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t7\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"t7\".\"ID\"","rewrite_time":4.9236},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"t2\".\"NAME\") AS \"cast_member_name\", MIN(\"PERSON_INFO\".\"INFO\") AS \"cast_member_info\"\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%' OR \"NAME\" LIKE 'A%') AS \"t\"\r\nINNER JOIN \"CAST_INFO\" ON \"t\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography') AS \"t0\"\r\nCROSS JOIN (SELECT *\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('featured in', 'features', 'referenced in', 'references')) AS \"t1\"\r\nINNER JOIN \"MOVIE_LINK\" ON \"t1\".\"ID\" = \"MOVIE_LINK\".\"LINK_TYPE_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_LINK\".\"LINKED_MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'A%')) AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN \"PERSON_INFO\" ON \"t2\".\"ID\" = \"PERSON_INFO\".\"PERSON_ID\" AND \"t0\".\"ID\" = \"PERSON_INFO\".\"INFO_TYPE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t3\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"t3\".\"ID\"","rewrite_time":4.508},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"cast_member_name\") AS \"cast_member_name\", MIN(\"t17\".\"cast_member_info\") AS \"cast_member_info\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"cast_member_name\") AS \"cast_member_name\", MIN(\"t15\".\"cast_member_info\") AS \"cast_member_info\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\" AS \"ID0\", MIN(\"t12\".\"cast_member_name\") AS \"cast_member_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\"\r\nFROM (SELECT \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\"\r\nFROM (SELECT \"PERSON_ID\"\r\nFROM \"AKA_NAME\"\r\nWHERE \"NAME\" LIKE '%a%' OR \"NAME\" LIKE 'A%'\r\nGROUP BY \"PERSON_ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\") AS \"t1\"\r\nWHERE \"t0\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t0\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"INFO_TYPE\"\r\nWHERE \"INFO\" = 'mini biography'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"LINK_TYPE\"\r\nWHERE \"LINK\" IN ('featured in', 'features', 'referenced in', 'references')\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\"\r\nFROM \"MOVIE_LINK\"\r\nGROUP BY \"LINKED_MOVIE_ID\", \"LINK_TYPE_ID\") AS \"t8\"\r\nWHERE \"t7\".\"ID\" = \"t8\".\"LINK_TYPE_ID\" AND \"t3\".\"MOVIE_ID\" = \"t8\".\"LINKED_MOVIE_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t5\".\"ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"cast_member_name\"\r\nFROM \"NAME\"\r\nWHERE \"NAME_PCODE_CF\" >= 'A' AND \"NAME_PCODE_CF\" <= 'F' AND (\"GENDER\" = 'm' OR \"GENDER\" = 'f' AND \"NAME\" LIKE 'A%')\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ID\", \"t12\".\"ID\") AS \"t14\",\r\n(SELECT \"INFO_TYPE_ID\", \"PERSON_ID\", MIN(\"INFO\") AS \"cast_member_info\"\r\nFROM \"PERSON_INFO\"\r\nGROUP BY \"INFO_TYPE_ID\", \"PERSON_ID\") AS \"t15\"\r\nWHERE \"t14\".\"ID0\" = \"t15\".\"PERSON_ID\" AND \"t14\".\"ID\" = \"t15\".\"INFO_TYPE_ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 1980 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":6.8142}],"num_rewrites":5,"raw_query":"SELECT     MIN(n.name) AS cast_member_name,     MIN(pi.info) AS cast_member_info FROM     aka_name AS an,     cast_info AS ci,     info_type AS it,     link_type AS lt,     movie_link AS ml,     name AS n,     person_info AS pi,     title AS t WHERE     an.name is not NULL     and (         an.name LIKE '%a%'         or an.name LIKE 'A%'     )     AND it.info = 'mini biography'     AND lt.link in (         'references',         'referenced in',         'features',         'featured in'     )     AND n.name_pcode_cf BETWEEN 'A'     AND 'F'     AND (         n.gender = 'm'         OR (             n.gender = 'f'             AND n.name LIKE 'A%'         )     )     AND pi.note is not NULL     AND t.production_year BETWEEN 1980     AND 2010     AND n.id = an.person_id     AND n.id = pi.person_id     AND ci.person_id = n.id     AND t.id = ci.movie_id     AND ml.linked_movie_id = t.id     AND lt.id = ml.link_type_id     AND it.id = pi.info_type_id     AND pi.person_id = an.person_id     AND pi.person_id = ci.person_id     AND an.person_id = ci.person_id     AND ci.movie_id = ml.linked_movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t16\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t6\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.3507},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"actress_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" = '(voice: English version)' AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[jp]' AND \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(Japan)%') AND (\"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%' AND \"NAME\".\"NAME\" LIKE '%Yo%' AND (\"NAME\".\"NAME\" NOT LIKE '%Yu%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress')) AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.2505},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"actress_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)') AS \"t\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]') AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t2\"\r\nWHERE \"t2\".\"COMPANY_ID\" = \"t1\".\"ID\" AND \"t0\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%') AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t6\"\r\nWHERE \"t5\".\"ROLE_ID\" = \"t6\".\"ID\") AS \"t7\",\r\n\"TITLE\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.7292},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"actress_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)') AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t1\" ON \"t0\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%') AS \"t2\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t3\" ON \"t\".\"ROLE_ID\" = \"t3\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.3808},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t14\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t15\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":3.7659},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t18\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t5\".\"ID\" AND \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.2495},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t13\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t14\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"PERSON_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.047},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t14\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t15\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":4.6813},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t19\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t6\".\"ID\" AND \"t6\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":5.356},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t14\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t15\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\" ON \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":5.2318},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t19\".\"actress_pseudonym\") AS \"actress_pseudonym\", MIN(\"t20\".\"japanese_movie_dubbed\") AS \"japanese_movie_dubbed\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"actress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"actress_pseudonym\") AS \"actress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"actress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_movie_dubbed\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.4237}],"num_rewrites":11,"raw_query":"SELECT     MIN(an1.name) AS actress_pseudonym,     MIN(t.title) AS japanese_movie_dubbed FROM     aka_name AS an1,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n1,     role_type AS rt,     title AS t WHERE     ci.note = '(voice: English version)'     AND cn.country_code = '[jp]'     AND mc.note like '%(Japan)%'     and mc.note not like '%(USA)%'     AND n1.name like '%Yo%'     and n1.name not like '%Yu%'     AND rt.role = 'actress'     AND an1.person_id = n1.id     AND n1.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND an1.person_id = ci.person_id     AND ci.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t17\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t6\".\"ID\" = \"t8\".\"COMPANY_ID\" AND \"t6\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":6.0054},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"acress_pseudonym\", MIN(\"TITLE\".\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" = '(voice: English version)' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[jp]' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(Japan)%' AND \"MOVIE_COMPANIES\".\"NOTE\" NOT LIKE '%(USA)%') AND ((\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(2006)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(2007)%') AND \"NAME\".\"NAME\" LIKE '%Yo%' AND (\"NAME\".\"NAME\" NOT LIKE '%Yu%' AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND \"TITLE\".\"PRODUCTION_YEAR\" >= 2006))) AND (\"TITLE\".\"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\".\"TITLE\" LIKE 'One Piece%' OR \"TITLE\".\"TITLE\" LIKE 'Dragon Ball %') AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"))))","rewrite_time":1.6353},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"acress_pseudonym\", MIN(\"t8\".\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)') AS \"t\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]') AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t2\"\r\nWHERE \"t2\".\"COMPANY_ID\" = \"t1\".\"ID\" AND \"t0\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%') AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t6\"\r\nWHERE \"t5\".\"ROLE_ID\" = \"t6\".\"ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.4613},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"acress_pseudonym\", MIN(\"t4\".\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)') AS \"t\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%') AS \"t1\" ON \"t0\".\"ID\" = \"t1\".\"COMPANY_ID\" AND \"t\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%') AS \"t2\" ON \"AKA_NAME\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t3\" ON \"t\".\"ROLE_ID\" = \"t3\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')) AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":3.8829},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t14\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t16\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":4.47},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t19\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t5\".\"ID\" AND \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"PERSON_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t19\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t19\".\"ID\"","rewrite_time":6.1933},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t13\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t15\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t4\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"PERSON_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":6.0118},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t14\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t16\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.5273},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t18\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t20\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", MIN(\"t2\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t8\".\"COMPANY_ID\" = \"t6\".\"ID\" AND \"t6\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":6.0727},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t14\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t16\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":6.0538},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t19\".\"acress_pseudonym\") AS \"acress_pseudonym\", MIN(\"t21\".\"japanese_anime_movie\") AS \"japanese_anime_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"acress_pseudonym\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t\".\"acress_pseudonym\") AS \"acress_pseudonym\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"acress_pseudonym\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice: English version)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t1\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t1\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[jp]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(Japan)%' AND (\"NOTE\" LIKE '%(2006)%' OR \"NOTE\" LIKE '%(2007)%') AND \"NOTE\" NOT LIKE '%(USA)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\" AND \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"NAME\" LIKE '%Yo%' AND \"NAME\" NOT LIKE '%Yu%'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"japanese_anime_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2006 AND \"PRODUCTION_YEAR\" <= 2007 AND (\"TITLE\" LIKE 'One Piece%' OR \"TITLE\" LIKE 'Dragon Ball %')\r\nGROUP BY \"ID\") AS \"t21\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t21\".\"ID\"","rewrite_time":6.1605}],"num_rewrites":11,"raw_query":"SELECT     MIN(an.name) AS acress_pseudonym,     MIN(t.title) AS japanese_anime_movie FROM     aka_name AS an,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note = '(voice: English version)'     AND cn.country_code = '[jp]'     AND mc.note like '%(Japan)%'     and mc.note not like '%(USA)%'     and (         mc.note like '%(2006)%'         or mc.note like '%(2007)%'     )     AND n.name like '%Yo%'     and n.name not like '%Yu%'     AND rt.role = 'actress'     AND t.production_year between 2006     and 2007     and (         t.title like 'One Piece%'         or t.title like 'Dragon Ball %'     )     AND an.person_id = n.id     AND n.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND an.person_id = ci.person_id     AND ci.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t13\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t5\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":4.5313},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"writer_pseudo_name\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"ROLE_TYPE\".\"ROLE\" = 'writer' AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.1653},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"writer_pseudo_name\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t1\",\r\n\"NAME\"\r\nWHERE \"t1\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer') AS \"t3\"\r\nWHERE \"t2\".\"ROLE_ID\" = \"t3\".\"ID\") AS \"t4\",\r\n\"TITLE\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.0017},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"writer_pseudo_name\", MIN(\"TITLE\".\"TITLE\") AS \"movie_title\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer') AS \"t0\" ON \"CAST_INFO\".\"ROLE_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.0056},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t11\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t12\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", \"t1\".\"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\" ON \"t4\".\"ID\" = \"t5\".\"COMPANY_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":3.056},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t15\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\"\r\nWHERE \"t5\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nWHERE \"t7\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":7.5459},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t10\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t11\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t1\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\" ON \"t3\".\"ID\" = \"t4\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t6\" ON \"t5\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":4.2538},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t11\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t12\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", \"t2\".\"ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\" ON \"t4\".\"ID\" = \"t5\".\"COMPANY_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":4.0835},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t16\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t5\".\"ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"PERSON_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":4.7569},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t11\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t12\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t1\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\"\r\nWHERE \"t4\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":4.3762},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t16\".\"writer_pseudo_name\") AS \"writer_pseudo_name\", MIN(\"t17\".\"movie_title\") AS \"movie_title\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"writer_pseudo_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"writer_pseudo_name\") AS \"writer_pseudo_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"writer_pseudo_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t6\".\"ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'writer'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_title\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":4.2611}],"num_rewrites":11,"raw_query":"SELECT     MIN(a1.name) AS writer_pseudo_name,     MIN(t.title) AS movie_title FROM     aka_name AS a1,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n1,     role_type AS rt,     title AS t WHERE     cn.country_code = '[us]'     AND rt.role = 'writer'     AND a1.person_id = n1.id     AND n1.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND a1.person_id = ci.person_id     AND ci.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t12\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t13\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", MIN(\"t9\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", \"t4\".\"ID\", \"t2\".\"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t5\".\"ID\" = \"t6\".\"COMPANY_ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t8\" ON \"t7\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"ROLE_ID\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"ID\"","rewrite_time":4.3427},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"costume_designer_pseudo\", MIN(\"TITLE\".\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"ROLE_TYPE\".\"ROLE\" = 'costume designer' AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\")) AND (\"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND (\"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")))","rewrite_time":1.0336},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t4\".\"NAME\") AS \"costume_designer_pseudo\", MIN(\"TITLE\".\"TITLE\") AS \"movie_with_costumes\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CAST_INFO\"\r\nWHERE \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\") AS \"t\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t0\".\"ID\" AND \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\") AS \"t1\",\r\n\"NAME\"\r\nWHERE \"t1\".\"PERSON_ID\" = \"NAME\".\"ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer') AS \"t3\"\r\nWHERE \"t2\".\"ROLE_ID\" = \"t3\".\"ID\") AS \"t4\",\r\n\"TITLE\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":4.0984},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"costume_designer_pseudo\", MIN(\"TITLE\".\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"AKA_NAME\"\r\nINNER JOIN \"CAST_INFO\" ON \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\" AND \"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\"\r\nINNER JOIN \"NAME\" ON \"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer') AS \"t0\" ON \"CAST_INFO\".\"ROLE_ID\" = \"t0\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.0866},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT MIN(\"t11\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t12\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", \"t1\".\"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\" ON \"t4\".\"ID\" = \"t5\".\"COMPANY_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":3.0325},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t14\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t15\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t2\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t2\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t4\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\"\r\nWHERE \"t5\".\"COMPANY_ID\" = \"t4\".\"ID\" AND \"t2\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t7\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t8\"\r\nWHERE \"t7\".\"PERSON_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t14\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t14\".\"MOVIE_ID\" = \"t15\".\"ID\"","rewrite_time":4.7088},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t10\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t11\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", MIN(\"t7\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t1\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\" ON \"t3\".\"ID\" = \"t4\".\"COMPANY_ID\" AND \"t1\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t6\" ON \"t5\".\"PERSON_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"ROLE_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t11\" ON \"t10\".\"MOVIE_ID\" = \"t11\".\"ID\"","rewrite_time":4.1531},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t11\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t12\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", \"t2\".\"ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t2\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", \"t2\".\"ID\") AS \"t4\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t5\" ON \"t4\".\"ID\" = \"t5\".\"COMPANY_ID\" AND \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":3.9883},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t16\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\", MIN(\"t1\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT *\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", \"t3\".\"ID\") AS \"t5\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\"\r\nWHERE \"t6\".\"COMPANY_ID\" = \"t5\".\"ID\" AND \"t5\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\"\r\nGROUP BY \"t5\".\"PERSON_ID\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t8\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t9\"\r\nWHERE \"t8\".\"PERSON_ID\" = \"t9\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t15\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":4.9413},{"rule_order":"[rule_join, rule_cal, rule_orderby, rule_filter, rule_union, rule_agg]","rewrite_query":"SELECT MIN(\"t11\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t12\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", MIN(\"t8\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\", MIN(\"t1\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\" ON \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t1\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t3\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t4\"\r\nWHERE \"t4\".\"COMPANY_ID\" = \"t3\".\"ID\" AND \"t1\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\r\nGROUP BY \"t1\".\"PERSON_ID\", \"t1\".\"MOVIE_ID\", \"t1\".\"ROLE_ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t7\" ON \"t6\".\"PERSON_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"ROLE_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t12\" ON \"t11\".\"MOVIE_ID\" = \"t12\".\"ID\"","rewrite_time":4.4},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t16\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\", MIN(\"t17\".\"movie_with_costumes\") AS \"movie_with_costumes\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\", MIN(\"t6\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", \"t5\".\"ID\", \"t3\".\"costume_designer_pseudo\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\", MIN(\"t\".\"costume_designer_pseudo\") AS \"costume_designer_pseudo\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"costume_designer_pseudo\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"ROLE_ID\") AS \"t0\"\r\nWHERE \"t\".\"PERSON_ID\" = \"t0\".\"PERSON_ID\"\r\nGROUP BY \"t\".\"PERSON_ID\", \"t0\".\"MOVIE_ID\", \"t0\".\"ROLE_ID\") AS \"t3\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t7\".\"COMPANY_ID\" = \"t6\".\"ID\" AND \"t6\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\r\nGROUP BY \"t6\".\"PERSON_ID\", \"t6\".\"MOVIE_ID\", \"t6\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nGROUP BY \"ID\") AS \"t10\"\r\nWHERE \"t9\".\"PERSON_ID\" = \"t10\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'costume designer'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t16\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie_with_costumes\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t16\".\"MOVIE_ID\" = \"t17\".\"ID\"","rewrite_time":4.3775}],"num_rewrites":11,"raw_query":"SELECT     MIN(an1.name) AS costume_designer_pseudo,     MIN(t.title) AS movie_with_costumes FROM     aka_name AS an1,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n1,     role_type AS rt,     title AS t WHERE     cn.country_code = '[us]'     AND rt.role = 'costume designer'     AND an1.person_id = n1.id     AND n1.id = ci.person_id     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND an1.person_id = ci.person_id     AND ci.movie_id = mc.movie_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"character_name\") AS \"character_name\", MIN(\"t18\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"alternative_name\", \"t4\".\"character_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":6.2885},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"character_name\", MIN(\"TITLE\".\"TITLE\") AS \"movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"MOVIE_COMPANIES\".\"NOTE\" IS NOT NULL AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%')) AND (\"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE '%Ang%' AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2005 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2015))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"))))","rewrite_time":1.7192},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"alternative_name\", MIN(\"t7\".\"NAME0\") AS \"character_name\", MIN(\"t8\".\"TITLE\") AS \"movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%') AS \"t2\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t2\".\"COMPANY_ID\" = \"t1\".\"ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%') AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID0\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t6\"\r\nWHERE \"t5\".\"ROLE_ID\" = \"t6\".\"ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":4.689},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"character_name\", MIN(\"t4\".\"TITLE\") AS \"movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%') AS \"t1\" ON \"t\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t1\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%') AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t3\" ON \"t\".\"ROLE_ID\" = \"t3\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015) AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":4.1443},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"alternative_name\") AS \"alternative_name\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":6.0707},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"character_name\") AS \"character_name\", MIN(\"t16\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"alternative_name\") AS \"alternative_name\", MIN(\"t3\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID0\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.8888},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t18\".\"alternative_name\") AS \"alternative_name\", MIN(\"t18\".\"character_name\") AS \"character_name\", MIN(\"t20\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.4818},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t20\".\"alternative_name\") AS \"alternative_name\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t22\".\"ID\"","rewrite_time":5.9727},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"character_name\") AS \"character_name\", MIN(\"t18\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t4\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.7426},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"alternative_name\") AS \"alternative_name\", MIN(\"t20\".\"character_name\") AS \"character_name\", MIN(\"t22\".\"movie\") AS \"movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t7\".\"ID\", \"t5\".\"alternative_name\", \"t5\".\"character_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"character_name\") AS \"character_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\"\r\nWHERE \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%'\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t10\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Ang%'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2005 AND \"PRODUCTION_YEAR\" <= 2015\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t22\".\"ID\"","rewrite_time":6.1818}],"num_rewrites":10,"raw_query":"SELECT     MIN(an.name) AS alternative_name,     MIN(chn.name) AS character_name,     MIN(t.title) AS movie FROM     aka_name AS an,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note in (         '(voice)',         '(voice: Japanese version)',         '(voice) (uncredited)',         '(voice: English version)'     )     AND cn.country_code = '[us]'     AND mc.note is not NULL     and (         mc.note like '%(USA)%'         or mc.note like '%(worldwide)%'     )     AND n.gender = 'f'     and n.name like '%Ang%'     AND rt.role = 'actress'     AND t.production_year between 2005     and 2015     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND ci.movie_id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND n.id = ci.person_id     AND chn.id = ci.person_role_id     AND an.person_id = n.id     AND an.person_id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"voiced_character\") AS \"voiced_character\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_character\") AS \"voiced_character\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"voiced_character\") AS \"voiced_character\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"alternative_name\", \"t4\".\"voiced_character\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t9\".\"COMPANY_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":6.0426},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_character\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE \"CAST_INFO\".\"NOTE\" = '(voice)' AND \"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(200%)%' AND (\"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(USA)%' OR \"MOVIE_COMPANIES\".\"NOTE\" LIKE '%(worldwide)%')) AND (\"NAME\".\"GENDER\" = 'f' AND \"NAME\".\"NAME\" LIKE '%Angel%' AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"TITLE\".\"PRODUCTION_YEAR\" >= 2007 AND \"TITLE\".\"PRODUCTION_YEAR\" <= 2010))) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\") AND (\"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\" AND \"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND (\"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\"))))","rewrite_time":1.5345},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t7\".\"NAME\") AS \"alternative_name\", MIN(\"t7\".\"NAME0\") AS \"voiced_character\", MIN(\"t7\".\"NAME2\") AS \"voicing_actress\", MIN(\"t8\".\"TITLE\") AS \"american_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)') AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n(SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')) AS \"t2\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"t2\".\"MOVIE_ID\" AND \"t2\".\"COMPANY_ID\" = \"t1\".\"ID\") AS \"t3\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%') AS \"t4\"\r\nWHERE \"t3\".\"PERSON_ID0\" = \"t4\".\"ID\") AS \"t5\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t6\"\r\nWHERE \"t5\".\"ROLE_ID\" = \"t6\".\"ID\") AS \"t7\",\r\n(SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t8\"\r\nWHERE \"t7\".\"MOVIE_ID\" = \"t8\".\"ID\"","rewrite_time":7.4868},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_character\", MIN(\"t2\".\"NAME\") AS \"voicing_actress\", MIN(\"t4\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)') AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nINNER JOIN (SELECT *\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')) AS \"t1\" ON \"t\".\"MOVIE_ID\" = \"t1\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"t1\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%') AS \"t2\" ON \"t\".\"PERSON_ID\" = \"t2\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t3\" ON \"t\".\"ROLE_ID\" = \"t3\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010) AS \"t4\" ON \"t\".\"MOVIE_ID\" = \"t4\".\"ID\"","rewrite_time":5.8501},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t18\".\"alternative_name\") AS \"alternative_name\", MIN(\"t18\".\"voiced_character\") AS \"voiced_character\", MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"voiced_character\") AS \"voiced_character\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"voiced_character\") AS \"voiced_character\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t10\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t12\"\r\nWHERE \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t14\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\"\r\nWHERE \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.8919},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"voiced_character\") AS \"voiced_character\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t16\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_character\") AS \"voiced_character\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"voiced_character\") AS \"voiced_character\", MIN(\"t10\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"alternative_name\") AS \"alternative_name\", MIN(\"t3\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t3\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t8\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t10\" ON \"t8\".\"PERSON_ID0\" = \"t10\".\"ID\"\r\nGROUP BY \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"ROLE_ID\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.7275},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t18\".\"alternative_name\") AS \"alternative_name\", MIN(\"t18\".\"voiced_character\") AS \"voiced_character\", MIN(\"t18\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_character\") AS \"voiced_character\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_character\") AS \"voiced_character\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\" ON \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.4492},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t20\".\"alternative_name\") AS \"alternative_name\", MIN(\"t20\".\"voiced_character\") AS \"voiced_character\", MIN(\"t20\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t22\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"voiced_character\") AS \"voiced_character\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_character\") AS \"voiced_character\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t22\".\"ID\"","rewrite_time":5.9884},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"voiced_character\") AS \"voiced_character\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_character\") AS \"voiced_character\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"voiced_character\") AS \"voiced_character\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t4\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"PERSON_ID0\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\", \"t10\".\"ROLE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\" ON \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t16\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t18\" ON \"t16\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.4661},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t20\".\"alternative_name\") AS \"alternative_name\", MIN(\"t20\".\"voiced_character\") AS \"voiced_character\", MIN(\"t20\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t22\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t16\".\"MOVIE_ID\", MIN(\"t16\".\"alternative_name\") AS \"alternative_name\", MIN(\"t16\".\"voiced_character\") AS \"voiced_character\", MIN(\"t16\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_character\") AS \"voiced_character\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t7\".\"ID\", \"t5\".\"alternative_name\", \"t5\".\"voiced_character\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_character\") AS \"voiced_character\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_character\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" = '(voice)'\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\"\r\nWHERE \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nWHERE \"NOTE\" LIKE '%(200%)%' AND (\"NOTE\" LIKE '%(USA)%' OR \"NOTE\" LIKE '%(worldwide)%')\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t10\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\" AND \"t10\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t12\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%Angel%'\r\nGROUP BY \"ID\") AS \"t14\"\r\nWHERE \"t12\".\"PERSON_ID0\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\", \"t12\".\"ROLE_ID\") AS \"t16\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t16\".\"ROLE_ID\" = \"t18\".\"ID\"\r\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t20\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nWHERE \"PRODUCTION_YEAR\" >= 2007 AND \"PRODUCTION_YEAR\" <= 2010\r\nGROUP BY \"ID\") AS \"t22\"\r\nWHERE \"t20\".\"MOVIE_ID\" = \"t22\".\"ID\"","rewrite_time":5.9499}],"num_rewrites":10,"raw_query":"SELECT     MIN(an.name) AS alternative_name,     MIN(chn.name) AS voiced_character,     MIN(n.name) AS voicing_actress,     MIN(t.title) AS american_movie FROM     aka_name AS an,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note = '(voice)'     AND cn.country_code = '[us]'     AND mc.note like '%(200%)%'     and (         mc.note like '%(USA)%'         or mc.note like '%(worldwide)%'     )     AND n.gender = 'f'     and n.name like '%Angel%'     AND rt.role = 'actress'     AND t.production_year between 2007     and 2010     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND ci.movie_id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND n.id = ci.person_id     AND chn.id = ci.person_role_id     AND an.person_id = n.id     AND an.person_id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t16\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"alternative_name\", \"t4\".\"voiced_character_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.6786},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_character_name\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"NAME\".\"GENDER\" = 'f') AND (\"NAME\".\"NAME\" LIKE '%An%' AND \"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\") AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\")))","rewrite_time":1.4541},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME\") AS \"alternative_name\", MIN(\"t6\".\"NAME0\") AS \"voiced_character_name\", MIN(\"t6\".\"NAME2\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t1\".\"ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t3\"\r\nWHERE \"t2\".\"PERSON_ID0\" = \"t3\".\"ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\"\r\nWHERE \"t4\".\"ROLE_ID\" = \"t5\".\"ID\") AS \"t6\",\r\n\"TITLE\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":4.4266},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_character_name\", MIN(\"t1\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%') AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t2\" ON \"t\".\"ROLE_ID\" = \"t2\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.7649},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"alternative_name\") AS \"alternative_name\", MIN(\"t17\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t7\".\"COMPANY_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.8149},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t14\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t10\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t9\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"alternative_name\") AS \"alternative_name\", MIN(\"t3\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"PERSON_ID0\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":6.7791},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t17\".\"alternative_name\") AS \"alternative_name\", MIN(\"t17\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.7746},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"alternative_name\") AS \"alternative_name\", MIN(\"t19\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.8531},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t16\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t4\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.2604},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t19\".\"alternative_name\") AS \"alternative_name\", MIN(\"t19\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_character_name\") AS \"voiced_character_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t7\".\"ID\", \"t5\".\"alternative_name\", \"t5\".\"voiced_character_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_character_name\") AS \"voiced_character_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_character_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_character_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\"\r\nWHERE \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f' AND \"NAME\" LIKE '%An%'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.7642}],"num_rewrites":10,"raw_query":"SELECT     MIN(an.name) AS alternative_name,     MIN(chn.name) AS voiced_character_name,     MIN(n.name) AS voicing_actress,     MIN(t.title) AS american_movie FROM     aka_name AS an,     char_name AS chn,     cast_info AS ci,     company_name AS cn,     movie_companies AS mc,     name AS n,     role_type AS rt,     title AS t WHERE     ci.note in (         '(voice)',         '(voice: Japanese version)',         '(voice) (uncredited)',         '(voice: English version)'     )     AND cn.country_code = '[us]'     AND n.gender = 'f'     and n.name like '%An%'     AND rt.role = 'actress'     AND ci.movie_id = t.id     AND t.id = mc.movie_id     AND ci.movie_id = mc.movie_id     AND mc.company_id = cn.id     AND ci.role_id = rt.id     AND n.id = ci.person_id     AND chn.id = ci.person_role_id     AND an.person_id = n.id     AND an.person_id = ci.person_id;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t16\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", \"t6\".\"ID\", \"t4\".\"alternative_name\", \"t4\".\"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\" ON \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\") AS \"t7\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t7\".\"ID\" = \"t8\".\"COMPANY_ID\"\r\nGROUP BY \"t7\".\"PERSON_ID0\", \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":5.4347},{"rule_order":"[]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"NAME\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n\"CAST_INFO\",\r\n\"COMPANY_NAME\",\r\n\"MOVIE_COMPANIES\",\r\n\"NAME\",\r\n\"ROLE_TYPE\",\r\n\"TITLE\"\r\nWHERE (\"CAST_INFO\".\"NOTE\" = '(voice)' OR \"CAST_INFO\".\"NOTE\" = '(voice: Japanese version)' OR \"CAST_INFO\".\"NOTE\" = '(voice) (uncredited)' OR \"CAST_INFO\".\"NOTE\" = '(voice: English version)') AND (\"COMPANY_NAME\".\"COUNTRY_CODE\" = '[us]' AND \"NAME\".\"GENDER\" = 'f') AND (\"ROLE_TYPE\".\"ROLE\" = 'actress' AND (\"CAST_INFO\".\"MOVIE_ID\" = \"TITLE\".\"ID\" AND \"TITLE\".\"ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\")) AND (\"CAST_INFO\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND (\"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"COMPANY_NAME\".\"ID\" AND \"CAST_INFO\".\"ROLE_ID\" = \"ROLE_TYPE\".\"ID\") AND (\"NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ID\" AND \"CHAR_NAME\".\"ID\" = \"CAST_INFO\".\"PERSON_ROLE_ID\" AND (\"AKA_NAME\".\"PERSON_ID\" = \"NAME\".\"ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"CAST_INFO\".\"PERSON_ID\")))","rewrite_time":1.4227},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT MIN(\"t6\".\"NAME\") AS \"alternative_name\", MIN(\"t6\".\"NAME0\") AS \"voiced_char_name\", MIN(\"t6\".\"NAME2\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"AKA_NAME\",\r\n\"CHAR_NAME\",\r\n(SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\"\r\nWHERE \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\") AS \"t0\",\r\n(SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t1\",\r\n\"MOVIE_COMPANIES\"\r\nWHERE \"t0\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"MOVIE_COMPANIES\".\"COMPANY_ID\" = \"t1\".\"ID\") AS \"t2\",\r\n(SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f') AS \"t3\"\r\nWHERE \"t2\".\"PERSON_ID0\" = \"t3\".\"ID\") AS \"t4\",\r\n(SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t5\"\r\nWHERE \"t4\".\"ROLE_ID\" = \"t5\".\"ID\") AS \"t6\",\r\n\"TITLE\"\r\nWHERE \"t6\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.8332},{"rule_order":"[rule_union, rule_project, rule_join, rule_filter, rule_orderby]","rewrite_query":"SELECT MIN(\"AKA_NAME\".\"NAME\") AS \"alternative_name\", MIN(\"CHAR_NAME\".\"NAME\") AS \"voiced_char_name\", MIN(\"t1\".\"NAME\") AS \"voicing_actress\", MIN(\"TITLE\".\"TITLE\") AS \"american_movie\"\r\nFROM \"AKA_NAME\"\r\nCROSS JOIN \"CHAR_NAME\"\r\nINNER JOIN (SELECT *\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')) AS \"t\" ON \"CHAR_NAME\".\"ID\" = \"t\".\"PERSON_ROLE_ID\" AND \"AKA_NAME\".\"PERSON_ID\" = \"t\".\"PERSON_ID\"\r\nCROSS JOIN (SELECT *\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]') AS \"t0\"\r\nINNER JOIN \"MOVIE_COMPANIES\" ON \"t\".\"MOVIE_ID\" = \"MOVIE_COMPANIES\".\"MOVIE_ID\" AND \"t0\".\"ID\" = \"MOVIE_COMPANIES\".\"COMPANY_ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f') AS \"t1\" ON \"t\".\"PERSON_ID\" = \"t1\".\"ID\"\r\nINNER JOIN (SELECT *\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress') AS \"t2\" ON \"t\".\"ROLE_ID\" = \"t2\".\"ID\"\r\nINNER JOIN \"TITLE\" ON \"t\".\"MOVIE_ID\" = \"TITLE\".\"ID\"","rewrite_time":3.5288},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT MIN(\"t17\".\"alternative_name\") AS \"alternative_name\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t13\".\"MOVIE_ID\", MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\"\r\nWHERE \"t4\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t7\".\"COMPANY_ID\" = \"t6\".\"ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t9\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t11\"\r\nWHERE \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t13\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t15\"\r\nWHERE \"t13\".\"ROLE_ID\" = \"t15\".\"ID\"\r\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t17\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t18\"\r\nWHERE \"t17\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.4703},{"rule_order":"[rule_union, rule_agg, rule_orderby, rule_join, rule_filter, rule_cal]","rewrite_query":"SELECT MIN(\"t13\".\"alternative_name\") AS \"alternative_name\", MIN(\"t13\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t14\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t10\".\"MOVIE_ID\", MIN(\"t10\".\"alternative_name\") AS \"alternative_name\", MIN(\"t10\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t10\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\", MIN(\"t7\".\"alternative_name\") AS \"alternative_name\", MIN(\"t7\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t9\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t3\".\"alternative_name\") AS \"alternative_name\", MIN(\"t3\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t3\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t5\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t6\" ON \"t3\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\" AND \"t5\".\"ID\" = \"t6\".\"COMPANY_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t7\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t9\" ON \"t7\".\"PERSON_ID0\" = \"t9\".\"ID\"\r\nGROUP BY \"t7\".\"MOVIE_ID\", \"t7\".\"ROLE_ID\") AS \"t10\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t12\" ON \"t10\".\"ROLE_ID\" = \"t12\".\"ID\"\r\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t13\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t14\" ON \"t13\".\"MOVIE_ID\" = \"t14\".\"ID\"","rewrite_time":5.2982},{"rule_order":"[rule_cal, rule_agg, rule_join, rule_union, rule_project, rule_filter]","rewrite_query":"SELECT MIN(\"t17\".\"alternative_name\") AS \"alternative_name\", MIN(\"t17\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t17\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t18\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t14\".\"MOVIE_ID\", MIN(\"t14\".\"alternative_name\") AS \"alternative_name\", MIN(\"t14\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t14\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t11\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t13\" ON \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t14\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t16\" ON \"t14\".\"ROLE_ID\" = \"t16\".\"ID\"\r\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t17\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"ID\"","rewrite_time":5.3024},{"rule_order":"[rule_cal, rule_filter, rule_agg, rule_union, rule_join, rule_project]","rewrite_query":"SELECT MIN(\"t19\".\"alternative_name\") AS \"alternative_name\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", MIN(\"t5\".\"alternative_name\") AS \"alternative_name\", MIN(\"t5\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\"\r\nWHERE \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t8\"\r\nWHERE \"t5\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\" AND \"t8\".\"COMPANY_ID\" = \"t7\".\"ID\"\r\nGROUP BY \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.4851},{"rule_order":"[rule_agg, rule_join, rule_filter, rule_union, rule_cal, rule_project]","rewrite_query":"SELECT MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t16\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t12\".\"MOVIE_ID\", MIN(\"t12\".\"alternative_name\") AS \"alternative_name\", MIN(\"t12\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t12\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\", MIN(\"t9\".\"alternative_name\") AS \"alternative_name\", MIN(\"t9\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t11\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\", MIN(\"t4\".\"alternative_name\") AS \"alternative_name\", MIN(\"t4\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t2\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\", MIN(\"t\".\"alternative_name\") AS \"alternative_name\", MIN(\"t0\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\"\r\nCROSS JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\"\r\nINNER JOIN (SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t2\" ON \"t0\".\"ID\" = \"t2\".\"PERSON_ROLE_ID\" AND \"t\".\"PERSON_ID\" = \"t2\".\"PERSON_ID\"\r\nGROUP BY \"t2\".\"PERSON_ID\", \"t2\".\"MOVIE_ID\", \"t2\".\"ROLE_ID\") AS \"t4\"\r\nCROSS JOIN (SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t6\"\r\nINNER JOIN (SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t7\" ON \"t4\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\" AND \"t6\".\"ID\" = \"t7\".\"COMPANY_ID\"\r\nGROUP BY \"t4\".\"PERSON_ID0\", \"t4\".\"MOVIE_ID\", \"t4\".\"ROLE_ID\") AS \"t9\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t11\" ON \"t9\".\"PERSON_ID0\" = \"t11\".\"ID\"\r\nGROUP BY \"t9\".\"MOVIE_ID\", \"t9\".\"ROLE_ID\") AS \"t12\"\r\nINNER JOIN (SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t14\" ON \"t12\".\"ROLE_ID\" = \"t14\".\"ID\"\r\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t15\"\r\nINNER JOIN (SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t16\" ON \"t15\".\"MOVIE_ID\" = \"t16\".\"ID\"","rewrite_time":4.9764},{"rule_order":"[rule_union, rule_filter, rule_agg, rule_project, rule_join]","rewrite_query":"SELECT MIN(\"t19\".\"alternative_name\") AS \"alternative_name\", MIN(\"t19\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t19\".\"voicing_actress\") AS \"voicing_actress\", MIN(\"t20\".\"american_movie\") AS \"american_movie\"\r\nFROM (SELECT \"t15\".\"MOVIE_ID\", MIN(\"t15\".\"alternative_name\") AS \"alternative_name\", MIN(\"t15\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t15\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\", MIN(\"t11\".\"alternative_name\") AS \"alternative_name\", MIN(\"t11\".\"voiced_char_name\") AS \"voiced_char_name\", MIN(\"t13\".\"voicing_actress\") AS \"voicing_actress\"\r\nFROM (SELECT \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\", MIN(\"t8\".\"alternative_name\") AS \"alternative_name\", MIN(\"t8\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t5\".\"PERSON_ID0\", \"t5\".\"MOVIE_ID\", \"t5\".\"ROLE_ID\", \"t7\".\"ID\", \"t5\".\"alternative_name\", \"t5\".\"voiced_char_name\"\r\nFROM (SELECT \"t3\".\"PERSON_ID\" AS \"PERSON_ID0\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\", MIN(\"t1\".\"alternative_name\") AS \"alternative_name\", MIN(\"t1\".\"voiced_char_name\") AS \"voiced_char_name\"\r\nFROM (SELECT \"t\".\"PERSON_ID\", \"t0\".\"ID\", \"t\".\"alternative_name\", \"t0\".\"voiced_char_name\"\r\nFROM (SELECT \"PERSON_ID\", MIN(\"NAME\") AS \"alternative_name\"\r\nFROM \"AKA_NAME\"\r\nGROUP BY \"PERSON_ID\") AS \"t\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voiced_char_name\"\r\nFROM \"CHAR_NAME\"\r\nGROUP BY \"ID\") AS \"t0\") AS \"t1\",\r\n(SELECT \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\"\r\nFROM \"CAST_INFO\"\r\nWHERE \"NOTE\" IN ('(voice)', '(voice) (uncredited)', '(voice: English version)', '(voice: Japanese version)')\r\nGROUP BY \"PERSON_ID\", \"MOVIE_ID\", \"PERSON_ROLE_ID\", \"ROLE_ID\") AS \"t3\"\r\nWHERE \"t1\".\"ID\" = \"t3\".\"PERSON_ROLE_ID\" AND \"t1\".\"PERSON_ID\" = \"t3\".\"PERSON_ID\"\r\nGROUP BY \"t3\".\"PERSON_ID\", \"t3\".\"MOVIE_ID\", \"t3\".\"ROLE_ID\") AS \"t5\",\r\n(SELECT \"ID\"\r\nFROM \"COMPANY_NAME\"\r\nWHERE \"COUNTRY_CODE\" = '[us]'\r\nGROUP BY \"ID\") AS \"t7\") AS \"t8\",\r\n(SELECT \"MOVIE_ID\", \"COMPANY_ID\"\r\nFROM \"MOVIE_COMPANIES\"\r\nGROUP BY \"MOVIE_ID\", \"COMPANY_ID\") AS \"t9\"\r\nWHERE \"t8\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\" AND \"t9\".\"COMPANY_ID\" = \"t8\".\"ID\"\r\nGROUP BY \"t8\".\"PERSON_ID0\", \"t8\".\"MOVIE_ID\", \"t8\".\"ROLE_ID\") AS \"t11\",\r\n(SELECT \"ID\", MIN(\"NAME\") AS \"voicing_actress\"\r\nFROM \"NAME\"\r\nWHERE \"GENDER\" = 'f'\r\nGROUP BY \"ID\") AS \"t13\"\r\nWHERE \"t11\".\"PERSON_ID0\" = \"t13\".\"ID\"\r\nGROUP BY \"t11\".\"MOVIE_ID\", \"t11\".\"ROLE_ID\") AS \"t15\",\r\n(SELECT \"ID\"\r\nFROM \"ROLE_TYPE\"\r\nWHERE \"ROLE\" = 'actress'\r\nGROUP BY \"ID\") AS \"t17\"\r\nWHERE \"t15\".\"ROLE_ID\" = \"t17\".\"ID\"\r\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t19\",\r\n(SELECT \"ID\", MIN(\"TITLE\") AS \"american_movie\"\r\nFROM \"TITLE\"\r\nGROUP BY \"ID\") AS \"t20\"\r\nWHERE \"t19\".\"MOVIE_ID\" = \"t20\".\"ID\"","rewrite_time":5.4735}],"num_rewrites":10,"raw_query":"SELECT MIN(an.name) AS alternative_name, MIN(chn.name) AS voiced_char_name, MIN(n.name) AS voicing_actress, MIN(t.title) AS american_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note  in ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND n.gender ='f' AND rt.role ='actress' AND ci.movie_id = t.id AND t.id = mc.movie_id AND ci.movie_id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND n.id = ci.person_id AND chn.id = ci.person_role_id AND an.person_id = n.id AND an.person_id = ci.person_id;"}]