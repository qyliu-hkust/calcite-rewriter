[{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"nation\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":1259.7491},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\") AS \"l_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AND (\"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"nation\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM') AND (\"lineitem\".\"l_shipdate\" >= DATE '1995-01-01' AND \"lineitem\".\"l_shipdate\" <= DATE '1996-12-31'))\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")","rewrite_time":24.1061},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"supplier\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n\"customer\"\r\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'VIETNAM' AND \"nation0\".\"n_name\" = 'UNITED KINGDOM' OR \"t3\".\"n_name\" = 'UNITED KINGDOM' AND \"nation0\".\"n_name\" = 'VIETNAM')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":45.5233}],"num_rewrites":3,"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'VIETNAM' and n2.n_name = 'UNITED KINGDOM')      or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'VIETNAM')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'GERMANY' OR \"nation\".\"n_name\" = 'GERMANY' AND \"nation0\".\"n_name\" = 'FRANCE')\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":5.8111},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\") AS \"l_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AND (\"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'GERMANY' OR \"nation\".\"n_name\" = 'GERMANY' AND \"nation0\".\"n_name\" = 'FRANCE') AND (\"lineitem\".\"l_shipdate\" >= DATE '1995-01-01' AND \"lineitem\".\"l_shipdate\" <= DATE '1996-12-31'))\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")","rewrite_time":4.1372},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"supplier\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n\"customer\"\r\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'GERMANY' OR \"t3\".\"n_name\" = 'GERMANY' AND \"nation0\".\"n_name\" = 'FRANCE')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":4.1062}],"num_rewrites":3,"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')      or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'ETHIOPIA' AND \"nation0\".\"n_name\" = 'FRANCE' OR \"nation\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'ETHIOPIA')\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":3.7548},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\") AS \"l_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AND (\"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'ETHIOPIA' AND \"nation0\".\"n_name\" = 'FRANCE' OR \"nation\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'ETHIOPIA') AND (\"lineitem\".\"l_shipdate\" >= DATE '1995-01-01' AND \"lineitem\".\"l_shipdate\" <= DATE '1996-12-31'))\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")","rewrite_time":1.9209},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"supplier\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n\"customer\"\r\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'ETHIOPIA' AND \"nation0\".\"n_name\" = 'FRANCE' OR \"t3\".\"n_name\" = 'FRANCE' AND \"nation0\".\"n_name\" = 'ETHIOPIA')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":3.7154}],"num_rewrites":3,"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'ETHIOPIA' and n2.n_name = 'FRANCE')      or (n1.n_name = 'FRANCE' and n2.n_name = 'ETHIOPIA')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'BRAZIL' AND \"nation0\".\"n_name\" = 'ROMANIA' OR \"nation\".\"n_name\" = 'ROMANIA' AND \"nation0\".\"n_name\" = 'BRAZIL')\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":3.249},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\") AS \"l_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AND (\"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'BRAZIL' AND \"nation0\".\"n_name\" = 'ROMANIA' OR \"nation\".\"n_name\" = 'ROMANIA' AND \"nation0\".\"n_name\" = 'BRAZIL') AND (\"lineitem\".\"l_shipdate\" >= DATE '1995-01-01' AND \"lineitem\".\"l_shipdate\" <= DATE '1996-12-31'))\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")","rewrite_time":1.4634},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"supplier\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n\"customer\"\r\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'BRAZIL' AND \"nation0\".\"n_name\" = 'ROMANIA' OR \"t3\".\"n_name\" = 'ROMANIA' AND \"nation0\".\"n_name\" = 'BRAZIL')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":3.7845}],"num_rewrites":3,"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'BRAZIL' and n2.n_name = 'ROMANIA')      or (n1.n_name = 'ROMANIA' and n2.n_name = 'BRAZIL')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\") AS \"l_year\", SUM(\"t\".\"l_extendedprice\" * (1 - \"t\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\" ON \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\"\r\nINNER JOIN \"orders\" ON \"t\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"orders\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'KENYA' AND \"nation0\".\"n_name\" = 'PERU' OR \"nation\".\"n_name\" = 'PERU' AND \"nation0\".\"n_name\" = 'KENYA')\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t\".\"l_shipdate\")","rewrite_time":3.4094},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\") AS \"l_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AND (\"customer\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"nation\".\"n_name\" = 'KENYA' AND \"nation0\".\"n_name\" = 'PERU' OR \"nation\".\"n_name\" = 'PERU' AND \"nation0\".\"n_name\" = 'KENYA') AND (\"lineitem\".\"l_shipdate\" >= DATE '1995-01-01' AND \"lineitem\".\"l_shipdate\" <= DATE '1996-12-31'))\r\nGROUP BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")\r\nORDER BY \"nation\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"lineitem\".\"l_shipdate\")","rewrite_time":1.5227},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\" AS \"supp_nation\", \"nation0\".\"n_name\" AS \"cust_nation\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\") AS \"l_year\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"supplier\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" >= DATE '1995-01-01' AND \"l_shipdate\" <= DATE '1996-12-31') AS \"t\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"t\".\"l_suppkey\") AS \"t0\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t0\".\"l_orderkey\") AS \"t1\",\r\n\"customer\"\r\nWHERE \"customer\".\"c_custkey\" = \"t1\".\"o_custkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation0\".\"n_nationkey\" AND (\"t3\".\"n_name\" = 'KENYA' AND \"nation0\".\"n_name\" = 'PERU' OR \"t3\".\"n_name\" = 'PERU' AND \"nation0\".\"n_name\" = 'KENYA')\r\nGROUP BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")\r\nORDER BY \"t3\".\"n_name\", \"nation0\".\"n_name\", EXTRACT(YEAR FROM \"t3\".\"l_shipdate\")","rewrite_time":3.2842}],"num_rewrites":3,"raw_query":"select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'KENYA' and n2.n_name = 'PERU')      or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-07-10' AND \"o_orderdate\" < (DATE '1993-07-10' + INTERVAL '3' MONTH)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t0\" ON \"t\".\"o_orderkey\" = \"t0\".\"l_orderkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) DESC","rewrite_time":30.8712},{"rule_order":"[]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"nation\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" >= DATE '1993-07-10') AND (\"orders\".\"o_orderdate\" < (DATE '1993-07-10' + INTERVAL '3' MONTH) AND (\"lineitem\".\"l_returnflag\" = 'R' AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"))\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":6.7263},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-07-10' AND \"o_orderdate\" < (DATE '1993-07-10' + INTERVAL '3' MONTH)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t1\"\r\nWHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC","rewrite_time":9.6859}],"num_rewrites":3,"raw_query":"select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1993-07-10'   and o_orderdate < date '1993-07-10' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-08-10' AND \"o_orderdate\" < (DATE '1994-08-10' + INTERVAL '3' MONTH)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t0\" ON \"t\".\"o_orderkey\" = \"t0\".\"l_orderkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) DESC","rewrite_time":3.0274},{"rule_order":"[]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"nation\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" >= DATE '1994-08-10') AND (\"orders\".\"o_orderdate\" < (DATE '1994-08-10' + INTERVAL '3' MONTH) AND (\"lineitem\".\"l_returnflag\" = 'R' AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"))\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.6001},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-08-10' AND \"o_orderdate\" < (DATE '1994-08-10' + INTERVAL '3' MONTH)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t1\"\r\nWHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC","rewrite_time":2.9076}],"num_rewrites":3,"raw_query":"select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1994-08-10'   and o_orderdate < date '1994-08-10' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-05-10' AND \"o_orderdate\" < (DATE '1994-05-10' + INTERVAL '3' MONTH)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t0\" ON \"t\".\"o_orderkey\" = \"t0\".\"l_orderkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) DESC","rewrite_time":2.8609},{"rule_order":"[]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"nation\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" >= DATE '1994-05-10') AND (\"orders\".\"o_orderdate\" < (DATE '1994-05-10' + INTERVAL '3' MONTH) AND (\"lineitem\".\"l_returnflag\" = 'R' AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"))\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.4231},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-05-10' AND \"o_orderdate\" < (DATE '1994-05-10' + INTERVAL '3' MONTH)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t1\"\r\nWHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC","rewrite_time":2.471}],"num_rewrites":3,"raw_query":"select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1994-05-10'   and o_orderdate < date '1994-05-10' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-02-01' AND \"o_orderdate\" < (DATE '1993-02-10' + INTERVAL '3' MONTH)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t0\" ON \"t\".\"o_orderkey\" = \"t0\".\"l_orderkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) DESC","rewrite_time":2.4876},{"rule_order":"[]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"nation\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" >= DATE '1993-02-01') AND (\"orders\".\"o_orderdate\" < (DATE '1993-02-10' + INTERVAL '3' MONTH) AND (\"lineitem\".\"l_returnflag\" = 'R' AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"))\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.3417},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-02-01' AND \"o_orderdate\" < (DATE '1993-02-10' + INTERVAL '3' MONTH)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t1\"\r\nWHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC","rewrite_time":2.5702}],"num_rewrites":3,"raw_query":"select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1993-02-01'   and o_orderdate < date '1993-02-10' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-06-10' AND \"o_orderdate\" < (DATE '1994-06-10' + INTERVAL '3' MONTH)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t0\" ON \"t\".\"o_orderkey\" = \"t0\".\"l_orderkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"t0\".\"l_extendedprice\" * (1 - \"t0\".\"l_discount\")) DESC","rewrite_time":2.7603},{"rule_order":"[]","rewrite_query":"SELECT \"customer\".\"c_custkey\", \"customer\".\"c_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"customer\".\"c_acctbal\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_phone\", \"customer\".\"c_comment\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"nation\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" >= DATE '1994-06-10') AND (\"orders\".\"o_orderdate\" < (DATE '1994-06-10' + INTERVAL '3' MONTH) AND (\"lineitem\".\"l_returnflag\" = 'R' AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"))\r\nGROUP BY \"customer\".\"c_custkey\", \"customer\".\"c_name\", \"customer\".\"c_acctbal\", \"customer\".\"c_phone\", \"nation\".\"n_name\", \"customer\".\"c_address\", \"customer\".\"c_comment\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.356},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"c_custkey\", \"t2\".\"c_name\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t2\".\"c_acctbal\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_phone\", \"t2\".\"c_comment\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-06-10' AND \"o_orderdate\" < (DATE '1994-06-10' + INTERVAL '3' MONTH)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_returnflag\" = 'R') AS \"t1\"\r\nWHERE \"t1\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"t2\".\"c_custkey\", \"t2\".\"c_name\", \"t2\".\"c_acctbal\", \"t2\".\"c_phone\", \"nation\".\"n_name\", \"t2\".\"c_address\", \"t2\".\"c_comment\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC","rewrite_time":2.4643}],"num_rewrites":3,"raw_query":"select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1994-06-10'   and o_orderdate < date '1994-06-10' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"t1\".\"l_orderkey\", SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) AS \"revenue\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'BUILDING') AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-17') AS \"t0\" ON \"t\".\"c_custkey\" = \"t0\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-17') AS \"t1\" ON \"t0\".\"o_orderkey\" = \"t1\".\"l_orderkey\"\r\nGROUP BY \"t1\".\"l_orderkey\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nORDER BY SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) DESC, \"t0\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":10.2265},{"rule_order":"[]","rewrite_query":"SELECT \"lineitem\".\"l_orderkey\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\"\r\nWHERE \"customer\".\"c_mktsegment\" = 'BUILDING' AND \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" < DATE '1995-03-17' AND \"lineitem\".\"l_shipdate\" > DATE '1995-03-17'\r\nGROUP BY \"lineitem\".\"l_orderkey\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC, \"orders\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":2.9994},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"l_orderkey\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'BUILDING') AS \"t\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-17') AS \"t0\"\r\nWHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-17') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":4.0252}],"num_rewrites":3,"raw_query":"select   l_orderkey,   sum(l_extendedprice * (1 - l_discount)) as revenue,   o_orderdate,   o_shippriority  from   customer,   orders,   lineitem  where   c_mktsegment = 'BUILDING'   and c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate < date '1995-03-17'   and l_shipdate > date '1995-03-17'  group by   l_orderkey,   o_orderdate,   o_shippriority  order by   revenue desc,   o_orderdate  limit 10;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"t1\".\"l_orderkey\", SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) AS \"revenue\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'FURNITURE') AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-04') AS \"t0\" ON \"t\".\"c_custkey\" = \"t0\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-04') AS \"t1\" ON \"t0\".\"o_orderkey\" = \"t1\".\"l_orderkey\"\r\nGROUP BY \"t1\".\"l_orderkey\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nORDER BY SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) DESC, \"t0\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.9849},{"rule_order":"[]","rewrite_query":"SELECT \"lineitem\".\"l_orderkey\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\"\r\nWHERE \"customer\".\"c_mktsegment\" = 'FURNITURE' AND \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" < DATE '1995-03-04' AND \"lineitem\".\"l_shipdate\" > DATE '1995-03-04'\r\nGROUP BY \"lineitem\".\"l_orderkey\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC, \"orders\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":0.9657},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"l_orderkey\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'FURNITURE') AS \"t\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-04') AS \"t0\"\r\nWHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-04') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.7591}],"num_rewrites":3,"raw_query":"select   l_orderkey,   sum(l_extendedprice * (1 - l_discount)) as revenue,   o_orderdate,   o_shippriority  from   customer,   orders,   lineitem  where   c_mktsegment = 'FURNITURE'   and c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate < date '1995-03-04'   and l_shipdate > date '1995-03-04'  group by   l_orderkey,   o_orderdate,   o_shippriority  order by   revenue desc,   o_orderdate  limit 10;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"t1\".\"l_orderkey\", SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) AS \"revenue\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'AUTOMOBILE') AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-16') AS \"t0\" ON \"t\".\"c_custkey\" = \"t0\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-16') AS \"t1\" ON \"t0\".\"o_orderkey\" = \"t1\".\"l_orderkey\"\r\nGROUP BY \"t1\".\"l_orderkey\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nORDER BY SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) DESC, \"t0\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.7767},{"rule_order":"[]","rewrite_query":"SELECT \"lineitem\".\"l_orderkey\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\"\r\nWHERE \"customer\".\"c_mktsegment\" = 'AUTOMOBILE' AND \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" < DATE '1995-03-16' AND \"lineitem\".\"l_shipdate\" > DATE '1995-03-16'\r\nGROUP BY \"lineitem\".\"l_orderkey\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC, \"orders\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":0.9128},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"l_orderkey\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'AUTOMOBILE') AS \"t\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-16') AS \"t0\"\r\nWHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-16') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.8873}],"num_rewrites":3,"raw_query":"select   l_orderkey,   sum(l_extendedprice * (1 - l_discount)) as revenue,   o_orderdate,   o_shippriority  from   customer,   orders,   lineitem  where   c_mktsegment = 'AUTOMOBILE'   and c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate < date '1995-03-16'   and l_shipdate > date '1995-03-16'  group by   l_orderkey,   o_orderdate,   o_shippriority  order by   revenue desc,   o_orderdate  limit 10;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"t1\".\"l_orderkey\", SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) AS \"revenue\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'FURNITURE') AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-03') AS \"t0\" ON \"t\".\"c_custkey\" = \"t0\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-03') AS \"t1\" ON \"t0\".\"o_orderkey\" = \"t1\".\"l_orderkey\"\r\nGROUP BY \"t1\".\"l_orderkey\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nORDER BY SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) DESC, \"t0\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.7867},{"rule_order":"[]","rewrite_query":"SELECT \"lineitem\".\"l_orderkey\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\"\r\nWHERE \"customer\".\"c_mktsegment\" = 'FURNITURE' AND \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" < DATE '1995-03-03' AND \"lineitem\".\"l_shipdate\" > DATE '1995-03-03'\r\nGROUP BY \"lineitem\".\"l_orderkey\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC, \"orders\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.0071},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"l_orderkey\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'FURNITURE') AS \"t\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-03') AS \"t0\"\r\nWHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-03') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.7498}],"num_rewrites":3,"raw_query":"select   l_orderkey,   sum(l_extendedprice * (1 - l_discount)) as revenue,   o_orderdate,   o_shippriority  from   customer,   orders,   lineitem  where   c_mktsegment = 'FURNITURE'   and c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate < date '1995-03-03'   and l_shipdate > date '1995-03-03'  group by   l_orderkey,   o_orderdate,   o_shippriority  order by   revenue desc,   o_orderdate  limit 10;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"t1\".\"l_orderkey\", SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) AS \"revenue\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'AUTOMOBILE') AS \"t\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-20') AS \"t0\" ON \"t\".\"c_custkey\" = \"t0\".\"o_custkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-20') AS \"t1\" ON \"t0\".\"o_orderkey\" = \"t1\".\"l_orderkey\"\r\nGROUP BY \"t1\".\"l_orderkey\", \"t0\".\"o_orderdate\", \"t0\".\"o_shippriority\"\r\nORDER BY SUM(\"t1\".\"l_extendedprice\" * (1 - \"t1\".\"l_discount\")) DESC, \"t0\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.7203},{"rule_order":"[]","rewrite_query":"SELECT \"lineitem\".\"l_orderkey\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\"\r\nWHERE \"customer\".\"c_mktsegment\" = 'AUTOMOBILE' AND \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND \"orders\".\"o_orderdate\" < DATE '1995-03-20' AND \"lineitem\".\"l_shipdate\" > DATE '1995-03-20'\r\nGROUP BY \"lineitem\".\"l_orderkey\", \"orders\".\"o_orderdate\", \"orders\".\"o_shippriority\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC, \"orders\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":0.8533},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t2\".\"l_orderkey\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) AS \"revenue\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\"\r\nWHERE \"c_mktsegment\" = 'AUTOMOBILE') AS \"t\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" < DATE '1995-03-20') AS \"t0\"\r\nWHERE \"t\".\"c_custkey\" = \"t0\".\"o_custkey\") AS \"t1\",\r\n(SELECT *\r\nFROM \"lineitem\"\r\nWHERE \"l_shipdate\" > DATE '1995-03-20') AS \"t2\"\r\nWHERE \"t2\".\"l_orderkey\" = \"t1\".\"o_orderkey\"\r\nGROUP BY \"t2\".\"l_orderkey\", \"t1\".\"o_orderdate\", \"t1\".\"o_shippriority\"\r\nORDER BY SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\")) DESC, \"t1\".\"o_orderdate\"\r\nFETCH NEXT 10 ROWS ONLY","rewrite_time":1.6978}],"num_rewrites":3,"raw_query":"select   l_orderkey,   sum(l_extendedprice * (1 - l_discount)) as revenue,   o_orderdate,   o_shippriority  from   customer,   orders,   lineitem  where   c_mktsegment = 'AUTOMOBILE'   and c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate < date '1995-03-20'   and l_shipdate > date '1995-03-20'  group by   l_orderkey,   o_orderdate,   o_shippriority  order by   revenue desc,   o_orderdate  limit 10;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1996-01-01' AND \"o_orderdate\" < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\"\r\nINNER JOIN \"supplier\" ON \"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":5.542},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"supplier\",\r\n\"nation\",\r\n\"region\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'ASIA' AND (\"orders\".\"o_orderdate\" >= DATE '1996-01-01' AND \"orders\".\"o_orderdate\" < (DATE '1996-01-01' + INTERVAL '1' YEAR))))\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":2.0681},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1996-01-01' AND \"o_orderdate\" < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n\"lineitem\"\r\nWHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n\"supplier\"\r\nWHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) DESC","rewrite_time":4.0692}],"num_rewrites":3,"raw_query":"select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'ASIA'   and o_orderdate >= date '1996-01-01'   and o_orderdate < date '1996-01-01' + interval '1' year  group by   n_name  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-01-02' AND \"o_orderdate\" < (DATE '1994-01-02' + INTERVAL '1' YEAR)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\"\r\nINNER JOIN \"supplier\" ON \"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":3.0895},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"supplier\",\r\n\"nation\",\r\n\"region\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'EUROPE' AND (\"orders\".\"o_orderdate\" >= DATE '1994-01-02' AND \"orders\".\"o_orderdate\" < (DATE '1994-01-02' + INTERVAL '1' YEAR))))\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.3036},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1994-01-02' AND \"o_orderdate\" < (DATE '1994-01-02' + INTERVAL '1' YEAR)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n\"lineitem\"\r\nWHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n\"supplier\"\r\nWHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) DESC","rewrite_time":3.2546}],"num_rewrites":3,"raw_query":"select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'EUROPE'   and o_orderdate >= date '1994-01-02'   and o_orderdate < date '1994-01-02' + interval '1' year  group by   n_name  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-03-01' AND \"o_orderdate\" < (DATE '1993-03-01' + INTERVAL '1' YEAR)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\"\r\nINNER JOIN \"supplier\" ON \"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":3.1073},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"supplier\",\r\n\"nation\",\r\n\"region\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AFRICA' AND (\"orders\".\"o_orderdate\" >= DATE '1993-03-01' AND \"orders\".\"o_orderdate\" < (DATE '1993-03-01' + INTERVAL '1' YEAR))))\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.3322},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1993-03-01' AND \"o_orderdate\" < (DATE '1993-03-01' + INTERVAL '1' YEAR)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n\"lineitem\"\r\nWHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n\"supplier\"\r\nWHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) DESC","rewrite_time":3.173}],"num_rewrites":3,"raw_query":"select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'AFRICA'   and o_orderdate >= date '1993-03-01'   and o_orderdate < date '1993-03-01' + interval '1' year  group by   n_name  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-10' AND \"o_orderdate\" < (DATE '1995-01-10' + INTERVAL '1' YEAR)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\"\r\nINNER JOIN \"supplier\" ON \"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":3.1829},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"supplier\",\r\n\"nation\",\r\n\"region\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'ASIA' AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-10' AND \"orders\".\"o_orderdate\" < (DATE '1995-01-10' + INTERVAL '1' YEAR))))\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.3047},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-10' AND \"o_orderdate\" < (DATE '1995-01-10' + INTERVAL '1' YEAR)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n\"lineitem\"\r\nWHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n\"supplier\"\r\nWHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) DESC","rewrite_time":3.1558}],"num_rewrites":3,"raw_query":"select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'ASIA'   and o_orderdate >= date '1995-01-10'   and o_orderdate < date '1995-01-10' + interval '1' year  group by   n_name  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1997-01-01' AND \"o_orderdate\" < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS \"t\" ON \"customer\".\"c_custkey\" = \"t\".\"o_custkey\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\"\r\nINNER JOIN \"supplier\" ON \"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t0\" ON \"nation\".\"n_regionkey\" = \"t0\".\"r_regionkey\"\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":3.2207},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"revenue\"\r\nFROM \"customer\",\r\n\"orders\",\r\n\"lineitem\",\r\n\"supplier\",\r\n\"nation\",\r\n\"region\"\r\nWHERE \"customer\".\"c_custkey\" = \"orders\".\"o_custkey\" AND \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"lineitem\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"customer\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AMERICA' AND (\"orders\".\"o_orderdate\" >= DATE '1997-01-01' AND \"orders\".\"o_orderdate\" < (DATE '1997-01-01' + INTERVAL '1' YEAR))))\r\nGROUP BY \"nation\".\"n_name\"\r\nORDER BY SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) DESC","rewrite_time":1.4373},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"t3\".\"n_name\", SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) AS \"revenue\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"customer\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1997-01-01' AND \"o_orderdate\" < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS \"t\"\r\nWHERE \"customer\".\"c_custkey\" = \"t\".\"o_custkey\") AS \"t0\",\r\n\"lineitem\"\r\nWHERE \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\") AS \"t1\",\r\n\"supplier\"\r\nWHERE \"t1\".\"l_suppkey\" = \"supplier\".\"s_suppkey\" AND \"t1\".\"c_nationkey\" = \"supplier\".\"s_nationkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\") AS \"t3\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t4\"\r\nWHERE \"t3\".\"n_regionkey\" = \"t4\".\"r_regionkey\"\r\nGROUP BY \"t3\".\"n_name\"\r\nORDER BY SUM(\"t3\".\"l_extendedprice\" * (1 - \"t3\".\"l_discount\")) DESC","rewrite_time":3.6858}],"num_rewrites":3,"raw_query":"select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'AMERICA'   and o_orderdate >= date '1997-01-01'   and o_orderdate < date '1997-01-01' + interval '1' year  group by   n_name  order by   revenue desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%turquoise%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":6.4277},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%turquoise%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":2.3232},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%turquoise%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":4.2314}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%turquoise%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%addle%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":2.8924},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%addle%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":1.3086},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%addle%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":2.9115}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%addle%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%yellow%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":2.9041},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%yellow%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":1.4678},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%yellow%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":3.2772}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%yellow%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%rosy%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":2.7278},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%rosy%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":1.2247},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%rosy%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":3.0131}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%rosy%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%peru%') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\"\r\nINNER JOIN \"partsupp\" ON \"lineitem\".\"l_suppkey\" = \"partsupp\".\"ps_suppkey\" AND \"lineitem\".\"l_partkey\" = \"partsupp\".\"ps_partkey\"\r\nINNER JOIN \"orders\" ON \"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\"\r\nINNER JOIN \"nation\" ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":3.2166},{"rule_order":"[]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") - \"partsupp\".\"ps_supplycost\" * \"lineitem\".\"l_quantity\") AS \"sum_profit\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"partsupp\",\r\n\"orders\",\r\n\"nation\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"partsupp\".\"ps_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"lineitem\".\"l_partkey\") AND (\"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"orders\".\"o_orderkey\" = \"lineitem\".\"l_orderkey\" AND (\"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\" AND \"part\".\"p_name\" LIKE '%peru%'))\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") DESC","rewrite_time":1.2917},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT \"nation\".\"n_name\" AS \"nation\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") AS \"o_year\", SUM(\"t2\".\"l_extendedprice\" * (1 - \"t2\".\"l_discount\") - \"t2\".\"ps_supplycost\" * \"t2\".\"l_quantity\") AS \"sum_profit\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_name\" LIKE '%peru%') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\") AS \"t0\",\r\n\"partsupp\"\r\nWHERE \"partsupp\".\"ps_suppkey\" = \"t0\".\"l_suppkey\" AND \"partsupp\".\"ps_partkey\" = \"t0\".\"l_partkey\") AS \"t1\",\r\n\"orders\"\r\nWHERE \"orders\".\"o_orderkey\" = \"t1\".\"l_orderkey\") AS \"t2\",\r\n\"nation\"\r\nWHERE \"t2\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\r\nGROUP BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\")\r\nORDER BY \"nation\".\"n_name\", EXTRACT(YEAR FROM \"t2\".\"o_orderdate\") DESC","rewrite_time":2.8742}],"num_rewrites":3,"raw_query":"select   nation,   o_year,   sum(amount) as sum_profit  from   (    select     n_name as nation,     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount    from     part,     supplier,     lineitem,     partsupp,     orders,     nation    where     s_suppkey = l_suppkey     and ps_suppkey = l_suppkey     and ps_partkey = l_partkey     and p_partkey = l_partkey     and o_orderkey = l_orderkey     and s_nationkey = n_nationkey     and p_name like '%peru%'   ) as profit  group by   nation,   o_year  order by   nation,   o_year desc;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(7)) = 'VIETNAM' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO POLISHED STEEL') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":16.3937},{"rule_order":"[]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'VIETNAM' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'ASIA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'PROMO POLISHED STEEL')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":4.672},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(7)) = 'VIETNAM' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO POLISHED STEEL') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":11.2566},{"rule_order":"[rule_join, rule_orderby, rule_cal, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(7)) = 'VIETNAM' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'ASIA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'PROMO POLISHED STEEL')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":10.4571},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'VIETNAM' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO POLISHED STEEL') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":10.1703},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"t5\".\"n_name0\" = 'VIETNAM' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO POLISHED STEEL') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'ASIA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":9.6012}],"num_rewrites":6,"raw_query":"select   o_year,   sum(case    when nation = 'VIETNAM' then volume    else 0   end) \/ sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'ASIA'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'PROMO POLISHED STEEL'   ) as all_nations  group by   o_year  order by   o_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(7)) = 'GERMANY' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":4.2729},{"rule_order":"[]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'GERMANY' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'EUROPE' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY POLISHED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":1.8095},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(7)) = 'GERMANY' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":4.5768},{"rule_order":"[rule_join, rule_orderby, rule_cal, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(7)) = 'GERMANY' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'EUROPE' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY POLISHED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":2.7785},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'GERMANY' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":3.4393},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"t5\".\"n_name0\" = 'GERMANY' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":5.209}],"num_rewrites":6,"raw_query":"select   o_year,   sum(case    when nation = 'GERMANY' then volume    else 0   end) \/ sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'EUROPE'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'ECONOMY POLISHED COPPER'   ) as all_nations  group by   o_year  order by   o_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(6)) = 'FRANCE' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO BRUSHED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":4.2772},{"rule_order":"[]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'FRANCE' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'EUROPE' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'PROMO BRUSHED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":1.8824},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(6)) = 'FRANCE' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO BRUSHED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":4.8409},{"rule_order":"[rule_join, rule_orderby, rule_cal, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(6)) = 'FRANCE' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'EUROPE' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'PROMO BRUSHED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":2.7351},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'FRANCE' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO BRUSHED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":3.226},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"t5\".\"n_name0\" = 'FRANCE' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'PROMO BRUSHED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'EUROPE') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":5.1484}],"num_rewrites":6,"raw_query":"select   o_year,   sum(case    when nation = 'FRANCE' then volume    else 0   end) \/ sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'EUROPE'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'PROMO BRUSHED COPPER'   ) as all_nations  group by   o_year  order by   o_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(6)) = 'BRAZIL' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED NICKEL') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":4.3656},{"rule_order":"[]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'BRAZIL' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AMERICA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY POLISHED NICKEL')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":1.7293},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(6)) = 'BRAZIL' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED NICKEL') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":4.5907},{"rule_order":"[rule_join, rule_orderby, rule_cal, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(6)) = 'BRAZIL' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AMERICA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY POLISHED NICKEL')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":2.4945},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'BRAZIL' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED NICKEL') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":3.2677},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"t5\".\"n_name0\" = 'BRAZIL' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY POLISHED NICKEL') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AMERICA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":5.2741}],"num_rewrites":6,"raw_query":"select   o_year,   sum(case    when nation = 'BRAZIL' then volume    else 0   end) \/ sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'AMERICA'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'ECONOMY POLISHED NICKEL'   ) as all_nations  group by   o_year  order by   o_year;"},{"rewrites":[{"rule_order":"[rule_union, rule_join, rule_cal, rule_filter, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(5)) = 'KENYA' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY ANODIZED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":4.3648},{"rule_order":"[]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'KENYA' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AFRICA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY ANODIZED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":1.7728},{"rule_order":"[rule_cal, rule_filter, rule_join, rule_union, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"t5\".\"n_name0\" AS CHAR(5)) = 'KENYA' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY ANODIZED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":4.4809},{"rule_order":"[rule_join, rule_orderby, rule_cal, rule_agg, rule_project]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"orders\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN CAST(\"nation0\".\"n_name\" AS CHAR(5)) = 'KENYA' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM \"part\",\r\n\"supplier\",\r\n\"lineitem\",\r\n\"orders\",\r\n\"customer\",\r\n\"nation\",\r\n\"nation\" AS \"nation0\",\r\n\"region\"\r\nWHERE \"part\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\" AND (\"lineitem\".\"l_orderkey\" = \"orders\".\"o_orderkey\" AND (\"orders\".\"o_custkey\" = \"customer\".\"c_custkey\" AND \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\")) AND (\"nation\".\"n_regionkey\" = \"region\".\"r_regionkey\" AND (\"region\".\"r_name\" = 'AFRICA' AND \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AND (\"orders\".\"o_orderdate\" >= DATE '1995-01-01' AND (\"orders\".\"o_orderdate\" <= DATE '1996-12-31' AND \"part\".\"p_type\" = 'ECONOMY ANODIZED COPPER')))\r\nGROUP BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"orders\".\"o_orderdate\")","rewrite_time":2.4714},{"rule_order":"[rule_agg, rule_filter]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t0\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"nation0\".\"n_name\" = 'KENYA' THEN \"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\") ELSE 0 END) \/ SUM(\"lineitem\".\"l_extendedprice\" * (1 - \"lineitem\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY ANODIZED COPPER') AS \"t\"\r\nCROSS JOIN \"supplier\"\r\nINNER JOIN \"lineitem\" ON \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t0\" ON \"lineitem\".\"l_orderkey\" = \"t0\".\"o_orderkey\"\r\nINNER JOIN \"customer\" ON \"t0\".\"o_custkey\" = \"customer\".\"c_custkey\"\r\nINNER JOIN \"nation\" ON \"customer\".\"c_nationkey\" = \"nation\".\"n_nationkey\"\r\nINNER JOIN \"nation\" AS \"nation0\" ON \"supplier\".\"s_nationkey\" = \"nation0\".\"n_nationkey\"\r\nINNER JOIN (SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t1\" ON \"nation\".\"n_regionkey\" = \"t1\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t0\".\"o_orderdate\")","rewrite_time":3.0721},{"rule_order":"[rule_filter, rule_agg, rule_orderby, rule_join]","rewrite_query":"SELECT EXTRACT(YEAR FROM \"t5\".\"o_orderdate\") AS \"o_year\", SUM(CASE WHEN \"t5\".\"n_name0\" = 'KENYA' THEN \"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\") ELSE 0 END) \/ SUM(\"t5\".\"l_extendedprice\" * (1 - \"t5\".\"l_discount\")) AS \"mkt_share\"\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM (SELECT *\r\nFROM \"part\"\r\nWHERE \"p_type\" = 'ECONOMY ANODIZED COPPER') AS \"t\",\r\n\"supplier\",\r\n\"lineitem\"\r\nWHERE \"t\".\"p_partkey\" = \"lineitem\".\"l_partkey\" AND \"supplier\".\"s_suppkey\" = \"lineitem\".\"l_suppkey\") AS \"t0\",\r\n(SELECT *\r\nFROM \"orders\"\r\nWHERE \"o_orderdate\" >= DATE '1995-01-01' AND \"o_orderdate\" <= DATE '1996-12-31') AS \"t1\"\r\nWHERE \"t0\".\"l_orderkey\" = \"t1\".\"o_orderkey\") AS \"t2\",\r\n\"customer\"\r\nWHERE \"t2\".\"o_custkey\" = \"customer\".\"c_custkey\") AS \"t3\",\r\n\"nation\"\r\nWHERE \"t3\".\"c_nationkey\" = \"nation\".\"n_nationkey\") AS \"t4\",\r\n\"nation\" AS \"nation0\"\r\nWHERE \"t4\".\"s_nationkey\" = \"nation0\".\"n_nationkey\") AS \"t5\",\r\n(SELECT *\r\nFROM \"region\"\r\nWHERE \"r_name\" = 'AFRICA') AS \"t6\"\r\nWHERE \"t5\".\"n_regionkey\" = \"t6\".\"r_regionkey\"\r\nGROUP BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")\r\nORDER BY EXTRACT(YEAR FROM \"t5\".\"o_orderdate\")","rewrite_time":5.2866}],"num_rewrites":6,"raw_query":"select   o_year,   sum(case    when nation = 'KENYA' then volume    else 0   end) \/ sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'AFRICA'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'ECONOMY ANODIZED COPPER'   ) as all_nations  group by   o_year  order by   o_year;"}]